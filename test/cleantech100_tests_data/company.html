<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"1e414b687e","applicationID":"1265394","transactionName":"IQtYTEpXXFxVQhsFXw8UV1ZRXUMfQ1hbEW8BC1tIWVZJ","queueTime":0,"applicationTime":1720,"agent":""}</script>
<script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"VQUEUlBVGwICUlRRDgU="};window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o||n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,e){function r(t){try{s.console&&console.log(t)}catch(n){}}var o,i=t("ee"),a=t(18),s={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,o.indexOf("dev")!==-1&&(s.dev=!0),o.indexOf("nr_dev")!==-1&&(s.nrDev=!0))}catch(c){}s.nrDev&&i.on("internal-error",function(t){r(t.stack)}),s.dev&&i.on("fn-err",function(t,n,e){r(e.stack)}),s.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(s,function(t,n){return t}).join(", ")))},{}],2:[function(t,n,e){function r(t,n,e,r,s){try{p?p-=1:o(s||new UncaughtException(t,n,e),!0)}catch(f){try{i("ierr",[f,c.now(),!0])}catch(d){}}return"function"==typeof u&&u.apply(this,a(arguments))}function UncaughtException(t,n,e){this.message=t||"Uncaught error with no additional information",this.sourceURL=n,this.line=e}function o(t,n){var e=n?null:c.now();i("err",[t,e])}var i=t("handle"),a=t(19),s=t("ee"),c=t("loader"),f=t("gos"),u=window.onerror,d=!1,l="nr@seenError",p=0;c.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(h){"stack"in h&&(t(8),t(7),"addEventListener"in window&&t(5),c.xhrWrappable&&t(9),d=!0)}s.on("fn-start",function(t,n,e){d&&(p+=1)}),s.on("fn-err",function(t,n,e){d&&!e[l]&&(f(e,l,function(){return!0}),this.thrown=!0,o(e))}),s.on("fn-end",function(){d&&!this.thrown&&p>0&&(p-=1)}),s.on("internal-error",function(t){i("ierr",[t,c.now(),!0])})},{}],3:[function(t,n,e){t("loader").features.ins=!0},{}],4:[function(t,n,e){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(8),s=t(7),c="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",l="resource",p="-start",h="-end",m="fn"+p,w="fn"+h,v="bstTimer",y="pushState",g=t("loader");g.features.stn=!0,t(6);var x=NREUM.o.EV;o.on(m,function(t,n){var e=t[0];e instanceof x&&(this.bstStart=g.now())}),o.on(w,function(t,n){var e=t[0];e instanceof x&&i("bst",[e,n,this.bstStart,g.now()])}),a.on(m,function(t,n,e){this.bstStart=g.now(),this.bstType=e}),a.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),this.bstType])}),s.on(m,function(){this.bstStart=g.now()}),s.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),"requestAnimationFrame"])}),o.on(y+p,function(t){this.time=g.now(),this.startPath=location.pathname+location.hash}),o.on(y+h,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+c]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["c"+c]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["webkitC"+c]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],5:[function(t,n,e){function r(t){for(var n=t;n&&!n.hasOwnProperty(u);)n=Object.getPrototypeOf(n);n&&o(n)}function o(t){s.inPlace(t,[u,d],"-",i)}function i(t,n){return t[1]}var a=t("ee").get("events"),s=t(21)(a,!0),c=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";n.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,n){var e=t[1],r=c(e,"nr@wrapped",function(){function t(){if("function"==typeof e.handleEvent)return e.handleEvent.apply(e,arguments)}var n={object:t,"function":e}[typeof e];return n?s(n,"fn-",null,n.name||"anonymous"):e});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],6:[function(t,n,e){var r=t("ee").get("history"),o=t(21)(r);n.exports=r,o.inPlace(window.history,["pushState","replaceState"],"-")},{}],7:[function(t,n,e){var r=t("ee").get("raf"),o=t(21)(r),i="equestAnimationFrame";n.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],8:[function(t,n,e){function r(t,n,e){t[0]=a(t[0],"fn-",null,e)}function o(t,n,e){this.method=e,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,e)}var i=t("ee").get("timer"),a=t(21)(i),s="setTimeout",c="setInterval",f="clearTimeout",u="-start",d="-";n.exports=i,a.inPlace(window,[s,"setImmediate"],s+d),a.inPlace(window,[c],c+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(c+u,r),i.on(s+u,o)},{}],9:[function(t,n,e){function r(t,n){d.inPlace(n,["onreadystatechange"],"fn-",s)}function o(){var t=this,n=u.context(t);t.readyState>3&&!n.resolved&&(n.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,y,"fn-",s)}function i(t){g.push(t),h&&(b?b.then(a):w?w(a):(E=-E,R.data=E))}function a(){for(var t=0;t<g.length;t++)r([],g[t]);g.length&&(g=[])}function s(t,n){return n}function c(t,n){for(var e in t)n[e]=t[e];return n}t(5);var f=t("ee"),u=f.get("xhr"),d=t(21)(u),l=NREUM.o,p=l.XHR,h=l.MO,m=l.PR,w=l.SI,v="readystatechange",y=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];n.exports=u;var x=window.XMLHttpRequest=function(t){var n=new p(t);try{u.emit("new-xhr",[n],n),n.addEventListener(v,o,!1)}catch(e){try{u.emit("internal-error",[e])}catch(r){}}return n};if(c(p,x),x.prototype=p.prototype,d.inPlace(x.prototype,["open","send"],"-xhr-",s),u.on("send-xhr-start",function(t,n){r(t,n),i(n)}),u.on("open-xhr-start",r),h){var b=m&&m.resolve();if(!w&&!m){var E=1,R=document.createTextNode(E);new h(a).observe(R,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===v||a()})},{}],10:[function(t,n,e){function r(){var t=window.NREUM,n=t.info.accountID||null,e=t.info.agentID||null,r=t.info.trustKey||null,i="btoa"in window&&"function"==typeof window.btoa;if(!n||!e||!i)return null;var a={v:[0,1],d:{ty:"Browser",ac:n,ap:e,id:o.generateCatId(),tr:o.generateCatId(),ti:Date.now()}};return r&&n!==r&&(a.d.tk=r),btoa(JSON.stringify(a))}var o=t(16);n.exports={generateTraceHeader:r}},{}],11:[function(t,n,e){function r(t){var n=this.params,e=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<p;r++)t.removeEventListener(l[r],this.listener,!1);n.aborted||(e.duration=s.now()-this.startTime,this.loadCaptureCalled||4!==t.readyState?null==n.status&&(n.status=0):a(this,t),e.cbTime=this.cbTime,d.emit("xhr-done",[t],t),c("xhr",[n,e,this.startTime]))}}function o(t,n){var e=t.responseType;if("json"===e&&null!==n)return n;var r="arraybuffer"===e||"blob"===e||"json"===e?t.response:t.responseText;return w(r)}function i(t,n){var e=f(n),r=t.params;r.host=e.hostname+":"+e.port,r.pathname=e.pathname,t.sameOrigin=e.sameOrigin}function a(t,n){t.params.status=n.status;var e=o(n,t.lastSize);if(e&&(t.metrics.rxSize=e),t.sameOrigin){var r=n.getResponseHeader("X-NewRelic-App-Data");r&&(t.params.cat=r.split(", ").pop())}t.loadCaptureCalled=!0}var s=t("loader");if(s.xhrWrappable){var c=t("handle"),f=t(12),u=t(10).generateTraceHeader,d=t("ee"),l=["load","error","abort","timeout"],p=l.length,h=t("id"),m=t(15),w=t(14),v=window.XMLHttpRequest;s.features.xhr=!0,t(9),d.on("new-xhr",function(t){var n=this;n.totalCbs=0,n.called=0,n.cbTime=0,n.end=r,n.ended=!1,n.xhrGuids={},n.lastSize=null,n.loadCaptureCalled=!1,t.addEventListener("load",function(e){a(n,t)},!1),m&&(m>34||m<10)||window.opera||t.addEventListener("progress",function(t){n.lastSize=t.loaded},!1)}),d.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),d.on("open-xhr-end",function(t,n){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid);var e=!1;if("init"in NREUM&&"distributed_tracing"in NREUM.init&&(e=!!NREUM.init.distributed_tracing.enabled),e&&this.sameOrigin){var r=u();r&&n.setRequestHeader("newrelic",r)}}),d.on("send-xhr-start",function(t,n){var e=this.metrics,r=t[0],o=this;if(e&&r){var i=w(r);i&&(e.txSize=i)}this.startTime=s.now(),this.listener=function(t){try{"abort"!==t.type||o.loadCaptureCalled||(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof n.onload))&&o.end(n)}catch(e){try{d.emit("internal-error",[e])}catch(r){}}};for(var a=0;a<p;a++)n.addEventListener(l[a],this.listener,!1)}),d.on("xhr-cb-time",function(t,n,e){this.cbTime+=t,n?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof e.onload||this.end(e)}),d.on("xhr-load-added",function(t,n){var e=""+h(t)+!!n;this.xhrGuids&&!this.xhrGuids[e]&&(this.xhrGuids[e]=!0,this.totalCbs+=1)}),d.on("xhr-load-removed",function(t,n){var e=""+h(t)+!!n;this.xhrGuids&&this.xhrGuids[e]&&(delete this.xhrGuids[e],this.totalCbs-=1)}),d.on("addEventListener-end",function(t,n){n instanceof v&&"load"===t[0]&&d.emit("xhr-load-added",[t[1],t[2]],n)}),d.on("removeEventListener-end",function(t,n){n instanceof v&&"load"===t[0]&&d.emit("xhr-load-removed",[t[1],t[2]],n)}),d.on("fn-start",function(t,n,e){n instanceof v&&("onload"===e&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=s.now()))}),d.on("fn-end",function(t,n){this.xhrCbStart&&d.emit("xhr-cb-time",[s.now()-this.xhrCbStart,this.onload,n],n)})}},{}],12:[function(t,n,e){n.exports=function(t){var n=document.createElement("a"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!n.protocol||":"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain&&n.port===e.port;return r.sameOrigin=i&&(!n.hostname||a),r}},{}],13:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t("handle"),a=t(18),s=t(19),c=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,n){u[n]=o(l+n,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o="function"==typeof n;return i(p+"tracer",[f.now(),t,e],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}catch(t){throw c.emit("fn-err",[arguments,this,t],e),t}finally{c.emit("fn-end",[f.now()],e)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t,n){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now(),!1,n])}},{}],14:[function(t,n,e){n.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],15:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),n.exports=r},{}],16:[function(t,n,e){function r(){function t(){return n?15&n[e++]:16*Math.random()|0}var n=null,e=0,r=window.crypto||window.msCrypto;r&&r.getRandomValues&&(n=r.getRandomValues(new Uint8Array(31)));for(var o,i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",a="",s=0;s<i.length;s++)o=i[s],"x"===o?a+=t().toString(16):"y"===o?(o=3&t()|8,a+=o.toString(16)):a+=o;return a}function o(){function t(){return n?15&n[e++]:16*Math.random()|0}var n=null,e=0,r=window.crypto||window.msCrypto;r&&r.getRandomValues&&Uint8Array&&(n=r.getRandomValues(new Uint8Array(31)));for(var o=[],i=0;i<16;i++)o.push(t().toString(16));return o.join("")}n.exports={generateUuid:r,generateCatId:o}},{}],17:[function(t,n,e){function r(t,n){if(!o)return!1;if(t!==o)return!1;if(!n)return!0;if(!i)return!1;for(var e=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==e[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var s=navigator.userAgent,c=s.match(a);c&&s.indexOf("Chrome")===-1&&s.indexOf("Chromium")===-1&&(o="Safari",i=c[1])}n.exports={agent:o,version:i,match:r}},{}],18:[function(t,n,e){function r(t,n){var e=[],r="",i=0;for(r in t)o.call(t,r)&&(e[i]=n(r,t[r]),i+=1);return e}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],19:[function(t,n,e){function r(t,n,e){n||(n=0),"undefined"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(o<0?0:o);++r<o;)i[r]=t[n+r];return i}n.exports=r},{}],20:[function(t,n,e){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],21:[function(t,n,e){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(19),a="nr@original",s=Object.prototype.hasOwnProperty,c=!1;n.exports=function(t,n){function e(t,n,e,o){function nrWrapper(){var r,a,s,c;try{a=this,r=i(arguments),s="function"==typeof e?e(r,a):e||{}}catch(f){l([f,"",[r,a,o],s])}u(n+"start",[r,a,o],s);try{return c=t.apply(a,r)}catch(d){throw u(n+"err",[r,a,d],s),d}finally{u(n+"end",[r,a,c],s)}}return r(t)?t:(n||(n=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,n,o,i){o||(o="");var a,s,c,f="-"===o.charAt(0);for(c=0;c<n.length;c++)s=n[c],a=t[s],r(a)||(t[s]=e(a,f?s+o:o,i,s))}function u(e,r,o){if(!c||n){var i=c;c=!0;try{t.emit(e,r,o,n)}catch(a){l([a,e,r,o])}c=i}}function d(t,n){if(Object.defineProperty&&Object.keys)try{var e=Object.keys(t);return e.forEach(function(e){Object.defineProperty(n,e,{get:function(){return t[e]},set:function(n){return t[e]=n,n}})}),n}catch(r){l([r])}for(var o in t)s.call(t,o)&&(n[o]=t[o]);return n}function l(n){try{t.emit("internal-error",n)}catch(e){}}return t||(t=o),e.inPlace=f,e.flag=a,e}},{}],ee:[function(t,n,e){function r(){}function o(t){function n(t){return t&&t instanceof r?t:t?c(t,s,i):i()}function e(e,r,o,i){if(!l.aborted||i){t&&t(e,r,o);for(var a=n(o),s=m(e),c=s.length,f=0;f<c;f++)s[f].apply(a,r);var d=u[g[e]];return d&&d.push([x,e,r,a]),a}}function p(t,n){y[t]=m(t).concat(n)}function h(t,n){var e=y[t];if(e)for(var r=0;r<e.length;r++)e[r]===n&&e.splice(r,1)}function m(t){return y[t]||[]}function w(t){return d[t]=d[t]||o(e)}function v(t,n){f(t,function(t,e){n=n||"feature",g[e]=n,n in u||(u[n]=[])})}var y={},g={},x={on:p,addEventListener:p,removeEventListener:h,emit:e,get:w,listeners:m,context:n,buffer:v,abort:a,aborted:!1};return x}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var s="nr@context",c=t("gos"),f=t(18),u={},d={},l=n.exports=o();l.backlog=u},{}],gos:[function(t,n,e){function r(t,n,e){if(o.call(t,n))return t[n];var r=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(t,n,e){function r(t,n,e,r){o.buffer([t],r),o.emit(t,n,e)}var o=t("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(t,n,e){function r(t){var n=typeof t;return!t||"object"!==n&&"function"!==n?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");n.exports=r},{}],loader:[function(t,n,e){function r(){if(!E++){var t=b.info=NREUM.info,n=p.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&n))return u.abort();f(g,function(n,e){t[n]||(t[n]=e)}),c("mark",["onload",a()+b.offset],null,"api");var e=p.createElement("script");e.src="https://"+t.agent,n.parentNode.insertBefore(e,n)}}function o(){"complete"===p.readyState&&i()}function i(){c("mark",["domContent",a()+b.offset],null,"api")}function a(){return R.exists&&performance.now?Math.round(performance.now()):(s=Math.max((new Date).getTime(),s))-b.offset}var s=(new Date).getTime(),c=t("handle"),f=t(18),u=t("ee"),d=t(17),l=window,p=l.document,h="addEventListener",m="attachEvent",w=l.XMLHttpRequest,v=w&&w.prototype;NREUM.o={ST:setTimeout,SI:l.setImmediate,CT:clearTimeout,XHR:w,REQ:l.Request,EV:l.Event,PR:l.Promise,MO:l.MutationObserver};var y=""+location,g={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1123.min.js"},x=w&&v&&v[h]&&!/CriOS/.test(navigator.userAgent),b=n.exports={offset:s,now:a,origin:y,features:{},xhrWrappable:x,userAgent:d};t(13),p[h]?(p[h]("DOMContentLoaded",i,!1),l[h]("load",r,!1)):(p[m]("onreadystatechange",o),l[m]("onload",r)),c("mark",["firstbyte",s],null,"api");var E=0,R=t(20)},{}]},{},["loader",2,11,4,3]);</script>
  <script src="//cdn.optimizely.com/js/3086230227.js"></script>

  <title>Actility: Investment rounds, top customers, partners and investors | i3 Connect</title>
  <meta name="description" content="This page provides investment and traction data on Actility, a Provider of products and services for machine-to-machine (M2M) and smartgrid applications">
  <meta content="authenticity_token" name="csrf-param" />
<meta content="WFO9QNnU4FX6gG4uKFgXtGAuJEquNAWR+o+VFw9h/SY=" name="csrf-token" />
  <meta name="viewport" id="viewport" content="width=320">

  <!--[if lt IE 9]>
  <script src="//ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
  <![endif]-->

  <link href="/assets/application-8984e1250c0265c07f08e2ce3c369865.css" media="screen" rel="stylesheet" type="text/css" />
  
  <link href="/assets/owlcarousel/owl.carousel-b8cc2b6a496ea13b524e408ca6464837.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/assets/owlcarousel/owl.transitions-ad7c9a78cf7f9c8ff7eccaa87443cd59.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/assets/maini3-1dd11054f9addb1f927c48439e08f9ff.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/assets/edit_company_profile-95be0fd203448d616ee7ae6aad8a0d91.css" media="screen" rel="stylesheet" type="text/css" />


 <!-- Each page has own stylesheet -->

  <script src="/assets/application-af0ac4370af1c73d759c3e426ed0dcd3.js" type="text/javascript"></script>
  
   <script src="/assets/company_includes-65da8662fb9a43af959dd97cecddedd4.js" type="text/javascript"></script>
   <script src="/assets/jquery.scrollTo.min-8ca59479abb899dcdee2fa506ef4c095.js" type="text/javascript"></script>


  <!-- Trackers -->
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-963086-9']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();


</script>
 <!-- Google Analytics -->
  
  

  
  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0037/7401.js?"+Math.floor(new Date().getTime()/3600000);
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>

</head>

<body class="profile">


<div id="wrapper">
  
<div id="header-wrapper">
    <!-- Not signed in header -->
      <link href="/assets/front_page_c-251f9d5c535ef13e11b934881cf54898.css" media="screen" rel="stylesheet" type="text/css" />
      <link href="/assets/maini3-1dd11054f9addb1f927c48439e08f9ff.css" media="screen" rel="stylesheet" type="text/css" />
      <!-- Header -->
  <div id="header-wrapper">
    <header id="header" class="section">
      <a href="/" id="logo">i3</a>
      <a href="#mobile-menu" id="mobile-menu-button">Menu</a>
      <div id="header-account-wrapper">
        
<div class="search-sectio">
<form accept-charset="UTF-8" action="/solr_search" class="search panel-target" id="search-form" method="get"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /></div>
  <div class="header-search-box">
  <input autocomplete="off" class="search-input typeahead" data-provide="typeahead" id="q" name="q" onfocus="displaySearchResultsFocus()" onkeyup="displaySearchResultsKeyUp()" placeholder="Search (e.g. EV charging, Lilium, Artificial Intelligence)" type="text" />
  <input class="search-submit" name="commit" type="submit" value="Search" />
  </div>
</form></div>


        <div class="sign-up-section">
        <form accept-charset="UTF-8" action="/account/signin" class="new_user" id="header-account" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="WFO9QNnU4FX6gG4uKFgXtGAuJEquNAWR+o+VFw9h/SY=" /></div>
          <input id="ref" name="ref" type="hidden" />
          <input class="apply_to" id="apply_to" name="apply_to" type="hidden" />
          <!-- remote_ip: 69.119.114.69 -->
          <div class="form-block">
            <label>Email</label>
            <input class="text-input" id="user_email" name="user[email]" size="30" tabindex="1" type="email" />
          </div>

          <div class="form-block">
            <label>Password</label>
            <a href="/account/forgot_password" class="forgot-pass-link">Forgot password?</a>
            <input class="text-input" id="user_password" name="user[password]" size="30" tabindex="2" type="password" />
          </div>
          <input class="sign-in-link" name="commit" type="submit" value="Sign In" />
            <a href="/" class="sign-up-link">Sign Up</a>
</form>        </div>

      </div>
    </header>
  </div> <!-- END Header -->

</div>
<script>
  function displaySearchResultsKeyUp() {
    if($("#q").val().length > 0) {
      $('.header-search-results').hide();
    }
    else {
      $('.header-search-results').show();
    }
  }

  function displaySearchResultsFocus() {
    $('.header-search-results').show();
  }

  $(function() {
    $('body').click(function() {
      $('.header-search-results').hide();
    });
  });
</script>


  <!-- CONTENT -->
  <div id="content-wrapper">
    <div id="content" class="section">

      <!-- Flash Messages -->




      






<div id="company-content" class="content-wrapper ng-cloak" ng-app="companiesApp" ng-controller="showCtrl" data-company-id="4684" data-profile-type="company" ng-cloak>

<script type="text/javascript">
$(document).ready(function() {
  $('#toggleMenu').on("click", function(event) {
    event.stopPropagation();
    $("#nav-arrows").html(''); //fix menu autowidth issue (it's nonsense, I know...but it works)

    var e = $(this);
    var elem = $('.admin-nav-options');

    if(elem.is(":visible")) {
      elem.hide();
      $('#nav-arrows').removeClass("icon-down-arrow").addClass("icon-forward-arrow");
    }
    else {
      elem.show();
      $('#nav-arrows').removeClass("icon-forward-arrow").addClass("icon-down-arrow");
    }
  });

  $(document).click(function(event) {
    if(!$(event.target).closest('.admin-nav-options').length) {
      if($('.admin-nav-options').is(":visible")) {
        $('.admin-nav-options').hide();
      }
    }
  });
});

  var companyApp = angular.module('companiesApp', []);

companyApp.config(["$httpProvider", function($httpProvider) {
  $httpProvider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
}])

  companyApp.filter('nfcurrency', [ '$filter', '$locale', function ($filter, $locale) {
  var currency = $filter('currency'), formats = $locale.NUMBER_FORMATS;
  return function (amount, symbol) {
    var value = currency(amount, symbol)||'';
    return value.replace(new RegExp('\\' + formats.DECIMAL_SEP + '\\d{2}'), '')
  };
}]);

companyApp.filter("to_trusted", ['$sce', function($sce) {
  return function(text) {
    return $sce.trustAsHtml(text);
  };
}]);

companyApp.filter("numShort", function() {
  return function(number) {
    var abs;
    if (number == void(0) || number == 0) return "";

    abs = Math.abs(number);
    if (abs >= Math.pow(10, 12)) {
      number = (number / Math.pow(10, 12)).toFixed(1) + "T";
    } else if (abs < Math.pow(10, 12) && abs >= Math.pow(10, 9)) {
      number = (number / Math.pow(10, 9)).toFixed(1) + "B";
    } else if (abs < Math.pow(10, 9) && abs >= Math.pow(10, 6)) {
      number = (number / Math.pow(10, 6)).toFixed(0) + "M";
    } else if (abs < Math.pow(10, 6) && abs >= Math.pow(10, 3)) {
      number = (number / Math.pow(10, 3)).toFixed(0) + "K";
    }

    return "$" + number;
  };
});

companyApp.directive('recommendCarousel', function() {
  return function(scope, element, attrs) {
    if (scope.$last){
      $("#company-recommendations").owlCarousel({
        items: 4,
        navigation: true,
        pagination: false,
        paginationNumbers: false,
        scrollPerPage: true,
        singleItem: false,
        itemsDesktop: false,
        itemsDesktopSmall: [1024, 2],
        itemsTablet: [768, 2],
        itemsMobile: [479, 2]
      });
    }
  };
});

companyApp.directive('cancelma', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.ma-copy').remove();
      $('.ma-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('cancelinvestment', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.investment-copy').remove();
      $('.investments-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editinvestment', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.investment = scope.findItem("investments", id);
        scope.investment.investment_date = scope.formatDateProper(scope.investment.investment_date);
      }
      else {
        scope.investment = {};
        row = $('.investments-table tbody tr:first-child');
		$('#inv_rel_sel_0').prop('checked', true);
      }

      $('.investment-copy').remove();
      $('.investments-table tbody tr:not(.edit-row)').show();
      var cloned = $('.investments-table tbody .edit-row').clone().addClass('investment-copy');
      cloned.prop('data-investment-id', id);
      cloned.find('.add_investment_input').prop('id','add_investment_input_copy');
      cloned.show();

      row.after($compile(cloned)(scope));
      row.hide();
      $('.investment-copy .edit-date').datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat:'mm/dd/yy',
        maxDate: new Date,
        onSelect:function (date) {
        }
      });

      scope.$apply(function() {
        angular.element($('.investment-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(investment.ogo_url) || \'/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png\'}}" /></div>')(scope));
        angular.element($('.investment-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': investment.notes.length > 400}">{{400 - investment.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
        investmentSelector = $('#add_investment_input_copy').tokenInput("/api/suggest/investor_name_and_id", {
          queryParam: "term",
          preventDuplicates: true,
          searchDelay: 1000,
          onAdd: function(item) {
          		var inv_list = $('.investment-copy .investors_entered');
          		
          		if (inv_list.length) 
          		{
					inv_list.append('<li id="inv_list_item_' + item.id + '"><input type="radio" id="inv_rel_sel_' + item.id + '" value="' + item.id + '" name="inv_rel_sel"' + (item.has_inc_accel_rel ? 'checked' : '') + '>' + item.name + '</li>');
				}
          },
          onDelete: function(item) {
			var inv_list = $('.investment-copy .investors_entered');
			
			if (inv_list.length) {
	          	var inv_list_item = $('#inv_list_item_' + item.id);
	          	var inv_radio_item = $('#inv_rel_sel_' + item.id);

				if (inv_radio_item.prop('checked'))
				{
        	  		$('.investment-copy #inv_rel_sel_0').prop('checked', true);
				}
          	
	          	inv_list_item.remove();
	        }
          },
        });
      });

      investmentSelector.tokenInput("clear");
      if(scope.investment && scope.investment.id) {
        scope.investment.investors.forEach(function(i) {
          var has_inc_accel_rel = (scope.investment.get_related_inc_accel_cid == i.id);
          investmentSelector.tokenInput("add", {id: i.id, name: i.name, has_inc_accel_rel: has_inc_accel_rel});
        });
        
        if (scope.investment.get_related_inc_accel_cid == -1) {
			$('.investment-copy #inv_rel_sel_0').prop('checked', true);	        	  		
	    }
      }
    });
  };
});

companyApp.directive('editma', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.acquisition = scope.findItem("ma", id);
        scope.acquisition.date_announced = scope.formatDateProper(scope.acquisition.date_announced);
        scope.acquisition.date_closed = scope.formatDateProper(scope.acquisition.date_closed);
      }
      else {
        scope.acquisition = {};
        row = $('.ma-table tbody tr:first-child');
      }

      $('.ma-copy').remove();
      $('.ma-table tbody tr:not(.edit-row)').show();
      var cloned = $('.ma-table tbody .edit-row').clone().addClass('ma-copy');
      cloned.find('.edit-direction').addClass('edit-direction-copy');
      cloned.prop('data-ma-id', id);
      cloned.find('.add_ma_input').prop('id','add_ma_input_copy');
      cloned.show();

      row.after($compile(cloned)(scope));
      row.hide();
      $('.ma-copy .edit-date').datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat:'mm/dd/yy',
        maxDate: new Date,
        onSelect:function (date) {
        }
      });

      scope.$apply(function() {
        angular.element($('.ma-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(acquisition.acquired_logo_url) || \'/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png\'}}" /></div>')(scope));
        angular.element($('.ma-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': acquisition.notes.length > 400}">{{400 - acquisition.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
        maSelector = $('#add_ma_input_copy').tokenInput("/api/suggest/company_all_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      maSelector.tokenInput("clear");
      if(scope.acquisition && scope.acquisition.acquired && scope.acquisition.acquired.id) {
        maSelector.tokenInput("add", {id: scope.acquisition.acquired.id, name: scope.acquisition.acquired.name});
      }
    });
  };
});

companyApp.directive('cancelmanagement', function($compile) {
  return function(scope, element, attrs) {
    scope.teamSelector.tokenInput("clear");
    element.bind("click", function() {
      $('#management-data').remove();
      $('.management-copy').fadeOut().remove();
      $('.management-wrapper').fadeIn();
      $('#edit-new-team').hide();
      $('#add-team-span, .team-find-edit, .show-add-team-link').show();
    });
  };
});

companyApp.directive('editmanagement', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var id = this.id.split('_')[1];
      var row = null;

      if(id) {
        scope.teammember = scope.findItem("team", id);
        scope.teammember.date_joined = scope.formatDateProper(scope.teammember.date_joined);
        scope.teammember.date_departed = scope.formatDateProper(scope.teammember.date_departed);
        row = $(this).closest('.management-wrapper');
        $('.team-find-edit, #edit-new-team').hide();
      }
      else {
        scope.teammember = {};

        if($('#management-data').length > 0) {
          scope.teammember.person = {
            first_name: $('#management-data').data('first'),
            last_name: $('#management-data').data('last')
          };
        }

        $('#edit-new-team').show();
        $('.team-find-edit').hide();
        row = $('.management-wrapper-new');
      }

      $('.management-copy').remove();
      $('.management-wrapper, .management-wrapper-new').show();
      var cloned = $('.edit-management').clone().addClass('management-copy');
      cloned.prop('data-teammember-id', id);
      cloned.find('.edit-required').prop('required', true);
      cloned.find('.edit-person').val(scope.teammember.person_id);
      cloned.fadeIn();
      row.after(cloned);
      row.hide();
      $compile(cloned)(scope);

      $('.management-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          onSelect:function (date) {
          }
        });
    });
  };
});

companyApp.directive('cancelboard', function($compile) {
  return function(scope, element, attrs) {
    scope.boardmemberSelector.tokenInput("clear");
    element.bind("click", function() {
      $('#board-data').remove();
      $('.board-copy').fadeOut().remove();
      $('.board-wrapper').fadeIn();
      $('#edit-new-board').hide();
      $('#add-board-span, .board-find-edit, .show-add-board-link').show();
    });
  };
});

companyApp.directive('editboard', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var id = this.id.split('_')[1];
      var row = null;

      if(id) {
        scope.boardmember = scope.findItem("board_of_directors", id);
        scope.boardmember.start_date = scope.formatDateProper(scope.boardmember.start_date);
        scope.boardmember.end_date = scope.formatDateProper(scope.boardmember.end_date);
        row = $(this).closest('.board-wrapper');
        $('.board-find-edit, #edit-new-board').hide();
      }
      else {
        scope.boardmember = {};

        if($('#board-data').length > 0) {
          scope.boardmember.person = {
            first_name: $('#board-data').data('first'),
            last_name: $('#board-data').data('last')
          };
        }

        $('#edit-new-board').show();
        $('.board-find-edit').hide();
        row = $('.board-wrapper-new');
      }

      $('.board-copy').remove();
      $('.board-wrapper, .board-wrapper-new').show();
      var cloned = $('.edit-board').clone().addClass('board-copy');
      cloned.prop('data-board-id', id);
      cloned.find('.board-edit-required').prop('required', true);
      cloned.find('.edit-person').val(scope.boardmember.person_id);
      cloned.find('.add_investor_input').prop('id','add_investor_input_copy');
      cloned.fadeIn();
      row.after(cloned);
      row.hide();
      $compile(cloned)(scope);

      $('.board-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          onSelect:function (date) {
          }
        });

      scope.$apply(function() {
        investorSelector = $('#add_investor_input_copy').tokenInput("/api/suggest/investor_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      investorSelector.tokenInput("clear");
      if(scope.boardmember && scope.boardmember.investor) {
        investorSelector.tokenInput("add", {id: scope.boardmember.investor.id, name: scope.boardmember.investor.name});
      }
    });
  };
});



companyApp.directive('cancelcustomer', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.customer-copy').remove();
      $('.customers-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editcustomer', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.customer = scope.findItem("customers", id);
        customer = scope.customer.company1.id == scope.companyId ? scope.customer.company2 : scope.customer.company1;
        scope.customer.relationship_date = scope.formatDateProper(scope.customer.relationship_date);
      }
      else {
        scope.customer = {};
        row = $('.customers-table tbody tr:first-child');
      }

      $('.customer-copy').remove();
      $('.customers-table tbody tr:not(.edit-row)').show();
      var cloned = $('.customers-table tbody .edit-row').clone().addClass('customer-copy');
      cloned.prop('data-customer-id', id);
      cloned.find('.add_customer_input').prop('id','add_customer_input_copy');
      cloned.show();

      row.after($compile(cloned)(scope));
      row.hide();
      $('.customer-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          maxDate: new Date,
          onSelect:function (date) {

          }
        });

      scope.$apply(function() {
        angular.element($('.customer-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || \'/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png\'}}" /></div>')(scope));
        angular.element($('.customer-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': customer.notes.length > 400}">{{400 - customer.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
        customerSelector = $('#add_customer_input_copy').tokenInput("/api/suggest/company_all_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      customerSelector.tokenInput("clear");
      if(customer && customer.id) {
        customerSelector.tokenInput("add", {id: customer.id, name: customer.name});
      }
    });
  };
});

companyApp.directive('cancelrelationship', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.relationship-copy').remove();
      $('.relationships-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editrelationship', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.relationship = scope.findItem("relationships", id);
        relationship = scope.relationship.company1.id == scope.companyId ? scope.relationship.company2 : scope.relationship.company1;
        scope.relationship.relationship_date = scope.formatDateProper(scope.relationship.relationship_date);
      }
      else {
        scope.relationship = {};
        row = $('.relationships-table tbody tr:first-child');
      }

      $('.relationship-copy').remove();
      $('.relationships-table tbody tr:not(.edit-row)').show();
      var cloned = $('.relationships-table tbody .edit-row').clone().addClass('relationship-copy');
      cloned.prop('data-relationship-id', id);
      cloned.find('.edit-relationship-type').prop('required', true);
      cloned.find('.add_relationship_input').prop('id','add_relationship_input_copy');
      cloned.show();

      row.after(cloned);
      row.hide();
      $('.relationship-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          maxDate: new Date,
          onSelect:function (date) {

          }
        });
      $compile(cloned)(scope);

      scope.$apply(function() {
        angular.element($('.relationship-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(relationship.company1.id == profile.company.id ? relationship.logo_url2 : relationship.logo_url1) || \'/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png\'}}" /></div>')(scope));
        angular.element($('.relationship-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': relationship.notes.length > 400}">{{400 - relationship.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
//         relationshipSelector = $('#add_relationship_input_copy').tokenInput("/api/suggest/company_all_name_and_id", {
          relationshipSelector = $('#add_relationship_input_copy').tokenInput("/api/suggest/partner_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      relationshipSelector.tokenInput("clear");
      if(scope.relationship.id) {
        relationshipSelector.tokenInput("add", {id: relationship.id, name: relationship.name});
      }
    });
  };
});


companyApp.directive('cancelproduct', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.product-copy').remove();
      $('.products-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editproduct', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.product = scope.findItem("products", id);
      }
      else {
        scope.product = {};
        row = $('.products-table tbody tr:first-child');
      }

      $('.product-copy').remove();
      $('.products-table tbody tr:not(.edit-row)').show();
      var cloned = $('.products-table tbody .edit-row').clone().addClass('product-copy');
      cloned.prop('data-product-id', id);
      cloned.find('.edit-name').prop('required', true);
      cloned.find('#product_image_preview').prop('id', 'product_image_preview-copy');

      if(scope.product.product_image_url) {
        cloned.find('.upload-image-icon').hide();
        cloned.find('#product_image_preview-copy').prop('src', scope.product.product_image_url);
      }
      cloned.show();
      row.after(cloned);
      row.hide();
      $compile(cloned)(scope);

      scope.$apply(function() {
        angular.element($('.product-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': product.description.length > 400}">{{400 - product.description.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
      });
    });
  };
});

companyApp.directive('pdfElem', function() {
  return {
    restrict: 'A',
    link: function($scope, element, attrs) {
      $scope.updatePdf = function() {
        var url = $scope.selectedPdf && $scope.selectedPdf.pdf_file.url;
        var elem = element;
        var pdfObj = $('#pdf-object');

        if(pdfObj.length > 0 ) {
          pdfObj.attr('data', url);
          $('#pdf-link').attr('href', url);
        }
        else if(url) {
          elem.replaceWith('<object ng-disabled="!selectedPdf" ng-show="selectedPdf" data="' + url + '" class="cp-deck" id="pdf-object">Unable to display : <a href="' + url + '" id="pdf-link">Download</a></object>');
        }
      }

      $scope.updatePdf();
    }
  };
});

companyApp.directive('httpPrefix', function() {
  return {
    restrict: 'A',
    require: 'ngModel',
    link: function(scope, element, attrs, controller) {
      function ensureHttpPrefix(value) {
        // Need to add prefix if we don't have http:// prefix already AND we don't have part of it
        if(value && !/^(https?):\/\//i.test(value) && 'http://'.indexOf(value) === -1) {
          controller.$setViewValue('http://' + value);
          controller.$render();
          return 'http://' + value;
        }
        else {
            return value;
        }
      }
      controller.$formatters.push(ensureHttpPrefix);
      controller.$parsers.push(ensureHttpPrefix);
    }
  };
});

companyApp.directive('datepicker', function() {
  return {
    restrict: 'A',
    require : 'ngModel',
    link : function (scope, element, attrs, ngModelCtrl) {
      $(function(){
        element.datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          onSelect:function (date) {
            scope.$apply(function () {
              ngModelCtrl.$setViewValue(date);
            });
          }
        });
      });
    }
  }
});

companyApp.directive('fancySelect', function() {
  return {
    restrict: 'A',
    scope: false,
    link: function($scope, element, attrs) {
      var $targetSelect = $(element);
      $targetSelect.selectBox().change(function () {
        var selected = $(this).val();

        $scope.$apply(function() {
          $scope.selectedPdfTypeId = selected;
          $scope.selectedPdf = $scope.profile.company_deck[$scope.selectedPdfTypeId - 1];
          $scope.updatePdf();
        });
      });

      if($scope.selectedPdf != null) {
        $('.products-tech-header a.selectBox').show();
      }
      else {
        $('.products-tech-header a.selectBox').hide();
      }

      $targetSelect.selectBox('refresh');
    }
  };
});


//define services for company
companyApp.factory("companyService", function($http) {
  return {
    addPatents: function(params) {
      return $http({
        url: "/api/company/add_patents",
        method : "POST",
        data: params
      });
    },

    claimOpenProfile: function(params) {
      return $http({
        url: "/api/company/claim_open_profile",
        method: "POST",
        data: params
      });
    },

    seeAll: function(companyId, type) {
      query = "/" + companyId + "?type=" + type;
      return $http({
        url: "/api/company/see_all" + query,
        method : "GET"
      });
    },

    editOptions: function() {
      return $http({
        url: "/api/company/edit_options",
        method : "GET"
      });
    },

    updatePatents: function(params) {
      return $http({
        url: "/api/company/update_patents",
        method : "PUT",
        data: params
      });
    },

    toggleVisible: function(params) {
      return $http({
        url: "/api/company/toggle_visible",
        method : "POST",
        data: params
      });
    },

    updateAlternateNames: function(params) {
      return $http({
        url: "/api/company/alternate_names",
        method : "POST",
        data: params
      });
    },

    addInvestor: function(params) {
      return $http({
        url: "/investors?source=investments",
        method : "POST",
        data: params
      });
    },

    addCompany: function(params) {
      return $http({
        url: "/companies.json?source=relationships",
        method : "POST",
        data: params
      });
    },

    requestUpdate: function(params, companyId) {
      return $http({
        url: "/api/company/request_update/" + companyId,
        method : "POST",
        data: params
      });
    },

    sendFeedback: function(params) {
      return $http({
        url: "/api/company/send_feedback",
        method : "POST",
        data: params
      });
    },

    createUserList: function(params) {
      return $http({
        url: "/user_lists/create.json",
        method : "POST",
        data: params
      });
    },

    updateUserLists: function(params) {
      return $http({
        url: "/user_lists/add_companies_to_lists.json?" + params,
        method : "GET"
      });
    },

    contactProfile: function(params, companyId) {
      return $http({
        url: "/api/company/" + companyId + "/contact_po",
        method : "POST",
        data: params
      });
    },

    shareProfile: function(params, companyId) {
      return $http({
        url: "/api/company/" + companyId + "/share_profile",
        method : "POST",
        data: params
      });
    },

    inviteColleague: function(params, companyId) {
      return $http({
        url: "/api/company/" + companyId + "/invite_colleague",
        method : "POST",
        data: params
      });
    },

    getCompanyProfile: function(companyId) {
      return $http.get("/api/company/profile/" + companyId);
    },

    patents: function(companyId, sort, dir, type) {
      var append = "?sort_by=" + sort + "&direction=" + dir + "&type=" + type;
      return $http.get("/api/search/patents/" + companyId + append);
    },

    updateCompanyProfile: function(params, id) {
      return $http({
        url: "/api/company/update.json",
        method: "POST",
        data: params
      });
    },

    follow: function(entity_id) {
      return $http({
        url: "/account/follow",
        method: "POST",
        data: { entity_id : entity_id }
      });
    },

    unfollow: function(entity_id) {
      return $http({
        url: "/account/unfollow",
        method: "POST",
        data: { entity_id : entity_id }
      });
    },

    uploadCompanyDeck: function(companyId, deckId, typeId, files) {
      var fd = new FormData();

      angular.forEach(files, function(file) {
        fd.append('file', file);
      });

      fd.append('user_submitted_type_id', typeId);
      fd.append('deck_id', deckId);

      return $http.post("/api/company/" + companyId + "/upload_deck_pdf",
        fd,
        {
          transformRequest: angular.identity,
          headers: {'Content-Type':undefined}
        }
      );
    },

    updateOverview: function(companyId, params, files, parentCompanyIds) {
      var fd = new FormData();

      angular.forEach(files, function(file) {
        fd.append('company[company_logo]', file);
      });

      fd.append('type', $('#company-content').attr('data-profile-type'));
      fd.append('company[short_description]', params.short_description || "");
      fd.append('company[year_founded]', params.year_founded|| "");
      fd.append('company[development_stage_id]', params.development_stage_id || "");
      fd.append('company[investor_type_id]', params.investor_type_id || "");
      fd.append('company[industry_type_id]', params.industry_type_id || "");
      fd.append('company[company_status_id]', params.company_status_id || "");
      fd.append('company[industry_group_id]', params.industry_group_id || "");
      fd.append('company[primary_tag_id]', params.primary_tag_id || "");
      fd.append('company[address]', params.address || "");
      fd.append('company[city]', params.city || "");
      fd.append('company[state]', params.state || "");
      fd.append('company[zip]', params.zip || "");
      fd.append('company[country_id]', params.country_id || "");
      fd.append('company[website]', params.website || "");
      fd.append('company[ticker_symbol]', params.ticker_symbol || "");
      fd.append('parent_company_ids', parentCompanyIds || []);

      return $http.post("/api/company/" + companyId + "/overview",
        fd,
        {
          transformRequest: angular.identity,
          headers: {'Content-Type':undefined}
        }
      );
    },

    updateProduct: function(companyId, params, files) {
      var fd = new FormData();
      var type = "add";

      fd.append('remove', params['remove']);
      fd.append('product_id', params.product_id || "");

      if(params['add'] || params['update']) {
        type = (params.product_id || "") == "" ? "add" : "update";

        angular.forEach(files, function(file) {
          fd.append(type + '[product][product_image]', file);
        });

        fd.append('type', $('#company-content').attr('data-profile-type'));
        fd.append(type + '[product][name]',                   params[type].product.name                    || "");
        fd.append(type + '[product][description]',            params[type].product.description             || "");
        fd.append(type + '[product][product_status_id]',      params[type].product.product_status_id       || "");
        fd.append(type + '[product][revenue_id]',             params[type].product.revenue_id              || "");
        fd.append(type + '[product][company_id]',             params[type].product.company_id              || "");
        fd.append(type + '[product][usd_per_kw_current]',     params[type].product.usd_per_kw_current      || "");
        fd.append(type + '[product][usd_per_kwh_current]',    params[type].product.usd_per_kwh_current     || "");
        fd.append(type + '[product][usd_per_kw_prospected]',  params[type].product.usd_per_kw_prospected   || "");
        fd.append(type + '[product][usd_per_kwh_prospected]', params[type].product.usd_per_kwh_prospected  || "");
      }

      return $http.post("/api/company/" + companyId + "/product",
        fd,
        {
          transformRequest: angular.identity,
          headers: {'Content-Type':undefined}
        }
      );
    },

    deleteCompanyDeck: function(deckId) {
      return $http({
        url: "/api/company/" + deckId + "/deck_pdf",
        method: "DELETE"
      });
    }
  };
});

//Update company
companyApp.controller("showCtrl", ["$scope","$location","$http","$anchorScroll","companyService","$window","$sce","companyProfileInitData",function($scope, $location, $http, $anchorScroll, companyService, $window, $sce,companyProfileInitData) {
  $scope.profile = companyProfileInitData;
  $scope.companyRecommendations = angular.copy($scope.profile.recommendations);
  $scope.URL_REGEXP = /^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;
  $scope.isEditingMode = false;
  $scope.patentType = 'uspto';
  $scope.showAll = {};
  $scope.showPencil = {};
  $scope.showLoading = {
    'investments_made_more' : false
  };
  $scope.isEditing = {};
  $scope.showSave = {};
  $scope.primary_tag_id = 0;
  $scope.allPatentsVisible = true;
  $scope.teammember = {};
  $scope.editOptions = {};
  $scope.boardmember = {};
  $scope.showUpdateEditor = {};
  $scope.notePreDelete = false;
  $scope.globalEdit = false;
  $scope.globalLoading = true;
//  $scope.teammemberSelected = false;
//  $scope.boardmemberSelected = false;
  $scope.product = {};
  $scope.boardmember = {};
  $scope.ipoHistory = $scope.profile.ipo_history;
  $scope.acquisition = {};
  $scope.htmlBindings = {
    trustedAcquiredCompanyHtml : "",
    parentCompaniesHtml : "",
    childCompaniesHtml : "",
    subsidiaryCompaniesHtml : ""
  };
  $scope.product_image = null;
  $scope.selectedPdf = null;
  $scope.selectedPdfTypeId = 1;
  $scope.showFollowingLoading = false;
  $scope.following_text = "Follow";
  $scope.userName = $('#user_name').val();
  $scope.companyName = $('#company_name').val();
  $scope.isModalSaving = {
    shareProfile: false,
    contactProfile: false,
    requestUpdate: false,
    sendFeedback: false,
    addPipeline: false,
    addCompany: false,
    addInvestor: false,
    inviteColleague: false,
    alternateName: false,
    addPatents: false
  };
  $scope.showLoader = {
    toggleVisible: false
  };
  $scope.isShowing = {
    shareProfile : false,
    contactProfile : false,
    requestUpdate : false,
    sendFeedback: false,
    addPipeline : false,
    addCompany: false,
    addInvestor: false
  };
  $scope.messages = {
    shareProfile : "",
    contactProfile : "",
    requestUpdate : "",
    sendFeedback: "",
    normalEdit : "",
    corporateEdit : "",
    basicEdit : "",
    addPipelineButton : "Create a new list",
    addPipeline : "",
    addCompany : "",
    addInvestor: "",
    hideOrPublish: "Hide",
    inviteColleague: ""
  };
  $scope.addInvestorFrom = "";
  $scope.addCompanyFrom = "";
  $scope.contactProfileList = null;
  $scope.contactProfileBody = $('#contact-profile-body').val();
  $scope.orderByField = {
    'investor_portfolios_document' : 'first_investment_at',
    'investments_made' : 'investment_date',
    'program_participant_list': 'date'
//    'program_cohort_info': 'created_at'
  };
  $scope.reverseSort = {
    'investor_portfolios_document' : true,
    'investments_made' : true,
    'program_participant_list': true
//     'program_cohort_info': true
  };
  $scope.loading = {};
  $scope.patentOrderByField = "filed_on";
  $scope.patentReverseSort = true;
  maSelector = null;
  customerSelector = null;
  relationshipSelector = null;

  $scope.teamSelector = $('#add_teams_input').tokenInput(getTeamSearchUrl, {
    queryParam: "term",
    tokenLimit: 1,
    searchDelay: 1000,
    onAdd: function(e) {
      $('.show-add-team-link').hide();
      $('#add-team-span').append("<div id='management-data' style='display:none;' data-first='"+e.first_name+"' data-last='"+e.last_name+"'></div>");
      $('#add-team-span').trigger('click');
      $scope.$apply(function() {
      //  $scope.showUpdateEditor['teammember'] = true;
      });
    },
    onDelete: function() {
      $('.show-add-team-link').show();
      $scope.$apply(function () {
      });
    }
  });

  $scope.boardmemberSelector = $('#add_boardmembers_input').tokenInput(getBoardmemberSearchUrl, {
    queryParam: "term",
    tokenLimit: 1,
    searchDelay: 1000,
    onAdd: function(e) {
      $('.show-add-boardmember-link').hide();
      $('#add-board-span').append("<div id='board-data' style='display:none;' data-first='"+e.first_name+"' data-last='"+e.last_name+"'></div>");
      $('#add-board-span').trigger('click');
      $scope.$apply(function() {
      //  $scope.showUpdateEditor['boardmember'] = true;
      });
    },
    onDelete: function() {
      $('.show-add-boardmember-link').show();
      $scope.$apply(function () {
      //  $scope.showUpdateEditor['boardmember'] = false;
      });
    }
  });
  
  
  

  $scope.teammemberSocialClick = function(event) {
    var target = $(event.target);

    if(target.hasClass('social')) {
      event.stopPropagation();
      event.preventDefault();

      var parent = target.parent();

      if(parent.hasClass('link_linkedin')) {
        $window.open(parent.attr('ng-href'));
      }
      else if(parent.hasClass('link_email')) {
        $scope.contactProfileList = [$scope.profile.primary_contact];
        $('#contact-profile-body').val($scope.contactProfileBody);
        $('#contact_profile_owner_modal').css("left", "50%");
        $('#contact_profile_owner_modal').css("top", $(window).scrollTop() + 75);
      }
    }
  };

  $scope.teammemberFullSocialClick = function(event) {
    var target = $(event.target);

    if(target.hasClass('social')) {
      event.stopPropagation();
      event.preventDefault();

      var parent = target.parent();

      if(parent.hasClass('link_linkedin')) {
        $window.open(parent.attr('ng-href'));
      }
      else if(parent.hasClass('link_email')) {
        $scope.contactProfileList = [{
          id: parent.attr("data-user-id"),
          first_name: parent.attr("data-first-name"),
          last_name: parent.attr("data-last-name")
        }];
        var full_name = parent.attr("data-first-name") + " " + parent.attr("data-last-name");
        $('#contact-profile-body').val($scope.profile.po_contact_bodies[full_name]);
       // $scope.overlay['contactProfile'].toggle("open");
        openPopup("#contact_profile_owner_modal");
        centerModal("contact_profile_owner_modal");
        $('#contact_profile_owner_modal').css("left", "50%");
        $('#contact_profile_owner_modal').css("top", $(window).scrollTop() + 75);
        //$(".contact-profile-button").trigger("click");
      }
    }
  };

  $scope.seeAll = function(type) 
  {
  	var itemLength = $scope.profile[type].length;
  	var slideUpElem = $('.' + type + '-table tbody tr:not(.edit-row):nth-child(6)');
  	var slideDownElem = $('.' + type + '-table tbody tr:not(.edit-row)');
  	
  	
  	
    if(itemLength > 5) {
      if($scope.showAll[type]) {
        //everything currently shown...now hide
        slideUpElem.nextAll().slideUp();
      }
      else {
        slideDownElem.nextAll().slideDown();
      }

      $scope.showAll[type] = !$scope.showAll[type];
    }
    else {
      $scope.loading[type] = true;
      companyService.seeAll($scope.companyId, type).
        success(function(data, status) {
          $scope.profile[type] = data;
          $scope.showAll[type] = true;
          $scope.loading[type] = false;
        }).
        error(function(data, status) {
          $scope.loading[type] = false;
        });
    }
  };

  $scope.togglePatents = function(type) {
    var checked = $("#all-" + type).is(':checked');
    angular.forEach($scope.profile.patent_data[type.replace('-','_')+"_patents"], function(item) {
      item.is_visible = checked;
    });
  };

  $scope.addPatents = function(isValid) {
    $scope.submitted = true;

    if(isValid) {
      var params = {
        company_id: $scope.companyId,
        patent_num: $scope.patent.patent_num,
        published_app_num: $scope.patent.published_app_num,
        application_num: $scope.patent.application_num,
        type: $scope.patentType
      };

      $scope.isModalSaving['addPatents'] = true;
      companyService.addPatents(params)
        .success(function(data, status) {
          $('.close').trigger("click");
          $scope.isModalSaving['addPatents'] = false;
          $scope.submitted = false;
          $('#patent-submitted').css("top", $(window).scrollTop() + 75);
          openPopup("#patent-submitted");
        }).
        error(function(data, status) {
          $scope.isModalSaving['addPatents'] = false;
        });
    }
  };

  $scope.contactMeFor = function(event) {
    var target = $(event.target);
    event.stopPropagation();
    event.preventDefault();

    $scope.contactProfileList = [{
      id: target.attr("data-user-id"),
      first_name: target.attr("data-first-name"),
      last_name: target.attr("data-last-name")
    }];
    $('#contact-profile-body').val($scope.contactProfileBody);
    openPopup("#contact_profile_owner_modal");
    centerModal("contact_profile_owner_modal");
    $('#contact_profile_owner_modal').css("left", "50%");
    $('#contact_profile_owner_modal').css("top", $(window).scrollTop() + 75);
  };

  $scope.investorAdd = function(isValid) {
    $scope.addInvestorSubmitted = true;

    if(isValid && !$scope.isShowing['addInvestor']) {
      var params = {
        company: {
          name: $scope.addInvestor.name,
          country_id: $scope.addInvestor.country_id,
          investor_type_id: $scope.addInvestor.investor_type_id
        }
      };

      $scope.messages['addInvestor'] = "";
      $scope.isShowing['addInvestor'] = true;
      $scope.isModalSaving['addInvestor'] = true;

      companyService.addInvestor(params)
        .success(function(data, status) {
          $scope.addInvestorSubmitted = false;
          $scope.addInvestor.name = "";
          $scope.addInvestor.country_id = 15026;
          $scope.addInvestor.investment_type_id = null;

          if($scope.addInvestorFrom == "team") {
            investorSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else {
            investmentSelector.tokenInput("add", {id:data.id, name:data.name});
          }

          $('.close').trigger("click");
          $scope.isShowing['addInvestor'] = false;
          $scope.isModalSaving['addInvestor'] = false;
        })
        .error(function(data, status) {
          $scope.messages['addInvestor'] = data;
          $scope.isShowing['addInvestor'] = false;
          $scope.isModalSaving['addInvestor'] = false;
        });
    }
  };

  $scope.toggleVisible = function() {
    if(!$scope.showLoader['toggleVisible']) {
      $scope.showLoader['toggleVisible'] = true;

      var params = {
        id : $scope.companyId
      };

      companyService.toggleVisible(params)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.messages['hideOrPublish'] = $scope.profile.company.hidden ? "Publish" : "Hide";
          $scope.showLoader['toggleVisible'] = false;
        })
        .error(function(data, status) {
          $scope.showLoader['toggleVisible'] = false;
        });
    }
  };

  $scope.switchPatent = function(type) {
    $scope.patentType = type;

    if(type == "uspto") {
      $('#uspto-btn').addClass("selected");
      $('#espacenet-btn, #uspto-published-btn').removeClass("selected");
    }
    else if(type == "uspto-published") {
      $('#uspto-published-btn').addClass("selected");
      $('#espacenet-btn, #uspto-btn').removeClass("selected");
    }
    else if(type == "espacenet") {
      $('#uspto-btn, #uspto-published-btn').removeClass("selected");
      $('#espacenet-btn').addClass("selected");
    }
  };

  $scope.companyAdd = function(isValid) {
    $scope.addCompanySubmitted = true;

    if(isValid && !$scope.isShowing['addCompany']) {
      var params = {
        company: {
          name: $scope.addCompany.name,
          country_id: $scope.addCompany.country_id
        }
      };

      $scope.messages['addCompany'] = "";
      $scope.isShowing['addCompany'] = true;
      $scope.isModalSaving['addCompany'] = true;

      companyService.addCompany(params)
        .success(function(data, status) {
          $scope.addCompanySubmitted = false;
          $scope.addCompany.name = "";
          $scope.addCompany.country_id = 15026;

          if($scope.addCompanyFrom == "relationship") {
            relationshipSelector.tokenInput("clear");
            relationshipSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else if($scope.addCompanyFrom == "ma") {
            maSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else if($scope.addCompanyFrom == "customer") {
            customerSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else if($scope.addCompanyFrom == "investments-made") {
            relationshipSelector.tokenInput("add", {id:data.id, name:data.name});
          }

          $('.close').trigger("click");
          $scope.isShowing['addCompany'] = false;
          $scope.isModalSaving['addCompany'] = false;
        })
        .error(function(data, status) {
          $scope.messages['addCompany'] = data;
          $scope.isShowing['addCompany'] = false;
          $scope.isModalSaving['addCompany'] = false;
        });
    }
  };

  $scope.parentSelector = $('#add_parent_input').tokenInput(getParentSearchUrl, {
    queryParam: "term",
    searchDelay: 1000,
    tokenLimit: 1
  });

  // $scope.secondaryTagSelector = $('#add_secondary_tag_input').tokenInput(getSecondaryTagSearchUrl, {
  //   queryParam: "term",
  //   searchDelay: 1000
  // });

  $scope.geographySelector = $('#add_geography_input').tokenInput($scope.profile.edit_options.regions, {
    queryParam: "term",
    minChars: 0,
    preventDuplicates: true
  });

  $scope.stageSelector = $('#add_stage_input').tokenInput($scope.profile.edit_options.stages, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 500,
    preventDuplicates: true
  });

  $scope.corporateTagsSelector = $('#add_corporate_tags_input').tokenInput(getCorporateTagsSearchUrl, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 300,
    preventDuplicates: true
  });

  $scope.dealTypeSelector = $('#add_deal_types_input').tokenInput($scope.profile.edit_options.deal_types, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 500,
    preventDuplicates: true
  });

  $scope.revenueRangeSelector = $('#add_revenue_range_input').tokenInput($scope.profile.edit_options.revenue_ranges, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 500,
    preventDuplicates: true
  });

  $scope.togglePortfolioRounds = function(type) {
    if(type == 'portfolio') {
      $scope.showRounds = false;
      $("#portfolio-tab-link").removeClass("deselected-tab-link").addClass("selected-tab-link");
      $("#rounds-tab-link").removeClass("selected-tab-link").addClass("deselected-tab-link");
    }
    else {
      $scope.showRounds = true;
      $("#rounds-tab-link").removeClass("deselected-tab-link").addClass("selected-tab-link");
      $("#portfolio-tab-link").removeClass("selected-tab-link").addClass("deselected-tab-link");
    }
  };

  $scope.togglePatentAbstract = function(event) {
    var target = $(event.target);
    event.preventDefault();
    event.stopPropagation();
    target.next('div').css('display') == "none" ? target.siblings('div').slideDown() : target.siblings('div').slideUp();
  };

  $scope.hidePatents = function(type) {
    $('#' + type + '-table .patent-table tbody input:not(:checked)').each(function() { $(this).closest('tr').hide(); });
    $('#' + type + '-table .patent-table tbody tr:visible').each(function(i) {
      if(i > 5) {
        $(this).hide();
      }
    });

    $scope.showAll[type.replace('-','_') + '_patents'] = false;
  };

  $scope.showAllPatents = function(type) {
    var type_replaced = type.replace('-','_') + '_patents';
    if( (type == "uspto" && $scope.profile.patent_data.uspto_patents.length > 5) ||
        (type == "uspto-published" && $scope.profile.patent_data.uspto_published_patents.length > 5) ||
        (type == "espacenet" && $scope.profile.patent_data.espacenet_patents.length > 5) ){
      $('#' + type + '-table .patent-table tbody tr').nextAll().slideDown();
      $scope.showAll[type_replaced] = true;
    }
    else {
      $scope.loading[type] = true;
      companyService.patents($scope.companyId, $scope.patentOrderByField, $scope.patentReverseSort, type)
        .success(function(data, status) {
          type_replaced = data.type.replace('-','_') + "_patents";
          $scope.profile.patent_data[type_replaced] = data.data;
          $scope.showAll[type_replaced] = true;
          $scope.loading[data.type] = false;
        })
        .error(function(data, status) {
        });
    }
  };

  $scope.toggleUpdateEditor = function(tile) {
    $scope.showUpdateEditor[tile] = !$scope.showUpdateEditor[tile];

    switch(tile) {
      case "note":
        $scope.note = {
          note_date : $.datepicker.formatDate('m/dd/yy', new Date())
        };

        break;
    }

    $('.token-input-dropdown').hide();
  };
  
  
  $scope.toggleNoteDelete = function()
  {
  	$scope.notePreDelete = false;
  	$scope.noteDeleteId = null;
  };


  $scope.getNote = function (noteId)
  {
  	if ($scope.notePreDelete || $scope.showLoading['note'] || $scope.showUpdateEditor['note'])
  	{
  		return;
  	}
  	
  	$scope.noteDisplayId = noteId;
    $scope.noteDisplayStr =  'Displaying note ID => ' + noteId;
  };


  $scope.toggleNoteUpdateEditor = function(tile, structureId) {
    $scope.showUpdateEditor[tile] = !$scope.showUpdateEditor[tile];

	$scope.note = {
		note_date : $.datepicker.formatDate('m/dd/yy', new Date()),
		user_note_structure_id: structureId
	};
	
    if (structureId == 1)
    {
    	$scope.note.qa_info = $scope.profile.notes_unstruct_q;
    }
    else if (structureId == 2)
    {
    	$scope.note.qa_info = $scope.profile.notes_struct_q;
    }	

    $('.token-input-dropdown').hide();
  	$scope.noteDisplayId = null;
  };



  $scope.trustedPdfSrc = function(url) {
    return $sce.trustAsResourceUrl(url);
  };

  //formats date from YYYY-MM-DD to MM/DD/YYYY
  function formatDateProper(format_date) {
    if(format_date) {
      var a = format_date.split("-");
      return (a[1] + "/" + a[2] + "/" + a[0]);
    }

    return format_date;
  };

  $scope.formatDateProper = function(format_date) {
    return formatDateProper(format_date);
  };

  $scope.sendFeedbackPatent = function() {
    var params = {
      subj: "Feedback - patents",
      feedback: $('#feedback_comment').val()
    }

    $scope.isModalSaving['sendFeedback'] = true;

    companyService.sendFeedback(params)
      .success(function(data, status) {
        $scope.isModalSaving['sendFeedback'] = false;
        $('.close').trigger("click");
      })
      .error(function(data, status) {
        $scope.isModalSaving['sendFeedback'] = false;
      });
  };

  $scope.tagsEdit = function(event) {
    $scope.primary_tag_id = $scope.profile.company.primary_tag_id;
    $scope.industry_group_id = $scope.profile.company.industry_group_id;

    // $scope.secondaryTagSelector.tokenInput("clear");
    //
    // for(var i = 0; $scope.profile.edit_company_tags && (i < $scope.profile.edit_company_tags.length); i++) {
    //   $scope.secondaryTagSelector.tokenInput("add", {id: $scope.profile.edit_company_tags[i].id, name: $scope.profile.edit_company_tags[i].name});
    // }
  };

  $scope.tagPresent = function(tag) {
    tag = tag.toLowerCase();
    if ($scope.profile.company.primary_tag != null && $scope.profile.company.primary_tag.toLowerCase() == tag) {
      return true;
    }

    var tag_list = $scope.profile.edit_company_tags
    var arrayLength = tag_list.length;
    for (var i = 0; i < arrayLength; i++) {
      if (tag_list[i].name.toLowerCase() == tag) {
        return true;
      }
    }
    return false;
  };


  $scope.alternateName = function() {
    var params = {
      company_id: $scope.companyId,
      alternate_names: $scope.profile.alternate_names
    };

    $scope.isModalSaving['alternateName'] = true;

    companyService.updateAlternateNames(params)
      .success(function(data, status) {
        $scope.isModalSaving['alternateName'] = false;
        $('.close').trigger("click");
      })
      .error(function(data, status) {
        $scope.isModalSaving['alternateName'] = false;
        alert(data.errorMsg);
      });
  };

  $scope.claimOpenProfile = function(isValid) {
    $scope.submitted = true;

    if(isValid) {
      var params = {
        first_name: $scope.openProfileUser.first_name,
        last_name: $scope.openProfileUser.last_name,
        title: $scope.openProfileUser.title,
        company: $scope.openProfileUser.company,
        email: $scope.openProfileUser.email,
        company_id: $scope.companyId
      };

      companyService.claimOpenProfile(params).
        success(function(data, status) {
          $scope.messages.openProfileUser = data.status_message;
        }).
        error(function(data, status) {
          $scope.messages.openProfileUser = data.status_message;
        });
    }
  };

  $scope.investmentMadeEdit = function(event) {
    var target = event.target.className;

    if(target == "edit-icon" || target == "delete-icon" || target == "delete-icon-comp-rel") {
      event.preventDefault();
      event.stopPropagation();

      var elem = $(event.target).closest(".investment-item");
      var investmentId = elem.attr("data-investment-id");

      if(target == 'edit-icon') {
        relationshipSelector.tokenInput("clear");
        $scope.investment = findItem("investments_made", investmentId);
        $scope.investment.investment_date = formatDateProper($scope.investment.investment_date);
        $scope.showUpdateEditor['investments-made'] = true;

        relationshipSelector.tokenInput("add", {id: $scope.investment.company_id, name: $scope.investment.company.name});
      }
      else if (target == "delete-icon") {
        $scope.investment = {};
        $scope.showUpdateEditor['investments-made'] = false;
        elem.addClass('deleted-investment');
        elem.hide();
      }
      else if (target == "delete-icon-comp-rel") {
        $scope.investment = {};
        $scope.showUpdateEditor['investments-made'] = false;
        elem.addClass('deleted-comp-rel');
        elem.hide();
      }
    }
  };
  

  $scope.noteEdit = function(event) {
    var target = event.target.className;

    if(target == "edit-icon" || target == "delete-icon") {
      event.preventDefault();
      event.stopPropagation();
      var elem = $(event.target).closest(".note-item-details");
      var noteId = elem.attr("data-note-id");
      var notes = null;

      if (target == "edit-icon") {
        $scope.note = findItem("notes", noteId);
        $scope.note.note_date = formatDateProper($scope.note.note_date);
        $scope.showUpdateEditor['note'] = true;
      }
      else if (target == 'delete-icon') {
      	$scope.notePreDelete = true;
      	$scope.noteDeleteId = noteId;
      }
      else {
        $scope.note = {};
        $scope.showUpdateEditor['note'] = false;
        elem.hide();
      }
    }
  };
  
  

  function findItem(typeName, itemId) {
    for(var i = 0; i < $scope.profile[typeName].length; i++) {
      if($scope.profile[typeName][i].id == itemId) {
        return angular.copy($scope.profile[typeName][i]);
      }
    }
  };

  $scope.competitorSelector = $('#edited_competitors_input').tokenInput(getCompanySearchUrl, {
    queryParam: "term",
    searchDelay: 1000
  });


  function getCorporateTagsSearchUrl() {
    var url = "/api/suggest/corporate_tags?current=";
    var selected = [];

    if($scope.corporateTagsSelector) {
      selected = $.map($scope.corporateTagsSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + selected.join(','));
  };

  function getParentSearchUrl() {
    var url = "/api/suggest/company_all_name_and_id?current=";
    var selected = [];

    if($scope.parentSelector) {
      selected = $.map($scope.parentSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + selected.join(','));
  };

  function getSecondaryTagSearchUrl() {
    var url = "/api/suggest/secondary_tags?current=";
    var selected = [];

    // if($scope.secondaryTagSelector) {
    //   selected = $.map($scope.secondaryTagSelector.tokenInput('get'), function(m) { return m.id; });
    // }

    return (url + selected.join(','));
  };

  function getBoardmemberSearchUrl() {
    var url = "/api/suggest/teammember_name?current=";
    var current = $.map($('.boardmember-remove-link'), function (m) { return $(m).attr('data-teammember-id'); });
    var selected = [];

    if($scope.boardmemberSelector) {
      selected = $.map($scope.boardmemberSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + current.concat(selected).join(','));
  };

  function getTeamSearchUrl() {
    var url = "/api/suggest/teammember_name?current=";
    var current = $.map($('.team-full-remove-link'), function (m) { return $(m).attr('data-teammember-id'); });
    var selected = [];

    if($scope.teamSelector) {
      selected = $.map($scope.teamSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + current.concat(selected).join(','));
  };

  function getCompanySearchUrl() {
    var url = "/api/suggest/company_name_and_id?current=";
    var current = $.map($('.competitor-remove-link'), function (m) { return $(m).attr('data-competitor-id'); });
    var selected = [];

    if($scope.competitorSelector) {
      selected = $.map($scope.competitorSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + current.concat(selected).join(','));
  };

  $scope.tiles = $.map($('.app-tile'), function (m) { 
  														var tile_id = $(m).attr('data-tile-id'); 
  														return tile_id;
  									   });
  $scope.companyId = $('#company-content').attr('data-company-id');

  function collectToBeAddedTeammembers() {
    var obj = getManagementCopyData();
    var params = {
      remove_teammember: []
    };

    $('.management-deleted:hidden').each(function(i,f) { params.remove_teammember.push($(f).attr('data-teammember-id')); });

    if(obj) {
      if($scope.teamSelector.tokenInput('get').length > 0) {
        //add existing user to team
        obj['person_id'] = $.map($scope.teamSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['add_existing'] = obj;
      }
      else if(obj.teammember.id == null && obj.teammember.person.id == '') {
        //add new teammember and new person
        params['add'] = obj;
      }
      else if(obj.teammember.id && obj.teammember.person && obj.teammember.person.id) {
        //update existing user to in existing team
        params['update'] = obj;
      }
    }

    return params;
  };

  function collectToBeRemovedI3Users() {
    var params = {
      remove_i3user: []
    };

    $('.i3user-deleted:hidden').each(function(i,f) { params.remove_i3user.push($(f).attr('data-i3user-id')); });

    return params;
  };

  function collectToBeAddedBoardmembers() {
    var obj = getBoardCopyData();
    var params = {
      remove_boardmember: []
    };

    $('.board-deleted:hidden').each(function(i,f) { params.remove_boardmember.push($(f).attr('data-boardmember-id')); });

    if(obj) {
      if($scope.boardmemberSelector.tokenInput('get').length > 0) {
        //add existing user to team
        obj['company_id'] = $scope.companyId;
        obj['person_id'] = $.map($scope.boardmemberSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['add_existing'] = obj;
      }
      else if(obj.boardmember.id == null && obj.boardmember.person.id == "") {
        //add new teammember and new person
        params['add'] = obj;
      }
      else if(obj.boardmember.id && obj.boardmember.person && obj.boardmember.person.id) {
        //update existing user to in existing team
        params['update'] = obj;
      }
    }

    return params;
  };

  function collectToBeAddedCompetitors() {
    var ids = [];
    var new_ids = $.map($scope.competitorSelector.tokenInput('get'), function(m) { return m.id; });

    $('.competitor-list .pictures-250x100 ').each(function(index, value) {
      var elem = $(value);

      if(elem.css('display') != 'none') {
        ids.push(elem.find('a').attr('data-competitor-id'));
      }
    });

    return ids.concat(new_ids);
  };

  function isAnyTeamOrBoardDeleted() {
    return ($('.management-deleted:hidden').length + $('.board-deleted:hidden').length + $('.i3user-deleted:hidden').length) > 0;
  };

  function collectToBeAddedAcquisitions() {
    var obj = getMaCopyData();
    var params = {remove: []};
    $('.ma-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-ma-id')); });

    if(obj) {
      var acquired_id = $.map(maSelector.tokenInput('get'), function(m) { return m.id; }).join("");

      if($('.edit-direction-copy').val() == '1') {
        obj['company_id'] = $scope.companyId;
        obj['acquired_id'] = acquired_id;
      }
      else {
        obj['company_id'] = acquired_id;
        obj['acquired_id'] = $scope.companyId;
      }

      //if id exists, then it's an updates
      if(obj.id) {
        params.update = {};
        params.update.acquisition_id = obj.id;
        params.update.acquisition = obj;
      }
      else {
        params.add = {};
        params.add.acquisition = obj;
      }
    }

    return params;
  };

  function generateParams(tile) {
    var params = {};

    $.each($('.' + tile + 'Input'), function(i,f) {
      var elem = $(f);
      var name = elem.attr('name');
      params[name] = elem.val();
    });

    if(tile == "tags") {
      params['primary_tag_id'] = $scope.primary_tag_id;
      params['industry_group_id'] = $scope.industry_group_id;
      // params['edited_tags'] = $.map($scope.secondaryTagSelector.tokenInput('get'), function(m) { return m.id; });
      params['company_tag_list'] = $('#company_tags_editor_input').val();
    }
    else if(tile == "git") {
      params['amount'] = $scope.seeking_funding && $scope.seeking_funding.amount;

      if($scope.primary_contact_id) {
        params['primary_contact_id'] = $scope.primary_contact_id;
      }
    }
    else if(tile == 'competitors') {
      params['competitor_ids'] = collectToBeAddedCompetitors();
    }
    else if(tile == "traction") {
      params['revenue_range_id'] = $scope.traction.revenue_range_id;
      params['num_employees'] = $scope.traction.num_employees;
    }
    else if(tile == 'team-full') {
      params['teammember'] = collectToBeAddedTeammembers();
      params['boardmember'] = collectToBeAddedBoardmembers();
      params['i3user'] = collectToBeRemovedI3Users();
    }
    else if(tile == "ma") {
      params = collectToBeAddedAcquisitions();
    }
    else if(tile == "team-short") {
      if($scope.profile.primary_contact) {
        params['primary_contact_id'] = $scope.profile.primary_contact.id;
      }
    }
    else if (tile == "investments-made") {
      var obj = {
      };
      
      
      params['remove'] = [];
      $('.editable-investment.deleted-investment').each(function(i,f) {
        params.remove.push($(f).attr('data-investment-id'));
      });
      
      params['remove_comp_rels'] = [];
      $('.editable-investment.deleted-comp-rel').each(function(i,f) {
        params.remove_comp_rels.push($(f).attr('data-investment-id'));
      });
      
      if($scope.investment && $scope.showUpdateEditor['investments-made']) {
        obj['company_id'] = $.map(relationshipSelector.tokenInput('get'), function(m) { return m.id; }).join("");
        params['investment_id'] = $scope.investment.id;

        copyScopeToParamThroughList($scope.investment,
          obj,
          ['id','investment_date','investment_type_id','amount','notes','source']
        );
        if($scope.investment.id) {
          params['update'] = {};
          params['update']['investment'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['investment'] = obj;
        }
      }
    }
    else if(tile == "investment") {
      var obj = getInvestmentCopyData();
      params['remove'] = [];
      
      $('.investment-deleted:hidden').each(function(i,f) { 
      	params.remove.push($(f).attr('data-investment-id')); 
      });

      if(obj) {
        params['investors'] = $.map(investmentSelector.tokenInput('get'), function(m) { return m.id; });
        params['investment_id'] = obj.id;

        if(obj.id) {
          params['update'] = {};
          params['update']['investment'] = obj;
          
		  var inv_list = $('.investors_entered');
          		
		  if (inv_list.length) {
	          params['update']['inc_accel_rel'] = $("input[type=radio][name=inv_rel_sel]:checked").val();
          }
        }
        else {
          params['add'] = {};
          params['add']['investment'] = obj;
          
		  var inv_list = $('.investors_entered');
          		
		  if (inv_list.length) {
	          params['add']['inc_accel_rel'] = $("input[type=radio][name=inv_rel_sel]:checked").val();		  
          }
        }
      }

      if(!$.isEmptyObject($scope.ipoHistory)) {
        params['ipo_history'] = {
          company_id: $scope.companyId
        };

        copyScopeToParamThroughList($scope.ipoHistory,
          params['ipo_history'],
          ["id","ipo_status_id","as_of_date","amount","initial_share","ticker_symbol","exchange","prospectus","source","notes"]
        );
      }
    }
    else if(tile == "relationship") {
      var obj = getRelationshipCopyData();
      params['remove'] = [];
      $('.relationship-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-relationship-id')); });

      if(obj) {
        obj['company1_id'] = $scope.companyId;
        obj['company2_id'] = $.map(relationshipSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['relationship_id'] = obj.id;

        if(obj.id) {
          params['update'] = {};
          params['update']['relationship'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['relationship'] = obj;
        }
      }
    }
    else if(tile == "customer") {
      var obj = getCustomerCopyData();
      params['remove'] = [];
      $('.customer-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-customer-id')); });

      if(obj) {
        obj['company1_id'] = $scope.companyId;
        obj['company2_id'] = $.map(customerSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['relationship_id'] = obj.id;

        if(obj.id) {
          params['update'] = {};
          params['update']['customer'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['customer'] = obj;
        }
      }
    }
    else if(tile == "note") {
      var obj = {};
      
      params['remove'] = [];
      
      if ($scope.noteDeleteId != null)
      {
      	params['remove'].push($scope.noteDeleteId);
      	
      	$scope.notePreDelete = false;
		$scope.noteDeleteId = null;
      }
      
      // PD 20170406 - Disabling this for now since hiding notes is a necessity with the new layout.
//       $('.note-item:hidden').each(function(i,f) { params.remove.push($(f).attr('data-note-id')); });

      if($scope.note && $scope.showUpdateEditor['note']) {
        params['note_id'] = $scope.note.id;
        obj['company_id'] = $scope.companyId;

        copyScopeToParamThroughList($scope.note,
          obj,
          ['note_date','note_text', 'title', 'user_note_structure_id']		// PD 20170403 - Check and make sure adding user_note_structure_id does not effect edits!
        );

        obj['qa_info'] = $scope.note.qa_info;

        if($scope.note.id) 
        {
          params['update'] = {};
          params['update']['note'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['note'] = obj;
        }
      }
    }
    else if(tile == "product") {
      var obj = getProductCopyData();
      params['remove'] = [];
      $('.product-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-product-id')); });

      if(obj) {
        params['product_id'] = obj.id;
        obj['company_id'] = $scope.companyId;

        if(obj.id) {
          params['update'] = {};
          params['update']['product'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['product'] = obj;
        }
      }
    }
    else if(tile == "looking-for") {
      params['snapshot'] = $scope.company.snapshot;
      params['offer'] = $scope.company.offer;
      params['tag_ids'] = $.map($scope.corporateTagsSelector.tokenInput('get'), function(m) { return m.id; });
      params['development_stage_ids'] = $.map($scope.stageSelector.tokenInput('get'), function(m) { return m.id; });
      params['geography_ids'] = $.map($scope.geographySelector.tokenInput('get'), function(m) { return m.id; });
      params['revenue_range_ids'] = $.map($scope.revenueRangeSelector.tokenInput('get'), function(m) { return m.id; });
    }
    else if(tile == "offer") {
      params['offer'] = $scope.company.offer;
      params['deal_type_ids'] = $.map($scope.dealTypeSelector.tokenInput('get'), function(m) { return m.id; });
    }
    else if(tile == "campaign") {
      params['selected'] = $scope.selected_campaigns;
    }
    

    return params;
  };

  $scope.findItem = function(typeName, itemId) {
    return findItem(typeName, itemId);
  };

  $scope.deleteSeekingFunding = function() {
    $('.seeking-funding').hide();
  };

  $scope.scrollTo = function(id) {
    $(window).scrollTo('#'+id);
  //  $location.hash(id);
  //  $anchorScroll();
  };

  function copyScopeToParamThroughList(s, p, l) {
    for(var i = 0; i < l.length; i++) {
      p[l[i]] = s[l[i]];
    }
  };

  function getCustomerCopyData() {
    var customer = $('.customer-copy');

    if(customer.length > 0) {
      return {
        id: customer.prop('data-customer-id'),
        relationship_date: customer.find('.edit-date').val(),
      //  relationship_type_id:
      //  size:
        confirmation_email: customer.find('.edit-email').val(),
        notes: customer.find('.edit-notes').val(),
        source: customer.find('.edit-source').val()
      };
    }

    return false;
  };

  function getInvestmentCopyData() {
    var investment = $('.investment-copy');

    if(investment.length > 0) {
      var ivalue = investment.find('.edit-investment-type').val();
      var iid = (ivalue == "" || ivalue == "?") ? null : $scope.profile.edit_options.investment_types[investment.find('.edit-investment-type').val()].id;

      return {
        company_id: $scope.companyId,
        id: investment.prop('data-investment-id'),
        investment_date: investment.find('.edit-date').val(),
        investment_type_id: iid,
        amount: investment.find('.edit-amount').val(),
        valuation: investment.find('.edit-valuation').val(),
        notes: investment.find('.edit-notes').val(),
        source: investment.find('.edit-source').val()
      };
    }

    return false;
  };

  function getManagementCopyData() {
    var p = $('.management-copy');

    if(p.length > 0) {
      return {
        teammember : {
          person_id: p.find('.edit-person').val(),
          date_joined: p.find('.edit-joined').val(),
          date_departed: p.find('.edit-departed').val(),
          id: p.prop('data-teammember-id'),
          title : p.find('.edit-title').val(),
          company_id : $scope.companyId,
          person: {
            first_name: p.find('.edit-first').val(),
            last_name: p.find('.edit-last').val(),
            linkedin_url: p.find('.edit-linkedin').val(),
            id: p.find('.edit-person').val()
          }
        },
        company_id : $scope.companyId,
        team_id : p.prop('data-teammember-id')
      };
    }

    return false;
  };


  function getBoardCopyData() {
    var p = $('.board-copy');

    if(p.length > 0) {
      var rid = p.find('.edit-role').val() != "" ? $scope.profile.edit_options.board_member_roles[p.find('.edit-role').val()].id : null;
      return {
        boardmember : {
          person_id: p.find('.edit-person').val(),
          role_id: rid,
          start_date: p.find('.edit-start').val(),
          end_date: p.find('.edit-end').val(),
          id: p.prop('data-board-id'),
          company_id : $scope.companyId,
          investor_id: $.map(investorSelector.tokenInput('get'), function(m) { return m.id; }).join(""),
          person: {
            first_name: p.find('.edit-first').val(),
            last_name: p.find('.edit-last').val(),
            linkedin_url: p.find('.edit-linkedin').val(),
            id: p.find('.edit-person').val()
          }
        },
        company_id : $scope.companyId,
        boardmember_id : p.prop('data-board-id')
      };
    }

    return false;
  };

  function getMaCopyData() {
    var p = $('.ma-copy');

    if(p.length > 0) {
      return {
        id: p.prop('data-ma-id'),
        date_closed: p.find('.edit-date-closed').val(),
        date_announced: p.find('.edit-date-announced').val(),
        notes: p.find('.edit-notes').val(),
        source: p.find('.edit-source').val(),
        amount: p.find('.edit-amount').val()
      };
    }

    return false;
  };

  function getRelationshipCopyData() {
    var p = $('.relationship-copy');

    if(p.length > 0) {
      var rti = p.find('.edit-relationship-type').val() != "" ? $scope.profile.edit_options.partnership_relationship_types[p.find('.edit-relationship-type').val()].id : null;
      return {
        id: p.prop('data-relationship-id'),
        relationship_date: p.find('.edit-date').val(),
        relationship_type_id: rti,
        confirmation_email: p.find('.edit-email').val(),
        notes: p.find('.edit-notes').val(),
        source: p.find('.edit-source').val()
      };
    }

    return false;
  };

  function getProductCopyData() {
    var p = $('.product-copy');

    if(p.length > 0) {
      var psid = p.find('.edit-status').val() != "" ? $scope.profile.edit_options.product_statuses[p.find('.edit-status').val()].id : null;
      var rid = p.find('.edit-revenue').val() != "" ? $scope.profile.edit_options.revenues[p.find('.edit-revenue').val()].id : null;
      return {
        id: p.prop('data-product-id'),
        name: p.find('.edit-name').val(),
        description: p.find('.edit-description').val(),
        product_status_id: psid,
        revenue_id: rid,
        usd_per_kw_current: p.find('.edit-usd_per_kw_current').prop('value'),
        usd_per_kwh_current: p.find('.edit-usd_per_kwh_current').prop('value'),
        usd_per_kw_prospected: p.find('.edit-usd_per_kw_prospected').prop('value'),
        usd_per_kwh_prospected: p.find('.edit-usd_per_kwh_prospected').prop('value')
      };
    }

    return false;
  };


  function firstValidPdf(decks) {
    for(var i = 0; decks && (i < decks.length); i++) {
      if(decks[i]) {
        $scope.selectedPdfTypeId = i + 1;
        return decks[i];
      }
    }
    return null;
  };

  function editOptionsLoad() {
    companyService.editOptions()
      .success(function(data, status) {
        $scope.editOptions = data;
      })
      .error(function(data, status) {
        alert("Unable to load edit options");
      });
  };


  $scope.tiles.forEach(function(t) {
    $scope.showPencil[t] = false;
    $scope.showLoading[t] = true;
    $scope.isEditing[t] = false;
    $scope.showSave[t] = false;
    $scope.showUpdateEditor[t] = false;
  });

  function runAfterLoad() {
  //  editOptionsLoad();

    if($scope.profile.structure) {
      $scope.htmlBindings['parentCompaniesHtml'] = $sce.trustAsHtml($scope.profile.structure.parent);
      $scope.htmlBindings['childCompaniesHtml'] = $sce.trustAsHtml($scope.profile.structure.child);
      $scope.htmlBindings['subsidiaryCompaniesHtml']= $sce.trustAsHtml($scope.profile.structure.subsidiary);
    }

    if($scope.profile.patent_data && $scope.profile.patent_data.uspto_count == 0) {
      if($scope.profile.patent_data && $scope.profile.patent_data.espacenet_count > 0) {
        $scope.switchPatent("espacenet");
      }
      else if ($scope.profile.patent_data && $scope.profile.patent_data.uspto_published_count > 0) {
        $scope.switchPatent("uspto-published");
      }
    }

    $scope.selectedPdf = firstValidPdf($scope.profile.company_deck);//$scope.profile.company_deck[$scope.selectedPdfTypeId - 1];
    $('#select-pdf-options').val($scope.selectedPdfTypeId);
    $('#select-pdf-options').selectBox('refresh');
    $scope.globalLoading = false;

    $scope.htmlBindings['trustedAcquiredCompanyHtml'] = $sce.trustAsHtml($scope.profile.acquired_message);

    $scope.tiles.forEach(function(t) {
      $scope.showLoading[t] = false;
      $scope.showPencil[t] = false;
      $scope.following_text = "";
    });

    $scope.messages['hideOrPublish'] = $scope.profile.company.hidden ? "Publish" : "Hide";

    $scope.enableGE();
  };

  $scope.deleteDeckPdf = function() {
    if(!$scope.showLoading['deck']) {
      $scope.showLoading['deck'] = true;
      $scope.showSave['deck'] = false;

      companyService.deleteCompanyDeck($scope.selectedPdf.id)
        .success(function(data, status) {
          $scope.profile.company_deck = data;
          $scope.selectedPdf = null;
          $scope.showLoading['deck'] = false;
          $scope.showSave['deck'] = true;
        })
        .error(function(data, status) {
          $scope.showLoading['deck'] = false;
          $scope.showSave['deck'] = true;
        });
    }
  };

  $scope.updatePrimaryContact = function(position, entities) {
    angular.forEach(entities, function(pc, index) {
      if(position != index)
        pc.checked = false;
    });

    var pc = entities[position];
    var pcId = pc.checked == true ? pc.id + "__AdminUser" : null;
    var params = {id: $scope.companyId, type: "company", sections: {git: {amount: null, primary_contact_id: pcId}}};

    companyService.updateCompanyProfile(params, "git").
      success(function(data, status) {
        $scope.profile = data;
      }).
      error(function(data, status) {

      });
  };

  $scope.toggleGlobalEditor = function() {
    if($scope.globalLoading) {
      return;
    }

    $scope.globalEdit = !$scope.globalEdit;

    if($scope.globalEdit) {
    //global editing on
      $scope.tiles.forEach(function(t) { $scope.showPencil[t] = true; });
      $scope.isEditingMode = true;
      
	      $scope.tiles.forEach(function(t) { 
    	  	if (t.includes("program_")) {
	    	  	$scope.showPencil[t] = false; 
		    }
    	  });
      
    }
    else {
    //global editing off
      $scope.tiles.forEach(function(t) { $scope.showPencil[t] = false; });
      $scope.isEditingMode = false;
    }

    $scope.messages["normalEdit"] = $scope.showPencil['git'] ? "Stop" : "";
    $scope.messages["basicEdit"] = $scope.showPencil['overview'] ? "Stop" : "";
    $scope.messages["corporateEdit"] = $scope.showPencil['overview'] ? "Stop" : "";

    $scope.tiles.forEach(function(t) {
      $scope.showLoading[t] = false;
      $scope.isEditing[t] = false;
      $scope.showSave[t] = false;
    });
  };

  $scope.removeCompetitor = function(e) {
    if(e.target.className == "competitor-remove-icon") {
      e.stopPropagation();
      e.preventDefault();
      var competitorId = $(e.target).parent().attr('data-competitor-id');
      $scope.toRemoveCompetitors.push(competitorId);
      $(e.target).closest(".pictures-250x100").hide();
    }
  };

  $scope.edit = function(id) {
    $scope.showPencil[id] = !$scope.showPencil[id];
    $scope.showSave[id] = !$scope.showSave[id];
    $scope.isEditing[id] = !$scope.isEditing[id];

    if($scope.isEditing[id]) {
      if(id == 'overview') {
        $scope.company = angular.copy($scope.profile.company);

        try {
          $scope.parentSelector.tokenInput("clear");
          for(var i = 0; i < $scope.profile.structure.parent_objs.length; i++) {
            var parent = $scope.profile.structure.parent_objs[i];
            $scope.parentSelector.tokenInput("add", {id: parent.id, name: parent.name});
          }
        }
        catch(err) {
        }
      }
      else if(id == "products_tech") {
        $scope.snapshot = {};
        $scope.snapshot.overview = angular.copy($scope.profile.company.overview);
        $('.products-tech-header a.selectBox').show();
      }
      else if(id == "competitors") {
        $scope.toRemoveCompetitors = [];
        $scope.competitors = angular.copy($scope.profile.competitors);
      }
      else if(id == "traction") {
        $scope.traction = angular.copy($scope.profile.traction);
      }
      else if(id == "team-full") {
        $scope.team = angular.copy($scope.profile.team);
        $('.show-add-team-link').show();
        $('#current_management_selected').hide();
        $scope.addInvestor = { name: "", country_id: 15026, investor_type_id: null };
        $scope.addInvestorFrom = "team";
      }
      else if(id == "git" || id == "team-short") {
        $scope.seeking_funding = angular.copy($scope.profile.seeking_funding);

        if($scope.profile.primary_contact) {
          $scope.primary_contact_id = $scope.profile.primary_contact.id_selected;
        }
      }
      else if(id == "customer") {
        $scope.addCompany = { name: "", country_id: 15026 };
        $scope.addCompanyFrom = "customer";
      }
      else if(id == "ma") {
        $('#merge_direction').val(1);
        $scope.addCompany = { name: "", country_id: 15026 };
        $scope.addCompanyFrom = "ma";
      }
      else if(id == "tags") {
        $scope.tagsEdit(null);
      }
      else if(id == "relationship") {
        $scope.addCompanyFrom = "relationship";
        $scope.addCompany = { name: "", country_id: 15026 };
      }
      else if(id == "investments-made") {
        $scope.addCompany = { name: "", country_id: 15026 };
        $scope.addCompanyFrom = "investments-made";
      }
      else if(id == "investment") {
        $scope.addInvestor = { name: "", country_id: 15026, investor_type_id: null };
        $scope.addInvestorFrom = "investment";
        $scope.ipoHistory = angular.copy($scope.profile.ipo_history);
      }
      else if(id == 'looking-for') {
        $scope.company = angular.copy($scope.profile.company);
        $scope.stageSelector.tokenInput("clear");
        $scope.geographySelector.tokenInput("clear");
        $scope.corporateTagsSelector.tokenInput("clear");
        $scope.revenueRangeSelector.tokenInput("clear");
        $.each($scope.profile.seeking_development_stages, function(k,v) { $scope.stageSelector.tokenInput("add", { id: v.id, name: v.name}); });
        $.each($scope.profile.seeking_geographies, function(k,v) { $scope.geographySelector.tokenInput("add", { id: v.id, name: v.name}); });
        $.each($scope.profile.seeking_tags, function(k,v) { $scope.corporateTagsSelector.tokenInput("add", { id: v.id, name: v.tag_name}); });
        $.each($scope.profile.seeking_revenue_ranges, function(k,v) { $scope.revenueRangeSelector.tokenInput("add", { id: v.id, name: v.name}); });
      }
      else if(id == "offer") {
        $scope.company = angular.copy($scope.profile.company);
        $scope.dealTypeSelector.tokenInput("clear");
        $.each($scope.profile.seeking_deal_types, function(k,v) { $scope.dealTypeSelector.tokenInput("add", { id: v.id, name: v.name}); });
      }
      else if(id == "campaign") {
        $scope.showUpdateEditor['campaign'] = true;
        $scope.selected_campaigns = $.map($scope.profile.selected_campaigns, function(m) { return m.id; });
      }
      else if(id == "patents") {
        $scope.showAllPatents($scope.patentType);
      }
    }
  };

  $scope.updatePipeline = function(isValid) {
    if(isValid && !$scope.isShowing['addPipeline']) {
      $scope.messages['addPipeline'] = "";
      $scope.isShowing['addPipeline'] = true;
      $scope.isModalSaving['addPipeline'] = true;

      var params = {
        remove_unselected : true,
        company_ids : [ $scope.companyId ],
        selected_ids : $.map($('.pipeline-input:checked'), function(m) { return $(m).val(); }),
        presented_list_ids : $.map($('.presented_list_ids'), function(m) {return $(m).val() })
      };

      companyService.updateUserLists(jQuery.param(params))
        .success(function(data, status) {
          $('.close').trigger("click");
          $scope.isModalSaving['addPipeline'] = false;
          $scope.isShowing['addPipeline'] = false;
        })
        .error(function(data, status) {
          $scope.isModalSaving['addPipeline'] = false;
          $scope.isShowing['addPipeline'] = false;
        });
    }
  };

  $scope.addUserList = function() {
    var name = $('#input-user-list').val();

    if(name != "") {
      var user_list = {
        name : name
      };

      $scope.messages['addPipelineButton'] = "Saving...";

      companyService.createUserList(user_list)
        .success(function(data, status) {
          $scope.profile.user_lists.push({ name : data.name, id : data.id, checked : true });
          $('#input-user-list').val("");
          $scope.messages['addPipelineButton'] = "Create list";
        })
        .error(function(data, status) {
          $scope.messages['addPipelineButton'] = "Create list";
          alert(data.status);
        });
    }
  };

  $scope.contactProfile = function(isValid) {
    $scope.submitted = true;

    var params = {
      user_ids: $.map($(".uneditable-input .token-input-token"), function(m) { return $(m).attr('data-id'); }),
      subject: $('#contact-profile-subject').val(),
      body: $('#contact-profile-body').val()
    };

    if(isValid && !$scope.isShowing['contactProfile']) {
      $scope.messages['contactProfile'] = "";
      $scope.isShowing['contactProfile'] = true;
      $scope.isModalSaving['contactProfile'] = true;

      companyService.contactProfile(params, $scope.companyId)
        .success(function(data, status) {
          $scope.submitted = false;
          $scope.contactProfile.emails = null;
          $('.close').trigger("click");
          $scope.isShowing['contactProfile'] = false;
          $scope.isModalSaving['contactProfile'] = false;
          $scope.profile.messages_sent = data.messages_sent;
          $scope.profile.message_url = data.message_url;

        })
        .error(function(data, status) {
          $scope.messages['contactProfile'] = data.status_message;
          $scope.isShowing['contactProfile'] = false;
          $scope.isModalSaving['contactProfile'] = false;
        });
    }
  };

  $scope.requestUpdate = function (isValid) {
    $scope.submitted = true;

    var params = {
      comment : $('#request_update_comment').val()
    }

    if(isValid && !$scope.isShowing['requestUpdate']) {
      $scope.messages['requestUpdate'] = "";
      $scope.isShowing['requestUpdate'] = true;
      $scope.isModalSaving['requestUpdate'] = true;

      companyService.requestUpdate(params, $scope.companyId)
        .success(function(data, status) {
          $scope.submitted = false;
          $('#request_update_comment').val("");
          $('.close').trigger("click");
          $scope.isModalSaving['requestUpdate'] = false;
          $scope.isShowing['requestUpdate'] = false;
        })
        .error(function(data, status) {
          $scope.messages['requestUpdate'] = data.status_message;
          $scope.isModalSaving['requestUpdate'] = false;
          $scope.isShowing['requestUpdate'] = false;
        });
    }
  };

  $scope.inviteColleagues = function(isValid, isCorporate) {
    $scope.submitted = true;

    if(isValid) {
      var params = {
        email : $scope.inviteColleague.emails,
        first_name : $scope.inviteColleague.first_name,
        last_name : $scope.inviteColleague.last_name,
        title: $scope.inviteColleague.title,
        corporate: isCorporate
      };

      $scope.isModalSaving['inviteColleague'] = true;
      $scope.messages['inviteColleague'] = "";

      companyService.inviteColleague(params, $scope.companyId)
        .success(function(data, status) {
          $scope.inviteColleague = {};
          $('.close').trigger("click");
          $scope.isModalSaving['inviteColleague'] = false;
          $scope.messages['inviteColleague'] = "";
          $scope.submitted = false;


        })
        .error(function(data, status) {
          $scope.messages['inviteColleague'] = data.status_message;
          $scope.isModalSaving['inviteColleague'] = false;
        });
    }
  };

  $scope.shareProfile = function(isValid) {
    $scope.submitted = true;

    var params = {
      email : $scope.shareProfile.emails,
      custom_text : $('#custom_text').val()
    };

    if(isValid && !$scope.isShowing['shareProfile']) {
      $scope.messages['shareProfile'] = "";
      $scope.isShowing['shareProfile'] = true;
      $scope.isModalSaving['shareProfile'] = true;

      companyService.shareProfile(params, $scope.companyId)
        .success(function(data, status) {
          $scope.submitted = false;
          $scope.shareProfile.emails = null;
          $('.close').trigger("click");
          $scope.isShowing['shareProfile'] = false;
          $scope.isModalSaving['shareProfile'] = false;
          $scope.messages['shareProfile'] = "";
        })
        .error(function(data, status) {
          $scope.messages['shareProfile'] = data.status_message;
          $scope.isShowing['shareProfile'] = false;
          $scope.isModalSaving['shareProfile'] = false;
        });
    }
  };


  $scope.editTiles = function(type) {
    var tiles = {
      basic : [
        'traction',
        'overview'
      ],
      corporate : [
        'overview',
        'git',
        'looking-for',
        'campaign',
        'offer'
      ],
      normal : [
        'git',
        'ma',
        'tags',
        'team-short',
        'team-full',
        'products_tech',
        'deck',
        'looking-for',
        'competitors',
        'customer',
        'relationship',
        'investment',
        'investments-made',
        'product',
        'note',
        'patents'
      ]
    };

    if(!$scope.globalLoading) {
      for(var i = 0; i < tiles[type].length; i++) {
        $scope.showPencil[tiles[type][i]] = !$scope.showPencil[tiles[type][i]];
      }

      if(type == 'normal') {
        $scope.isEditingMode = !$scope.isEditingMode;
        $scope.messages["normalEdit"] = $scope.showPencil['git'] ? "Stop" : "";

        if($scope.showPencil['products_tech']) {
          $('.products-tech-header a.selectBox').show();
        }
        else if(!$scope.showPencil['products_tech'] && $scope.selectedPdf == null) {
          $('.products-tech-header a.selectBox').hide();
        }
      }
      else if(type == "corporate") {
        $scope.messages["corporateEdit"] = $scope.showPencil['overview'] ? "Stop" : "";
      }
      else {
        $scope.messages["basicEdit"] = $scope.showPencil['overview'] ? "Stop" : "";
      }
    }
  };

  $scope.filesChanged = function(elm) {
    $scope.fileExtensionError = false;

    if(elm.files[0].name.match(/\.([^\.]+)$/)[1].toLowerCase() == "pdf" ) {
      $scope.files = elm.files;
      $scope.upload();
    }
    else {
      alert("File must be PDF");
      $scope.fileExtensionError = true;
    }

    $scope.$apply();
  };

  $scope.productPictureChanged = function(elm) {
    $scope.product_image = elm.files;
    $scope.$apply();

    $('.upload-image-icon').show();

    if($scope.product_image && $scope.product_image[0]) {
      previewImage($scope.product_image[0], "product_image_preview-copy");
      $('.upload-image-icon').hide();
    }
  };

  $scope.logoChanged = function(elm) {
    if(elm.files[0].type == "image/jpeg" || elm.files[0].type == "image/png") {
      $scope.logo_image = elm.files;
      $scope.$apply();

      if($scope.logo_image && $scope.logo_image[0]) {
        previewImage($scope.logo_image[0], "logo_image_preview");
      }
    }
    else {
      alert("File must be JPEG or PNG");
    }
  };

  function previewImage(file, preview_id) {
    var oFReader = new FileReader();
    oFReader.readAsDataURL(file);

    oFReader.onload = function (oFREvent) {
      document.getElementById(preview_id).src = oFREvent.target.result;
    };
  };

  $scope.updateFollowState = function() {
    if(!$scope.showFollowingLoading) {
      $scope.showFollowingLoading = true;

      if($scope.profile.follow == "follow") {
        companyService.follow($scope.profile.company.id)
          .success(function(d, status) {
            if(d.status == "OK") {
              $scope.profile.follow = "following";
              $scope.showFollowingLoading = false;
            }
          })
          .error(function(data, status) {
            $scope.showFollowingLoading = false;
          });
      }
      else if($scope.profile.follow == "following") {
        companyService.unfollow($scope.profile.company.id)
          .success(function(d) {
            if(d.status == "OK") {
              $scope.profile.follow = "follow";
              $scope.showFollowingLoading = false;
            }
          })
          .error(function(data, status) {
            $scope.showFollowingLoading = false;
          });
      }
    }
  };

  $scope.upload = function() {
    var selectedPdfTypeId = $scope.selectedPdfTypeId;
    var deckId = null;

    if(!$scope.showLoading['deck']) {
      if($scope.selectedPdf) {
        selectedPdfTypeId = $scope.selectedPdf.user_submitted_pdf_type_id;
        deckId = $scope.selectedPdf.id;
      }

      if($scope.files) {
        $scope.showLoading['deck'] = true;
        $scope.showSave['deck'] = false;

        companyService.uploadCompanyDeck($scope.companyId, deckId, selectedPdfTypeId, $scope.files)
          .success(function(d) {
            $("#company_file_input").val("");
            $scope.selectedPdf = d.pdf;
            $scope.profile.company_deck = d.pdfs;
            $scope.showLoading['deck'] = false;
            $scope.showSave['deck'] = true;
            location.reload();
          })
          .error(function(data, status) {
            $scope.showSave['deck'] = true;
            $scope.showLoading['deck'] = false;
            console.log(status);
          });
      }
    }
  };

  $scope.saveOverview = function(isValid) {
    var id = "overview";
    $scope.submitted = true;

    if(isValid && !$scope.showLoading[id]) {
      try {
        var parentCompanyIds = $.map($scope.parentSelector.tokenInput('get'), function(m) { return m.id; });
      }
      catch(err) {
        var parentCopmanyIds = [];
      }

      $scope.showLoading[id] = true;
      $scope.showSave[id] = false;

      companyService.updateOverview($scope.companyId, $scope.company, $scope.logo_image, parentCompanyIds)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.submitted = false;
          $scope.showSave[id] = false;
          $scope.showPencil[id] = true;
          $scope.isEditing[id] = false;
          $scope.showLoading[id] = false;
        //  $scope.company = {};
          $scope.logo_image = null;

          if($scope.profile.structure) {
            $scope.htmlBindings['parentCompaniesHtml'] = $sce.trustAsHtml($scope.profile.structure.parent);
          }
        })
        .error(function(data, status) {
          $scope.showSave[id] = true;
          $scope.showLoading[id] = false;
        });
    }
  };

  $scope.enableGE = function() {
    var enable = $('#globalE').val() == "true" ? true : false;

    if(enable) {
      $scope.toggleGlobalEditor();
    }
  };

  $scope.saveProduct = function(id, isValid) {
    $scope.submitted = true;

    if(isValid && !$scope.showLoading[id]) {
      var params = generateParams(id);
      $scope.showLoading[id] = true;
      $scope.showSave[id] = false;

      companyService.updateProduct($scope.companyId, params, $scope.product_image)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.submitted = false;
          $scope.showSave[id] = false;
          $scope.showPencil[id] = true;
          $scope.isEditing[id] = false;
          $scope.showLoading[id] = false;
          $scope.product_image = null;
          $('.product-copy').remove();
          $('.products-table tbody tr:not(.edit-row)').show();
          $scope.showUpdateEditor[id] = false;
        })
        .error(function(data, status) {
          $scope.showSave[id] = true;
          $scope.showLoading[id] = false;
        });
    }
  };

  function validateAutocompleteNonblank(tile, tokenId) {
    var borderId = "#token-input-add_" + tile + "_input";

    if(tokenId != null) {
      borderId = "#token-input-" + tokenId;
    }

    var count = $.map($scope[tile + "Selector"].tokenInput('get'), function(m) { return m.id; }).length;
    $(borderId).closest("ul")
      .css("border-color", "#ddd")
      .css("border-width", "1px");

    if(count == 0) {
      $(borderId).closest("ul")
        .css("border-color", "#ff671b")
        .css("border-width", "2px");
      return false;
    }

    return true;
  };

  function validateAutocomplete2(selector) {
    var borderId = "#token-input-" + selector.prop("id");

    var count = $.map(selector.tokenInput('get'), function(m) { return m.id; }).length;
    $(borderId).closest("ul")
      .css("border-color", "#ddd")
      .css("border-width", "1px");

    if(count < 1) {
      $(borderId).closest("ul")
        .css("border-color", "#ff671b")
        .css("border-width", "2px");
      return false;
    }

    return true;
  };

  $scope.save_and_disable_tag_editor = function(tag_editor_id, id, isValid) {
    var ed = $(tag_editor_id).next('.tag-editor');
    ed.find('input').autocomplete('disable');
    $scope.isEditing['tags'] = false;
    $scope.save(id, isValid);
  };

  $scope.openConfirmDeletePopup = function() {
    if(isAnyTeamOrBoardDeleted()) {
      $('#confirm_team_delete_modal').css('top', $(window).scrollTop() + 100);
      openPopup("#confirm_team_delete_modal");
    }
    else {
      $scope.save('team-full', $scope.boardForm.$valid && $scope.manageForm.$valid);
    }
  };

  $scope.confirmedDelete = function() {
    $('.close').trigger("click");
    $scope.save('team-full', $scope.boardForm.$valid && $scope.manageForm.$valid);
  };

  $scope.save = function(id, isValid) {
    $scope.submitted = true;

    if($scope.isEditing[id]) {
      if("relationship" == id) {
        if(relationshipSelector && !validateAutocomplete2(relationshipSelector)) {
          $scope[id + "Form"].$invalid = true;
          isValid = false;
        }
      }
      else if("customer" == id) {
        if(customerSelector && !validateAutocomplete2(customerSelector)) {
          $scope[id + "Form"].$invalid = true;
          isValid = false;
        }
      }
      else if("ma" == id) {
        if(maSelector && !validateAutocomplete2(maSelector)) {
          $scope[id + "Form"].$invalid = true;
          isValid = false;
        }
      }
    }
    else if(id == "looking-for") {
      if(!validateAutocompleteNonblank("corporateTags", "add_corporate_tags_input")) {
        $scope["editFlowForm"].$invalid = true;
        isValid = false;
      }
    }

    if(isValid && !$scope.showLoading[id]) {
      var params = {
        id : $scope.companyId,
        type : $('#company-content').attr('data-profile-type')
      };

      params['sections'] = {};
      
      params['sections'][id] = generateParams(id);

      $scope.showLoading[id] = true;
      $scope.showSave[id] = false;
      
	 $(".prog_part_button").prop("disabled", true);

      companyService.updateCompanyProfile(params, id)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.submitted = false;
          $scope.showSave[id] = false;
          $scope.showPencil[id] = true;
          $scope.isEditing[id] = false;
          $scope.showLoading[id] = false;

          if(id == 'competitors') {
            $scope.competitorSelector.tokenInput('clear');
          }
          else if(id == 'team-full') {
            $scope.teamSelector.tokenInput('clear');
            $scope.boardmemberSelector.tokenInput("clear");
            $scope.showUpdateEditor['teammember'] = false;
            $scope.showUpdateEditor['boardmember'] = false;
            $('#edit-new-team, #edit-new-board').hide();
            $('.team-find-edit, .board-find-edit').show();
            $('.management-copy, .board-copy').remove();
            $scope.teammember = {};
            $scope.boardmember = {};
          }
          else if(id == "ma") {
            $('.ma-copy').remove();
            $('.ma-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "investment") {
            $('.investment-copy').remove();
            $('.investments-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
            $scope.showUpdateEditor['ipoHistory'] = false;
          }
          else if(id == "relationship") {
            $('.relationship-copy').remove();
            $('.relationships-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "customer") {
            $('.customer-copy').remove();
            $('.customers-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "note") {
            $scope.note = {};
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "git") {
            $scope.seeking_funding = {};
          }
          else if(id == "tags") {
          }
          else if(id == "investments-made") {
            $scope.investment = {};
          }
          else if(id == "looking-for") {
            $scope.company = {};
          }
          else if(id == "offer") {
            $scope.company = {};
          }
          else if(id == "campaign") {
            $scope.showUpdateEditor[id] = false;
          }

          if(firstValidPdf($scope.profile.company_deck) != null) {
            $('.products-tech-header a.selectBox').show();
          }
          else {
            $('.products-tech-header a.selectBox').hide();
          }

          $('.token-input-dropdown').hide();
          
          
		 $(".prog_part_button").prop("disabled", false);
		 
        })
        .error(function(data, status) {
          $scope.showSave[id] = true;
          $scope.showLoading[id] = false;
        });
    }
  };

  $scope.updatePatents = function() {
    var type = $scope.patentType;

    var params = { company_id: $scope.companyId,
      sort_by: $scope.patentOrderByField,
      direction: $scope.patentReverseSort,
      patents: {},
      type: type
    };

    $('#' + params.type + '-table .patent_visible').each(function(i,f) {
      var id = $(f).prop("id").split("__")[1];
      var value = $(f).prop("checked");
      params.patents[id] = value;
    });

    $scope.showLoading["patents"] = true;
    $scope.showSave["patents"] = false;

    companyService.updatePatents(params)
      .success(function(data, status) {
        $scope.profile.patent_data = data.data;
        $scope.hidePatents(data.type);
        $scope.showSave["patents"] = false;
        $scope.showPencil["patents"] = true;
        $scope.isEditing["patents"] = false;
        $scope.showLoading["patents"] = false;
      })
      .error(function(data, status) {
        $scope.showSave["patents"] = true;
        $scope.showLoading["patents"] = false;
      });
  };

  $scope.addIpo = function() {
    $scope.ipoHistory = {};
  };

  $scope.cancelEdit = function(id) {
    $scope.showSave[id] = false;
    $scope.submitted = false;
    $scope.showPencil[id] = true;
    $scope.isEditing[id] = false;

    if(id == 'overview' && !$scope.isEditing[id]) {
      $scope.logo_image = null;
      $scope.company = {};
    }
    else if(id == "ma") {
      $('.ma-copy').remove();
      $('.ma-table tbody tr:not(.edit-row)').show();
      $('#merge_direction').val(1);
    }
    else if(id == "competitors") {
      $('.competitor-list .pictures-250x100').show();
      $scope.competitorSelector.tokenInput('clear');
      $('.token-input-dropdown').hide();
    }
    else if(id == "team-full") {
      $('.teammember-item, .boardmember-item').show();
      $('.management-copy, .board-copy').remove();
      $scope.teammember = {};
      $scope.boardmember = {};
      $scope.teamSelector.tokenInput('clear');
      $('.token-input-dropdown').hide();
    }
    else if(id == "product") {
      $('.product-copy').remove();
      $('.products-table tbody tr:not(.edit-row)').show();
      $scope.product_image = null;
    }
    else if(id == "investment") {
      $('.investment-copy').remove();
      $('.investments-table tbody tr:not(.edit-row)').show();
      $scope.ipoHistory = angular.copy($scope.profile.ipo_history);
    }
    else if(id == "ipo_history") {
      $scope.ipoHistory = angular.copy($scope.profile.ipo_history);
    }
    else if(id == "relationship") {
      $('.relationship-copy').remove();
      $('.relationship-item').show();
      $scope.relationship = {};
      $scope.showUpdateEditor[id] = false;
      $('.token-input-dropdown').hide();
    }
    else if(id == "customer") {
      $scope.showUpdateEditor[id] = false;
      $('.customer-copy').remove();
      $('.customers-table tbody tr:not(.edit-row)').show();
    }
    else if(id == "note") {
      $('.note-item').show();
      $scope.note = {};
      $scope.showUpdateEditor[id] = false;
    }
    else if(id == "git") {
      $scope.seeking_funding = {};
      $('.seeking-funding').show();
    }
    else if(id == "tags") {
    }
    else if(id == "products_tech") {
      if(firstValidPdf($scope.profile.company_deck) != null) {
        $('.products-tech-header a.selectBox').show();
      }
      else {
        $('.products-tech-header a.selectBox').hide();
      }
    }
    else if(id == "campaign") {
      $scope.showUpdateEditor[id] = false;
    }
    else if(id == "looking-for") {
      $scope.company = {};
    }
    else if(id == "offer") {
      $scope.company = {};
    }
    else if(id == "traction") {
      $scope.traction = {};
    }
  };

  runAfterLoad();

}])
.directive('onFinishRender', function ($timeout) {
  return {
    restrict: 'A',
    link: function (scope, element, attr) {
      if (scope.$last === true) {
        $timeout(function () {
          scope.$emit('ngRepeatFinished');
        });
      }
    }
  }
});
//Add company

companyApp.controller('addCtrl', ["$scope", "$location", "$http", function($scope, $location, $http) {
  $scope.searchUrl = "/api/company/search.json";
  $scope.claimCompanyUrl = "/api/user_requests.json";
  $scope.keywords = $("#initialKeyword").val();
  $scope.claimOverlay = new OverlayModal("overlay-claim-content");

  $scope.claimCompany = function(event) {
    var target = event.target.className;
    event.preventDefault();
    event.stopPropagation();

    if(target.search("ctg-link") != -1 && target.search("claimed") == -1) {
      var elem = $(event.target).closest(".company-result");
      var companyId  = elem.attr("data-company-id");

      var params = {
        company_id : companyId,
        match : true
      };

      $('#company_' + companyId).html("Requesting...");

      $http({
        url: $scope.claimCompanyUrl,
        method: "POST",
        data: params,
        headers: {'Content-Type': 'application/json'}
      })
      .success(function (data, status, headers, config) {
        if(data.url == "") {
          $('#company_' + companyId).html("Claimed");
          $('#company_' + companyId).addClass("claimed");
          $scope.claimOverlay.toggle();
        }
        else {
          window.location.href = data.url;
        }
      })
      .error(function (data, status, headers, config) {
        $('#company_' + companyId).html("Claim this profile");
        alert(data.notice);
      });
    }
  };

  $scope.createCompany = function() {
    var params = {
      company: {
        name: $scope.keywords
      }
    };

    $http({
      url: "/api/company/create_company",
      method: "POST",
      data: params,
      headers: {'Content-Type': 'application/json'}
    })
    .success(function (data, status, headers, config) {
      if(status == 201) {
        window.location.href = data;
      }
    })
    .error(function (data, status, headers, config) {
      alert(data.name);
    });
  };

  $scope.searchInit = function() {
    if($scope.keywords != "") {
      $scope.search($scope.searchForm.$valid);
    }
  };

  function searchRequest(page) {
    $http({
      url: $scope.searchUrl,
      method: "POST",
      data: {
        'q' : $scope.keywords,
        'page' : page
      }
    })
    .success(function(data, status) {
      $scope.companies = data.companies;
      $scope.exact = data.exact;
      $scope.totalFound = data.total;

      if($scope.exact) {
        $scope.showPrimeResult = true;
        $scope.companies = [];
      }
      else if(data.total > 0) {
        $scope.exact = [];
        $scope.totalPages = Math.floor($scope.totalFound / 10) || 1;
        $scope.showSecondaryResults = true;
        $scope.showPagination = ($scope.totalPages == 1) ? false : true;
        $('.pagination-input').val(page || 1);
      }

      $scope.searchLoading = false;
      $scope.pageLoading = false;
    })
    .error(function(data, status) {
      $scope.companies = data.companies || [];
      $scope.exact = data.exact || [];
      $scope.searchLoading = false;
      $scope.hasErrors = true;
      $scope.errorMessage = "Sorry, an error has occured.";
      $scope.searchLoading = false;
      $scope.pageLoading = false;
    });
  };

  //called when user wants to do a search
  $scope.search = function(isValid) {
    $scope.submitted = true;

    if(isValid) {
      $scope.showPrimeResult = false;
      $scope.showSecondaryResults = false;
      $scope.searchLoading = true;
      $scope.hasErrors = false;

      searchRequest(0);
    }
  };

  $scope.updatePagination = function(position) {
    var page = $('#pagination-value-' + position).val();
    $('.pagination-input').val(page);
    $scope.pageLoading = true;
    searchRequest(page);
  };

  //for pagination
  $scope.previous = function(position) {
    var page = parseInt($('#pagination-value-' + position).val()) - 1;
    page = (page < 0 || isNaN(page)) ? 0 : page;
    $scope.pageLoading = true;
    searchRequest(page);
  };

  $scope.next = function(position) {
    var page = parseInt($('#pagination-value-' + position).val()) + 1;
    var max = $scope.totalPages;
    page = (page > max || isNaN(page)) ? max : page;
    $scope.pageLoading = true;
    searchRequest(page);
  };

  //called after ng-repeat is finished and truncates and adds ellipses on elements with lots of text.
  $scope.$on('ngRepeatFinished', function(ngRepeatFinishedEvent) {
    $('.company-description').dotdotdot({ellipsis: '...'});
  });
}])
.directive('onFinishRender', function ($timeout) {
  return {
    restrict: 'A',
    link: function (scope, element, attr) {
      if (scope.$last === true) {
        $timeout(function () {
          scope.$emit('ngRepeatFinished');
        });
      }
    }
  }
});

  companyApp.service("companyProfileInitData", function () {
  // profile data in json
  return {"message_url":null,"po_contact_bodies":{"Mike Mulica":"Dear USER_FIRST_NAME,\n\nI was browsing i3 and came across the profile of Actility.\n\nWould you be interested in connecting?\n\nBest,\n\nSENDER_FIRST_NAME SENDER_LAST_NAME\nSENDER_TITLE\nSENDER_COMPANY"},"row_counts":{"customers":5,"relationships":5,"investments":4,"products":0,"ma":1},"patent_data":{"total":1,"uspto_patents":[],"uspto_count":0,"uspto_url":null,"uspto_published_patents":[],"uspto_published_count":0,"uspto_published_url":null,"espacenet_patents":[{"abstract":"The present invention relates to a method of managing an object (OBJ) through a management gateway (ONG) communicating with a system architecture present on a telecommunications network offering functionalities for registering objects and for routing messages, the method comprising the registering (201) of the object with the system architecture by way of the management gateway, by using said registration functionality, and the control (203) of a parameter associated with the object by means of said management gateway, by using said message routing functionality. The present invention also relates to a management gateway (ONG) corresponding to the management method.","application_num":"EP20110735488","filed_on":"2010-06-16","id":16978,"inventors":null,"is_visible":true,"origin":"espacenet","patent_num":null,"published_app_num":null,"title":"METHOD OF MANAGING AN OBJECT BY MEANS OF A MANAGEMENT GATEWAY USING A TELECOMMUNICATIONS NETWORK ","url":"http://worldwide.espacenet.com/publicationDetails/biblio?FT=D&date=20130424&DB=EPODOC&locale=en_EP&CC=EP&NR=2583440A1&KC=A1&ND=4"}],"espacenet_count":1,"espacenet_patent_url":null},"alternate_names":"","recommendations":[{"id":4686,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/86/4686/standard_Blue_Pillar.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/86/4686/standard_Blue_Pillar.png","name":"Blue Pillar","url":"/company/blue-pillar","completeness_score":85,"primary_tag":"smart grid","jaccard":0.323529411764706},{"id":4556,"logo_image_url":"https://s3.amazonaws.com/prod.cleantech/14141.jpeg","logo_url":"https://s3.amazonaws.com/prod.cleantech/14141.jpeg","name":"GREENLET Technologies","url":"/company/greenlet-technologies","completeness_score":85,"primary_tag":"smart grid","jaccard":0.275862068965517},{"id":18767,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/67/18767/standard_autogrid_logo.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/67/18767/standard_autogrid_logo.png","name":"AutoGrid Systems","url":"/company/autogrid-systems","completeness_score":80,"primary_tag":"smart grid","jaccard":0.27027027027027},{"id":592,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/92/592/standard_c3.JPG","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/92/592/standard_c3.JPG","name":"C3","url":"/company/c3","completeness_score":85,"primary_tag":"smart grid","jaccard":0.25},{"id":379697,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/97/379697/standard_Vedero_Software.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/97/379697/standard_Vedero_Software.png","name":"Vedero Software","url":"/company/vedero-software","completeness_score":75,"primary_tag":"smart grid","jaccard":0.25},{"id":13209,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/9/13209/standard_Screen_Shot_2014-03-20_at_11.14.35_AM.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/9/13209/standard_Screen_Shot_2014-03-20_at_11.14.35_AM.png","name":"Calico Energy","url":"/company/calico-energy","completeness_score":80,"primary_tag":"smart grid","jaccard":0.25},{"id":4682,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/82/4682/standard_KITU-SYSTEMS-GLOBE_2x.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/82/4682/standard_KITU-SYSTEMS-GLOBE_2x.png","name":"Kitu Systems","url":"/company/kitu-systems","completeness_score":75,"primary_tag":"smart grid","jaccard":0.222222222222222},{"id":11374,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/74/11374/standard_geli_logo_blue-02.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/74/11374/standard_geli_logo_blue-02.png","name":"Geli","url":"/company/GELI","completeness_score":76,"primary_tag":"smart grid","jaccard":0.21875},{"id":4694,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/94/4694/standard_Open_Energi.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/94/4694/standard_Open_Energi.jpg","name":"Open Energi","url":"/company/responsiveload-ltd-rltech","completeness_score":73,"primary_tag":"smart grid","jaccard":0.214285714285714},{"id":1811,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/11/1811/standard_PassivSystems_logo.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/11/1811/standard_PassivSystems_logo.jpg","name":"PassivSystems","url":"/company/passivsystems","completeness_score":85,"primary_tag":"smart grid","jaccard":0.212121212121212},{"id":19304,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/4/19304/standard_nexgrid.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/4/19304/standard_nexgrid.png","name":"NexGrid","url":"/company/nexgrid","completeness_score":74,"primary_tag":"smart grid","jaccard":0.2},{"id":5968,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/68/5968/standard_Enbala_Power_Networks_Logo.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/68/5968/standard_Enbala_Power_Networks_Logo.png","name":"Enbala Power Networks","url":"/company/enbala-power-networks","completeness_score":82,"primary_tag":"smart grid","jaccard":0.2},{"id":13466,"logo_image_url":"https://s3.amazonaws.com/prod.cleantech/11151.jpeg","logo_url":"https://s3.amazonaws.com/prod.cleantech/11151.jpeg","name":"Vizimax","url":"/company/vizimax","completeness_score":69,"primary_tag":"smart grid","jaccard":0.186046511627907},{"id":391098,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/98/391098/standard_OpusOne_final_logo.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/98/391098/standard_OpusOne_final_logo.jpg","name":"Opus One Solutions","url":"/company/opus-one-solutions-energy-corporation","completeness_score":72,"primary_tag":"smart grid","jaccard":0.176470588235294},{"id":386785,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/85/386785/standard_lightbeeLOGO.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/85/386785/standard_lightbeeLOGO.jpg","name":"LightBee Inc","url":"/company/lightbee-sl","completeness_score":73,"primary_tag":"smart grid","jaccard":0.172413793103448},{"id":19235,"logo_image_url":"https://s3.amazonaws.com/prod.cleantech/16819.png","logo_url":"https://s3.amazonaws.com/prod.cleantech/16819.png","name":"Glen Canyon","url":"/company/glen-canyon","completeness_score":69,"primary_tag":"smart grid","jaccard":0.172413793103448}],"structure":{"parent_objs":[],"parent":"","child":"","subsidiary":""},"updated_by_info":{"first":"Updated by Louis Brasington at CTG on 05/03/2019"},"ipo_history":null,"edit_company_tags":[{"id":2208,"name":"2017 global cleantech 100"},{"id":1777,"name":"agriculture & food"},{"id":125,"name":"cleanweb"},{"id":127,"name":"cloud computing"},{"id":1492,"name":"congestion monitoring"},{"id":822,"name":"conventional fuels"},{"id":177,"name":"demand response"},{"id":1930,"name":"digital oilfield"},{"id":4,"name":"energy efficiency"},{"id":839,"name":"green it"},{"id":1523,"name":"han"},{"id":1835,"name":"internet of things"},{"id":1682,"name":"mining"},{"id":1932,"name":"networking & communication"},{"id":1327,"name":"oil & gas"},{"id":1955,"name":"power grid"},{"id":1954,"name":"smart buildings"},{"id":1876,"name":"software"},{"id":1562,"name":"traffic monitoring"},{"id":11,"name":"transportation"},{"id":1108,"name":"transportation software"}],"company_tags":[{"tag":"energy & power","slug":"energy-power","startup_count":10621},{"tag":"energy efficiency","slug":"energy-efficiency","startup_count":4074},{"tag":"transportation & logistics","slug":"transportation-logistics","startup_count":3449},{"tag":"transportation","slug":"transportation","startup_count":2987},{"tag":"agriculture & food","slug":"agriculture-food","startup_count":2348},{"tag":"software","slug":"software","startup_count":2259},{"tag":"smart buildings","slug":"smart-buildings","startup_count":1759},{"tag":"industrial & manufacturing","slug":"industrial-manufacturing","startup_count":1467},{"tag":"smart grid","slug":"smart-grid","startup_count":1124},{"tag":"conventional fuels","slug":"conventional-fuels","startup_count":1108},{"tag":"cleanweb","slug":"cleanweb","startup_count":913},{"tag":"power grid","slug":"power-grid","startup_count":881},{"tag":"internet of things","slug":"internet-of-things","startup_count":866},{"tag":"oil & gas","slug":"oil-gas","startup_count":864},{"tag":"transportation software","slug":"transportation-software","startup_count":725},{"tag":"digital oilfield","slug":"digital-oilfield","startup_count":192},{"tag":"green it","slug":"green-it","startup_count":165},{"tag":"networking & communication","slug":"networking-communication","startup_count":157},{"tag":"demand response","slug":"demand-response","startup_count":113},{"tag":"cloud computing","slug":"cloud-computing","startup_count":110},{"tag":"2018 global cleantech 100","slug":"2018-global-cleantech-100","startup_count":100},{"tag":"2019 global cleantech 100","slug":"2019-global-cleantech-100","startup_count":100},{"tag":"2017 global cleantech 100","slug":"2017-global-cleantech-100","startup_count":100},{"tag":"traffic monitoring","slug":"traffic-monitoring","startup_count":57},{"tag":"mining","slug":"mining","startup_count":51},{"tag":"han","slug":"han","startup_count":34},{"tag":"congestion monitoring","slug":"congestion-monitoring","startup_count":21}],"industry_group":"industrial & manufacturing","primary_tag":"smart grid","user_lists":[],"recent_user_lists":[],"acquired_message":"","seeking_funding":{"amount":null},"seeking_funding_message":"","company_editor_users":[],"notes":[],"notes_unstruct_q":[{"question_id":1,"question":"","answer":""}],"notes_struct_q":[{"question_id":2,"question":"Company information (company story, team)","answer":""},{"question_id":3,"question":"Products/Services/Technology (explain your typical deployment, how does it actually work? What are key numbers/metrics?)","answer":""},{"question_id":4,"question":"Target Customers/Value proposition (what's your value proposition, for whom?)","answer":""},{"question_id":5,"question":"Business model (how do you make money?)","answer":""},{"question_id":6,"question":"Traction and growth plans (success to date, plans and growth potential)","answer":""},{"question_id":7,"question":"Partnerships (who you're working with, how and why)","answer":""},{"question_id":8,"question":"Competition (other startups and incumbents)","answer":""},{"question_id":9,"question":"Market comments (insights, drivers and barriers, etc.)","answer":""},{"question_id":10,"question":"Other (miscellaneous)","answer":""}],"company":{"address":"4 rue Ampre BP 30255","assets":"","city":"Lannion","company_logo":{"url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/84/4684/Actility_logo_new.jpg","standard":{"url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/84/4684/standard_Actility_logo_new.jpg"}},"company_status_id":1,"country_id":14878,"development_stage_id":4,"hidden":false,"id":4684,"industry_group":"industrial & manufacturing","industry_type_id":1,"investment_focus":"","investor_status_id":3,"investor_type_id":0,"key_funds":"","logo_id":12537,"logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/84/4684/standard_Actility_logo_new.jpg","long_description":"","name":"Actility","num_employees":30,"offer":null,"overview":"Actility offers core infrastructure components and software enabling mass scale applications of the Internet of Things (Machine-to-Machine services enablement), with a specific focus on Smart Grid applications.","primary_tag":"smart grid","products_description":"Actility's main product is ThingPark, an open ecosystem offering standards-based core infrastructure components and software that enable mass scale deployment of Internet of Things (M2M) applications. Applied to Smart Buildings, ThingPark Data is able to collect and correlate data from temperature sensors, energy meters, presence sensors, or other building environment measurements and external environment conditions (sun exposure, sun position, temperature, wind, etc.). Actility consultants then use this information to perform various statistical studies in order to quantify and recommend optimizations which can save energy, and to promote responsible behavior.","profile_type_id":1,"revenue_range_id":2,"short_description":"Provider of products and services for machine-to-machine (M2M) and smartgrid applications","snapshot":null,"state":"","telephone":"","ticker_symbol":"","total_investment":113200000,"updated_at":"2019-02-11T07:20:05-08:00","updated_by_user_id":26452,"url":"/company/actility","website":"http://www.actility.com/","year_founded":2010,"zip":"22300","company_type":"Private","industry_type":"N/A","country":"France","investor_type_name":"Not an Investor","stage":"Wide Commercial Availability","primary_tag_id":9,"industry_group_id":2336},"follow":"follow","team":[{"date_departed":null,"date_joined":null,"id":20867868,"person_id":334614,"title":"President & CEO","person":{"email":null,"first_name":"Mike","id":334614,"last_name":"Mulica","linkedin_url":"http://fr.linkedin.com/in/mikemulica"}},{"date_departed":null,"date_joined":null,"id":20847189,"person_id":310299,"title":"CTO - Founder","person":{"email":null,"first_name":"Olivier","id":310299,"last_name":"Hersent","linkedin_url":"http://fr.linkedin.com/in/ohersent"}},{"date_departed":null,"date_joined":null,"id":20847190,"person_id":310300,"title":"VP, Sales - Co-founder","person":{"email":null,"first_name":"Boris","id":310300,"last_name":"Dezier","linkedin_url":"http://fr.linkedin.com/pub/boris-dezier/0/526/466"}},{"date_departed":null,"date_joined":null,"id":20847191,"person_id":310301,"title":"VP, Marketing & Business Development - Co-founder","person":{"email":null,"first_name":"Nicolas","id":310301,"last_name":"Jordan","linkedin_url":"http://fr.linkedin.com/in/njordan"}},{"date_departed":null,"date_joined":null,"id":20847192,"person_id":310302,"title":"VP, R&D - Co-founder","person":{"email":null,"first_name":"Bernard","id":310302,"last_name":"Jannes","linkedin_url":"http://fr.linkedin.com/pub/bernard-jannes/3/2b9/600"}}],"board_of_directors":[{"company_id":4684,"end_date":null,"id":4030,"investor_id":null,"person_id":310303,"role_id":1,"start_date":null,"person":{"first_name":"Daniel","id":310303,"last_name":"Valot","linkedin_url":null},"role":{"role_name":"Board Member"}},{"company_id":4684,"end_date":null,"id":4031,"investor_id":null,"person_id":310304,"role_id":1,"start_date":null,"person":{"first_name":"Juan","id":310304,"last_name":"Perez","linkedin_url":null},"role":{"role_name":"Board Member"}},{"company_id":4684,"end_date":null,"id":4032,"investor_id":null,"person_id":316771,"role_id":1,"start_date":null,"person":{"first_name":"Francois","id":316771,"last_name":"Duliege","linkedin_url":"http://fr.linkedin.com/pub/franois-duliege/0/54/369"},"role":{"role_name":"Board Member"}}],"past_management":[],"past_board_of_directors":[],"ma":[{"amount":null,"date_announced":"2017-05-16","date_closed":null,"deal_type_id":1,"id":9217840,"notes":"Actility has acquired Abeeway, a geo-location systems developer.","source":"http://www.iotevolutionworld.com/iot/articles/432091-actility-acquires-abeeway-geo-location-expertise.htm","deal_type":{"id":1,"name":"Acquisition"},"acquired":{"hidden":true,"id":404023,"name":"Abeeway","url":"/company/abeeway"},"acquired_logo_url":null,"merger_logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/84/4684/standard_Actility_logo_new.jpg","merger_company_url":"/company/actility","merger_company_name":"Actility","merger_company_hidden":false}],"primary_contact":{"id":20867868,"type":"CompanyManager","id_selected":"20867868__CompanyManager","name":"Mike Mulica","first_name":"Mike","last_name":"Mulica","title":"President & CEO","linkedin_url":"http://fr.linkedin.com/in/mikemulica","image_url":"/assets/newdesign/placeholders/user.png","email":null},"traction":{"customers":{"total":5,"confirmed":0},"partnerships":{"total":5,"confirmed":0},"financing":{"rounds":4,"investors":23},"capital":"$113.2M","num_employees":30,"revenue":"$0 - $500k","revenue_range_id":2},"products":[],"company_deck":[null,null,null,null],"competitors":[],"customers":[{"company1_id":4684,"company2_id":31324,"confirmation_email":null,"confirmed":false,"id":8724,"notes":"Laboratoire Paris Region Innovation has experimented Actility's energy analysis solutions.","relationship_date":"2011-11-14","relationship_type_id":1,"source":"http://www.actility.com/news/le-laboratoire-paris-region-innovation-experimente-smart-epar-la-plateforme-de-diagnostic-de","company1":{"hidden":false,"id":4684,"name":"Actility","url":"/company/actility"},"company2":{"hidden":false,"id":31324,"name":"Laboratoire Paris Rgion Innovation","url":"/company/laboratoire-paris-r-gion-innovation"},"relationship_type":{"id":1,"name":"Customer"},"logo_url1":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/84/4684/standard_Actility_logo_new.jpg","logo_url2":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/24/31324/standard_Paris_Region_Lab.JPG"}],"taxonomy_tags":[{"name":"energy efficiency","url":"/tags/energy-efficiency/830/activity","description":"Our Energy Efficiency sector includes technologies, services, and related business models designed to improve energy efficiency in buildings, data centers, built infrastructure, appliances, and consumer electronics","companies_count":4071,"id":830,"tag_id":4},{"name":"transportation","url":"/tags/transportation/1126/activity","description":"Our Transportation sector includes technologies, services, and related business models that enable the utilization of more sustainable transport options for people and goods","companies_count":2983,"id":1126,"tag_id":11},{"name":"agriculture & food","url":"/tags/agriculture-food/1533/activity","description":"Technologies and services that make the production of food more efficient and effective","companies_count":2345,"id":1533,"tag_id":1777},{"name":"software","url":"/tag/software","companies_count":2278},{"name":"smart buildings","url":"/tag/smart-buildings","companies_count":1784},{"name":"smart grid","url":"/tags/smart-grid/1010/activity","description":"Our Smart Grid sector includes technologies and services aimed at bringing a century-old electric grid into the information age; typically through the introduction of communications, monitoring, and control infrastructure to do things like increase system reliability and efficiency, enable active participation by utility customers, and integrate more diverse generation and energy storage assets with existing grid infrastructure","companies_count":1123,"id":1010,"tag_id":9},{"name":"conventional fuels","url":"/tags/conventional-fuels/1299/activity","description":"Our Conventional Fuels sector includes technologies, services, and related business models designed to improve the efficiency or generally lower the environmental impact of incumbent natural resource and energy industries including oil, natural gas, and coal","companies_count":1108,"id":1299,"tag_id":822},{"name":"cleanweb","url":"/tag/cleanweb","companies_count":919},{"name":"power grid","url":"/tag/power-grid","companies_count":887},{"name":"internet of things","url":"/tag/internet-of-things","companies_count":873},{"name":"oil & gas","url":"/tags/oil-gas/1608/activity","description":"Indicates technologies, services, and related business models addressing efficiencies and environmental impacts in the exploration and drilling for, as well as the production, refining, distribution, and ultimate use of oil, natural gas, and other hydrocarbons","companies_count":806,"id":1608,"tag_id":1327},{"name":"transportation software","url":"/tags/transportation-software/1165/activity","description":"Refers to software designed to improve efficiency of transport systems or otherwise proliferate clean transportation","companies_count":711,"id":1165,"tag_id":1108},{"name":"digital oilfield","url":"/tags/digital-oilfield/1634/activity","description":"Indicates technologies, services, and related business models focusing on both the tools and processes on data and information management in oil & gas upstream activities","companies_count":182,"id":1634,"tag_id":1930},{"name":"green it","url":"/tags/green-it/857/activity","description":"Products and solutions that enable energy efficient IT and data center systems. ","companies_count":162,"id":857,"tag_id":839},{"name":"2017 global cleantech 100","url":"/tag/2017-global-cleantech-100","companies_count":100},{"name":"demand response","url":"/tags/demand-response/1041/activity","description":"In the Smart Grid sector, Demand Response is a resource that allows end-use electric customers to reduce their electricity usage in a given time period, or shift that usage to another time period, in response to a price signal, a financial incentive, an environmental condition or a reliability signal","companies_count":97,"id":1041,"tag_id":177},{"name":"networking & communication","url":"/tags/networking-communication/1637/activity","description":"","companies_count":69,"id":1637,"tag_id":1932},{"name":"mining","url":"/tags/mining/1402/activity","companies_count":51},{"name":"traffic monitoring","url":"/tags/traffic-monitoring/1168/activity","description":"Refers to software for measuring and monitoring traffic","companies_count":47,"id":1168,"tag_id":1562},{"name":"han","url":"/tags/han/1011/activity","description":"Home Area Network (HAN) refers to a local network for communication between digital devices deployed in a home (or business).  Within the context of Smart Grid, it refers to data communications \"beyond the meter,\" whereby appliance-level data is collected for transmission","companies_count":34,"id":1011,"tag_id":1523},{"name":"cloud computing","url":"/tags/cloud-computing/863/activity","description":"Efficient products and solutions that deliver computing and storage capacity as a service. ","companies_count":32,"id":863,"tag_id":127},{"name":"congestion monitoring","url":"/tags/congestion-monitoring/1173/activity","description":"Software for measuring and monitoring congestion","companies_count":20,"id":1173,"tag_id":1492}],"investor_tags":[],"options_for_primary_contacts":[{"id":"20847192__CompanyManager","name":"Bernard Jannes","title":"VP, R&D - Co-founder","type":"CompanyManager"},{"id":"20847190__CompanyManager","name":"Boris Dezier","title":"VP, Sales - Co-founder","type":"CompanyManager"},{"id":"20867868__CompanyManager","name":"Mike Mulica","title":"President & CEO","type":"CompanyManager"},{"id":"20847191__CompanyManager","name":"Nicolas Jordan","title":"VP, Marketing & Business Development - Co-founder","type":"CompanyManager"},{"id":"20847189__CompanyManager","name":"Olivier Hersent","title":"CTO - Founder","type":"CompanyManager"}],"relationships":[{"company1_id":407164,"company2_id":4684,"confirmation_email":"","id":23177,"notes":"Partnership that will improve the location capabilities of IoT solutions by pinpointing the position of assets in both indoor and outdoor environments.","relationship_date":"2018-07-16","relationship_type_id":3,"size":null,"source":"https://www.geospatialworld.net/news/here-partners-with-lorawan-leader-actility/","company1":{"hidden":false,"id":407164,"name":"HERE Technologies","url":"/company/here"},"company2":{"hidden":false,"id":4684,"name":"Actility","url":"/company/actility"},"relationship_type":{"id":3,"name":"Technology Partner","reciprocal":{"name":"Technology Partner"}},"logo_url1":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/64/407164/standard_Here.png","logo_url2":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/84/4684/standard_Actility_logo_new.jpg"}],"investments":[{"amount":75000000,"company_id":4684,"id":39362,"investment_date":"2017-04-12","investment_type_id":14,"notes":"This over-subscribed funding round will aid the companys expansion, which will focus on enabling industrial IoT solutions in logistics and supply chain; smart buildings; and energy & utilities. This is a first close - a second closing later this month will see additional strategic investors.","source":"https://iotbusinessnews.com/2017/06/13/30876-actility-announces-new-investors-75-million-series-d-funding-round/","valuation":null,"get_related_inc_accel_cid":-1,"investors":[{"hidden":false,"id":380674,"name":"Creadev","url":"/investor/creadev"},{"hidden":true,"id":403322,"name":"Inmarsat","url":"/investor/inmarsat"},{"hidden":false,"id":16065,"name":"Idinvest Partners","url":"/investor/idinvest-partners"},{"hidden":false,"id":384650,"name":"BPIFrance","url":"/investor/bpifrance"},{"hidden":true,"id":396805,"name":"Ginko Ventures","url":"/investor/ginko-ventures"},{"hidden":true,"id":396644,"name":"KPN","url":"/investor/kpn"},{"hidden":true,"id":399095,"name":"Orange Digital Ventures","url":"/investor/orange-digital-ventures"},{"hidden":false,"id":19845,"name":"Swisscom","url":"/investor/swisscom"},{"hidden":false,"id":15796,"name":"Foxconn Technology Group","url":"/investor/foxconn-technology-group"},{"hidden":false,"id":15325,"name":"Cisco Systems","url":"/investor/cisco-systems"},{"hidden":false,"id":394738,"name":"BNP Paribas","url":"/investor/bnp-paribas"},{"hidden":false,"id":16990,"name":"Robert Bosch Venture Capital","url":"/investor/robert-bosch-venture-capital-gmbh-robert-bosch-gmbh"}],"investment_type":{"name":"Growth Equity"},"company":{"logo_url":null},"most_deal_logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/50/384650/standard_bpi.png"}],"investments_made":[],"investor_funds":[],"investor_investments_summary":null,"edit_options":{"investment_types":[{"id":8,"name":"Buyout / Late-Stage Private Equity"},{"id":22,"name":"Coin/Token Offering"},{"id":21,"name":"Follow-on Public Offering"},{"id":15,"name":"Grant"},{"id":14,"name":"Growth Equity"},{"id":19,"name":"Loan"},{"id":16,"name":"Loan Guarantee"},{"id":20,"name":"PIPE"},{"id":18,"name":"Project Finance"},{"id":1,"name":"Seed"},{"id":2,"name":"Series A"},{"id":3,"name":"Series B"},{"id":12,"name":"Structured Debt"}],"investor_types":[{"id":15,"name":"Accelerator / Incubator"},{"id":14,"name":"Angel Investor / Individual"},{"id":20,"name":"Angel Network"},{"id":6,"name":"Corporate Venture"},{"id":2,"name":"Corporation"},{"id":13,"name":"Crowdfunding"},{"id":11,"name":"Debt Funds"},{"id":18,"name":"Family Office / Foundation"},{"id":19,"name":"Investment Advisory Firm"},{"id":21,"name":"Investment Holding Company"},{"id":7,"name":"Investment/Merchant Banker"},{"id":5,"name":"Other"},{"id":23,"name":"Pension Fund"},{"id":3,"name":"Private Equity"},{"id":12,"name":"Public Sector"},{"id":17,"name":"Quasi-Governmental/Public-Private Partnership"},{"id":22,"name":"Specialty Finance"},{"id":16,"name":"University"},{"id":1,"name":"Venture Capital"}],"board_member_roles":[{"id":2,"name":"Board Advisor"},{"id":1,"name":"Board Member"},{"id":3,"name":"Board Observer"},{"id":7,"name":"Chairman of the Board"},{"id":6,"name":"Engineering Advisor"},{"id":5,"name":"Scientific Advisor"},{"id":4,"name":"Technical Advisor"}],"company_statuses":[{"id":6,"name":"Acquired"},{"id":8,"name":"Bankrupt"},{"id":9,"name":"Other"},{"id":7,"name":"Out of Business"},{"id":1,"name":"Private"},{"id":3,"name":"Public"}],"development_stages":[{"id":1,"name":"Concept"},{"id":2,"name":"Product Development"},{"id":3,"name":"Shipping Product/Pilot"},{"id":4,"name":"Wide Commercial Availability"}],"product_statuses":[{"id":1,"name":"Concept"},{"id":3,"name":"Pilot/Early Revenue"},{"id":2,"name":"Product Development"},{"id":4,"name":"Wide Commercial Availability"}],"states":[{"abbrev":"AL","country_id":15026,"id":1,"name":"Alabama"},{"abbrev":"AK","country_id":15026,"id":2,"name":"Alaska"},{"abbrev":"AB","country_id":14843,"id":52,"name":"Alberta"},{"abbrev":"AZ","country_id":15026,"id":3,"name":"Arizona"},{"abbrev":"AR","country_id":15026,"id":4,"name":"Arkansas"},{"abbrev":"BC","country_id":14843,"id":53,"name":"British Colombia"},{"abbrev":"CA","country_id":15026,"id":5,"name":"California"},{"abbrev":"CO","country_id":15026,"id":6,"name":"Colorado"},{"abbrev":"CT","country_id":15026,"id":7,"name":"Connecticut"},{"abbrev":"DE","country_id":15026,"id":8,"name":"Delaware"},{"abbrev":"FL","country_id":15026,"id":10,"name":"Florida"},{"abbrev":"GA","country_id":15026,"id":11,"name":"Georgia"},{"abbrev":"HI","country_id":15026,"id":12,"name":"Hawaii"},{"abbrev":"ID","country_id":15026,"id":13,"name":"Idaho"},{"abbrev":"IL","country_id":15026,"id":14,"name":"Illinois"},{"abbrev":"IN","country_id":15026,"id":15,"name":"Indiana"},{"abbrev":"IA","country_id":15026,"id":16,"name":"Iowa"},{"abbrev":"KS","country_id":15026,"id":17,"name":"Kansas"},{"abbrev":"KY","country_id":15026,"id":18,"name":"Kentucky"},{"abbrev":"LA","country_id":15026,"id":19,"name":"Louisiana"},{"abbrev":"ME","country_id":15026,"id":20,"name":"Maine"},{"abbrev":"MB","country_id":14843,"id":54,"name":"Manitoba"},{"abbrev":"MD","country_id":15026,"id":21,"name":"Maryland"},{"abbrev":"MA","country_id":15026,"id":22,"name":"Massachusetts"},{"abbrev":"MI","country_id":15026,"id":23,"name":"Michigan"},{"abbrev":"MN","country_id":15026,"id":24,"name":"Minnesota"},{"abbrev":"MS","country_id":15026,"id":25,"name":"Mississippi"},{"abbrev":"MO","country_id":15026,"id":26,"name":"Missouri"},{"abbrev":"MT","country_id":15026,"id":27,"name":"Montana"},{"abbrev":"NE","country_id":15026,"id":28,"name":"Nebraska"},{"abbrev":"NV","country_id":15026,"id":29,"name":"Nevada"},{"abbrev":"NB","country_id":14843,"id":55,"name":"New Brunswick"},{"abbrev":"NH","country_id":15026,"id":30,"name":"New Hampshire"},{"abbrev":"NJ","country_id":15026,"id":31,"name":"New Jersey"},{"abbrev":"NM","country_id":15026,"id":32,"name":"New Mexico"},{"abbrev":"NY","country_id":15026,"id":33,"name":"New York"},{"abbrev":"NL","country_id":14843,"id":56,"name":"Newfoundland and Labrador"},{"abbrev":"NC","country_id":15026,"id":34,"name":"North Carolina"},{"abbrev":"ND","country_id":15026,"id":35,"name":"North Dakota"},{"abbrev":"NT","country_id":14843,"id":62,"name":"Northwest Territories"},{"abbrev":"NS","country_id":14843,"id":57,"name":"Nova Scotia"},{"abbrev":"NU","country_id":14843,"id":63,"name":"Nunavut"},{"abbrev":"OH","country_id":15026,"id":36,"name":"Ohio"},{"abbrev":"OK","country_id":15026,"id":37,"name":"Oklahoma"},{"abbrev":"ON","country_id":14843,"id":58,"name":"Ontario"},{"abbrev":"OR","country_id":15026,"id":38,"name":"Oregon"},{"abbrev":"PA","country_id":15026,"id":39,"name":"Pennsylvania"},{"abbrev":"PE","country_id":14843,"id":59,"name":"Prince Edward Island"},{"abbrev":"QC","country_id":14843,"id":60,"name":"Quebec"},{"abbrev":"RI","country_id":15026,"id":40,"name":"Rhode Island"},{"abbrev":"SK","country_id":14843,"id":61,"name":"Saskatchewan"},{"abbrev":"SC","country_id":15026,"id":41,"name":"South Carolina"},{"abbrev":"SD","country_id":15026,"id":42,"name":"South Dakota"},{"abbrev":"TN","country_id":15026,"id":43,"name":"Tennessee"},{"abbrev":"TX","country_id":15026,"id":44,"name":"Texas"},{"abbrev":"UT","country_id":15026,"id":45,"name":"Utah"},{"abbrev":"VT","country_id":15026,"id":46,"name":"Vermont"},{"abbrev":"VA","country_id":15026,"id":47,"name":"Virginia"},{"abbrev":"WA","country_id":15026,"id":48,"name":"Washington"},{"abbrev":"DC","country_id":15026,"id":9,"name":"Washington DC"},{"abbrev":"WV","country_id":15026,"id":49,"name":"West Virginia"},{"abbrev":"WI","country_id":15026,"id":50,"name":"Wisconsin"},{"abbrev":"WY","country_id":15026,"id":51,"name":"Wyoming"},{"abbrev":"YT","country_id":14843,"id":64,"name":"Yukon"}],"countries":[{"abbrev":"AF","id":14806,"name":"Afghanistan","region_id":2},{"abbrev":"AL","id":14807,"name":"Albania","region_id":4},{"abbrev":"DZ","id":14808,"name":"Algeria","region_id":1},{"abbrev":"AS","id":14809,"name":"American Samoa","region_id":2},{"abbrev":"AD","id":14810,"name":"Andorra","region_id":4},{"abbrev":"AO","id":14811,"name":"Angola","region_id":0},{"abbrev":"AI","id":14812,"name":"Anguilla","region_id":3},{"abbrev":"AQ","id":14813,"name":"Antarctica","region_id":0},{"abbrev":"AG","id":14814,"name":"Antigua And Barbuda","region_id":3},{"abbrev":"AR","id":14815,"name":"Argentina","region_id":3},{"abbrev":"AM","id":14816,"name":"Armenia","region_id":4},{"abbrev":"AW","id":14817,"name":"Aruba","region_id":3},{"abbrev":"AU","id":14818,"name":"Australia","region_id":2},{"abbrev":"AT","id":14819,"name":"Austria","region_id":4},{"abbrev":"AZ","id":14820,"name":"Azerbaijan","region_id":5},{"abbrev":"BS","id":14821,"name":"Bahamas","region_id":3},{"abbrev":"BH","id":14822,"name":"Bahrain","region_id":5},{"abbrev":"BD","id":14823,"name":"Bangladesh","region_id":2},{"abbrev":"BB","id":14824,"name":"Barbados","region_id":3},{"abbrev":"BY","id":14825,"name":"Belarus","region_id":4},{"abbrev":"BE","id":14826,"name":"Belgium","region_id":4},{"abbrev":"BZ","id":14827,"name":"Belize","region_id":3},{"abbrev":"BJ","id":14828,"name":"Benin","region_id":1},{"abbrev":"BM","id":14829,"name":"Bermuda","region_id":3},{"abbrev":"BT","id":14830,"name":"Bhutan","region_id":2},{"abbrev":"BO","id":14831,"name":"Bolivia","region_id":3},{"abbrev":"BA","id":14832,"name":"Bosnia And Herzegovina","region_id":4},{"abbrev":"BW","id":14833,"name":"Botswana","region_id":1},{"abbrev":"BV","id":14834,"name":"Bouvet Island","region_id":0},{"abbrev":"BR","id":14835,"name":"Brazil","region_id":3},{"abbrev":"IO","id":14836,"name":"British Indian Ocean Territory","region_id":2},{"abbrev":"VG","id":15033,"name":"British Virgin Islands","region_id":3},{"abbrev":"BN","id":14837,"name":"Brunei","region_id":2},{"abbrev":"BG","id":14838,"name":"Bulgaria","region_id":4},{"abbrev":"BF","id":14839,"name":"Burkina Faso","region_id":1},{"abbrev":"BI","id":14840,"name":"Burundi","region_id":0},{"abbrev":"KH","id":14841,"name":"Cambodia","region_id":2},{"abbrev":"CM","id":14842,"name":"Cameroon","region_id":1},{"abbrev":"CA","id":14843,"name":"Canada","region_id":6},{"abbrev":"CV","id":14844,"name":"Cape Verde","region_id":0},{"abbrev":"KY","id":14845,"name":"Cayman Islands","region_id":3},{"abbrev":"CF","id":14846,"name":"Central African Republic","region_id":1},{"abbrev":"TD","id":14847,"name":"Chad","region_id":1},{"abbrev":"CL","id":14848,"name":"Chile","region_id":3},{"abbrev":"CN","id":14849,"name":"China","region_id":2},{"abbrev":"CX","id":14850,"name":"Christmas Island","region_id":2},{"abbrev":"CC","id":14851,"name":"Cocos (Keeling) Islands","region_id":2},{"abbrev":"CO","id":14852,"name":"Colombia","region_id":3},{"abbrev":"KM","id":14853,"name":"Comoros","region_id":0},{"abbrev":"CG","id":14854,"name":"Congo","region_id":1},{"abbrev":"CK","id":14855,"name":"Cook Islands","region_id":2},{"abbrev":"CR","id":14856,"name":"Costa Rica","region_id":3},{"abbrev":"CI","id":14857,"name":"Cote D'Ivorie (Ivory Coast)","region_id":1},{"abbrev":"HR","id":14858,"name":"Croatia (Hrvatska)","region_id":4},{"abbrev":"CU","id":14859,"name":"Cuba","region_id":3},{"abbrev":"CY","id":14860,"name":"Cyprus","region_id":4},{"abbrev":"CZ","id":14861,"name":"Czech Republic","region_id":4},{"abbrev":"DK","id":14862,"name":"Denmark","region_id":4},{"abbrev":"DJ","id":14863,"name":"Djibouti","region_id":0},{"abbrev":"DM","id":14864,"name":"Dominica","region_id":3},{"abbrev":"DO","id":14865,"name":"Dominican Republic","region_id":3},{"abbrev":"TP","id":14866,"name":"East Timor","region_id":2},{"abbrev":"EC","id":14867,"name":"Ecuador","region_id":3},{"abbrev":"EG","id":14868,"name":"Egypt","region_id":1},{"abbrev":"SV","id":14869,"name":"El Salvador","region_id":3},{"abbrev":"GQ","id":14870,"name":"Equatorial Guinea","region_id":0},{"abbrev":"ER","id":14871,"name":"Eritrea","region_id":0},{"abbrev":"EE","id":14872,"name":"Estonia","region_id":4},{"abbrev":"ET","id":14873,"name":"Ethiopia","region_id":1},{"abbrev":"FK","id":14874,"name":"Falkland Islands (Malvinas)","region_id":3},{"abbrev":"FO","id":14875,"name":"Faroe Islands","region_id":4},{"abbrev":"FM","id":14942,"name":"Federated States of Micronesia","region_id":2},{"abbrev":"FJ","id":14876,"name":"Fiji","region_id":2},{"abbrev":"FI","id":14877,"name":"Finland","region_id":4},{"abbrev":"FR","id":14878,"name":"France","region_id":4},{"abbrev":"FX","id":14879,"name":"France, Metropolitan","region_id":4},{"abbrev":"GF","id":14880,"name":"French Guinea","region_id":3},{"abbrev":"PF","id":14881,"name":"French Polynesia","region_id":2},{"abbrev":"TF","id":14882,"name":"French Southern Territories","region_id":2},{"abbrev":"GA","id":14883,"name":"Gabon","region_id":0},{"abbrev":"GM","id":14884,"name":"Gambia","region_id":1},{"abbrev":"GE","id":14885,"name":"Georgia","region_id":4},{"abbrev":"DE","id":14886,"name":"Germany","region_id":4},{"abbrev":"GH","id":14887,"name":"Ghana","region_id":1},{"abbrev":"GI","id":14888,"name":"Gibraltar","region_id":4},{"abbrev":"GR","id":14889,"name":"Greece","region_id":4},{"abbrev":"GL","id":14890,"name":"Greenland","region_id":4},{"abbrev":"GD","id":14891,"name":"Grenada","region_id":3},{"abbrev":"GP","id":14892,"name":"Guadeloupe","region_id":3},{"abbrev":"GU","id":14893,"name":"Guam","region_id":2},{"abbrev":"GT","id":14894,"name":"Guatemala","region_id":3},{"abbrev":"GN","id":14895,"name":"Guinea","region_id":0},{"abbrev":"GW","id":14896,"name":"Guinea-Bissau","region_id":0},{"abbrev":"GY","id":14897,"name":"Guyana","region_id":3},{"abbrev":"HT","id":14898,"name":"Haiti","region_id":3},{"abbrev":"HM","id":14899,"name":"Heard And McDonald Islands","region_id":2},{"abbrev":"HN","id":14900,"name":"Honduras","region_id":3},{"abbrev":"HK","id":14901,"name":"Hong Kong","region_id":2},{"abbrev":"HU","id":14902,"name":"Hungary","region_id":4},{"abbrev":"IS","id":14903,"name":"Iceland","region_id":4},{"abbrev":"IN","id":14904,"name":"India","region_id":2},{"abbrev":"ID","id":14905,"name":"Indonesia","region_id":2},{"abbrev":"IR","id":14906,"name":"Iran","region_id":5},{"abbrev":"IQ","id":14907,"name":"Iraq","region_id":5},{"abbrev":"IE","id":14908,"name":"Ireland","region_id":4},{"abbrev":"IL","id":14909,"name":"Israel","region_id":4},{"abbrev":"IT","id":14910,"name":"Italy","region_id":4},{"abbrev":"JM","id":14911,"name":"Jamaica","region_id":3},{"abbrev":"JP","id":14912,"name":"Japan","region_id":2},{"abbrev":"JO","id":14913,"name":"Jordan","region_id":5},{"abbrev":"KZ","id":14914,"name":"Kazakhstan","region_id":2},{"abbrev":"KE","id":14915,"name":"Kenya","region_id":1},{"abbrev":"KI","id":14916,"name":"Kiribati","region_id":2},{"abbrev":"KR","id":14999,"name":"Korea Republic","region_id":2},{"abbrev":"KW","id":14917,"name":"Kuwait","region_id":5},{"abbrev":"KG","id":14918,"name":"Kyrgyzstan","region_id":2},{"abbrev":"LA","id":14919,"name":"Laos","region_id":2},{"abbrev":"LV","id":14920,"name":"Latvia","region_id":4},{"abbrev":"LB","id":14921,"name":"Lebanon","region_id":5},{"abbrev":"LS","id":14922,"name":"Lesotho","region_id":1},{"abbrev":"LR","id":14923,"name":"Liberia","region_id":1},{"abbrev":"LY","id":14924,"name":"Libya","region_id":1},{"abbrev":"LI","id":14925,"name":"Liechtenstein","region_id":4},{"abbrev":"LT","id":14926,"name":"Lithuania","region_id":4},{"abbrev":"LU","id":14927,"name":"Luxembourg","region_id":4},{"abbrev":"MO","id":14928,"name":"Macau","region_id":2},{"abbrev":"MK","id":14929,"name":"Macedonia","region_id":4},{"abbrev":"MG","id":14930,"name":"Madagascar","region_id":0},{"abbrev":"MW","id":14931,"name":"Malawi","region_id":1},{"abbrev":"MY","id":14932,"name":"Malaysia","region_id":2},{"abbrev":"MV","id":14933,"name":"Maldives","region_id":2},{"abbrev":"ML","id":14934,"name":"Mali","region_id":1},{"abbrev":"MT","id":14935,"name":"Malta","region_id":4},{"abbrev":"MH","id":14936,"name":"Marshall Islands","region_id":2},{"abbrev":"MQ","id":14937,"name":"Martinique","region_id":3},{"abbrev":"MR","id":14938,"name":"Mauritania","region_id":0},{"abbrev":"MU","id":14939,"name":"Mauritius","region_id":0},{"abbrev":"YT","id":14940,"name":"Mayotte","region_id":0},{"abbrev":"MX","id":14941,"name":"Mexico","region_id":3},{"abbrev":"MD","id":14943,"name":"Moldova","region_id":4},{"abbrev":"MC","id":14944,"name":"Monaco","region_id":4},{"abbrev":"MN","id":14945,"name":"Mongolia","region_id":2},{"abbrev":"MS","id":14946,"name":"Montserrat","region_id":4},{"abbrev":"MA","id":14947,"name":"Morocco","region_id":1},{"abbrev":"MZ","id":14948,"name":"Mozambique","region_id":1},{"abbrev":"MM","id":14949,"name":"Myanmar (Burma)","region_id":2},{"abbrev":"NA","id":14950,"name":"Namibia","region_id":1},{"abbrev":"NR","id":14951,"name":"Nauru","region_id":2},{"abbrev":"NP","id":14952,"name":"Nepal","region_id":2},{"abbrev":"NL","id":14953,"name":"Netherlands","region_id":4},{"abbrev":"AN","id":14954,"name":"Netherlands Antilles","region_id":3},{"abbrev":"NC","id":14955,"name":"New Caledonia","region_id":2},{"abbrev":"NZ","id":14956,"name":"New Zealand","region_id":2},{"abbrev":"NI","id":14957,"name":"Nicaragua","region_id":3},{"abbrev":"NE","id":14958,"name":"Niger","region_id":1},{"abbrev":"NG","id":14959,"name":"Nigeria","region_id":1},{"abbrev":"NU","id":14960,"name":"Niue","region_id":2},{"abbrev":"NF","id":14961,"name":"Norfolk Island","region_id":2},{"abbrev":"KP","id":14962,"name":"North Korea","region_id":2},{"abbrev":"MP","id":14963,"name":"Northern Mariana Islands","region_id":2},{"abbrev":"NO","id":14964,"name":"Norway","region_id":4},{"abbrev":"OM","id":14965,"name":"Oman","region_id":5},{"abbrev":"PK","id":14966,"name":"Pakistan","region_id":2},{"abbrev":"PW","id":14967,"name":"Palau","region_id":2},{"abbrev":"PA","id":14968,"name":"Panama","region_id":3},{"abbrev":"PG","id":14969,"name":"Papua New Guinea","region_id":0},{"abbrev":"PY","id":14970,"name":"Paraguay","region_id":3},{"abbrev":"PE","id":14971,"name":"Peru","region_id":3},{"abbrev":"PH","id":14972,"name":"Philippines","region_id":2},{"abbrev":"PN","id":14973,"name":"Pitcairn","region_id":2},{"abbrev":"PL","id":14974,"name":"Poland","region_id":4},{"abbrev":"PT","id":14975,"name":"Portugal","region_id":4},{"abbrev":"PR","id":14976,"name":"Puerto Rico","region_id":6},{"abbrev":"QA","id":14977,"name":"Qatar","region_id":5},{"abbrev":"RE","id":14978,"name":"Reunion","region_id":0},{"abbrev":"RO","id":14979,"name":"Romania","region_id":4},{"abbrev":"RU","id":14980,"name":"Russia","region_id":4},{"abbrev":"RW","id":14981,"name":"Rwanda","region_id":1},{"abbrev":"SH","id":14982,"name":"Saint Helena","region_id":0},{"abbrev":"KN","id":14983,"name":"Saint Kitts And Nevis","region_id":3},{"abbrev":"LC","id":14984,"name":"Saint Lucia","region_id":3},{"abbrev":"PM","id":14985,"name":"Saint Pierre And Miquelon","region_id":6},{"abbrev":"SM","id":14986,"name":"San Marino","region_id":4},{"abbrev":"ST","id":14987,"name":"Sao Tome And Principe","region_id":0},{"abbrev":"SA","id":14988,"name":"Saudi Arabia","region_id":5},{"abbrev":"SN","id":14989,"name":"Senegal","region_id":1},{"abbrev":"RS","id":14990,"name":"Serbia","region_id":4},{"abbrev":"SC","id":14991,"name":"Seychelles","region_id":0},{"abbrev":"SL","id":14992,"name":"Sierra Leone","region_id":1},{"abbrev":"SG","id":14993,"name":"Singapore","region_id":2},{"abbrev":"SK","id":14994,"name":"Slovakia","region_id":4},{"abbrev":"SI","id":14995,"name":"Slovenia","region_id":4},{"abbrev":"SB","id":14996,"name":"Solomon Islands","region_id":2},{"abbrev":"SO","id":14997,"name":"Somalia","region_id":1},{"abbrev":"ZA","id":14998,"name":"South Africa","region_id":1},{"abbrev":"ES","id":15000,"name":"Spain","region_id":4},{"abbrev":"LK","id":15001,"name":"Sri Lanka","region_id":2},{"abbrev":"SD","id":15002,"name":"Sudan","region_id":1},{"abbrev":"SR","id":15003,"name":"Suriname","region_id":3},{"abbrev":"SJ","id":15004,"name":"Svalbard And Jan Mayen","region_id":4},{"abbrev":"SZ","id":15005,"name":"Swaziland","region_id":1},{"abbrev":"SE","id":15006,"name":"Sweden","region_id":4},{"abbrev":"CH","id":15007,"name":"Switzerland","region_id":4},{"abbrev":"SY","id":15008,"name":"Syria","region_id":5},{"abbrev":"TW","id":15009,"name":"Taiwan","region_id":2},{"abbrev":"TJ","id":15010,"name":"Tajikistan","region_id":2},{"abbrev":"TZ","id":15011,"name":"Tanzania","region_id":1},{"abbrev":"TH","id":15012,"name":"Thailand","region_id":2},{"abbrev":"TG","id":15013,"name":"Togo","region_id":0},{"abbrev":"TK","id":15014,"name":"Tokelau","region_id":2},{"abbrev":"TO","id":15015,"name":"Tonga","region_id":2},{"abbrev":"TT","id":15016,"name":"Trinidad And Tobago","region_id":3},{"abbrev":"TN","id":15017,"name":"Tunisia","region_id":1},{"abbrev":"TR","id":15018,"name":"Turkey","region_id":5},{"abbrev":"TM","id":15019,"name":"Turkmenistan","region_id":2},{"abbrev":"TC","id":15020,"name":"Turks And Caicos Islands","region_id":3},{"abbrev":"TV","id":15021,"name":"Tuvalu","region_id":2},{"abbrev":"UG","id":15022,"name":"Uganda","region_id":1},{"abbrev":"UA","id":15023,"name":"Ukraine","region_id":4},{"abbrev":"AE","id":15024,"name":"United Arab Emirates","region_id":5},{"abbrev":"UK","id":15025,"name":"United Kingdom","region_id":4},{"abbrev":"US","id":15026,"name":"United States","region_id":6},{"abbrev":"UY","id":15027,"name":"Uruguay","region_id":3},{"abbrev":"UZ","id":15028,"name":"Uzbekistan","region_id":2},{"abbrev":"VU","id":15029,"name":"Vanuatu","region_id":2},{"abbrev":"VA","id":15030,"name":"Vatican City (Holy See)","region_id":4},{"abbrev":"VE","id":15031,"name":"Venezuela","region_id":3},{"abbrev":"VN","id":15032,"name":"Vietnam","region_id":2},{"abbrev":"VI","id":15034,"name":"Virgin Islands (US)","region_id":6},{"abbrev":"WF","id":15035,"name":"Wallis And Futuna Islands","region_id":2},{"abbrev":"EH","id":15036,"name":"Western Sahara","region_id":0},{"abbrev":"WS","id":15037,"name":"Western Samoa","region_id":2},{"abbrev":"YE","id":15038,"name":"Yemen","region_id":5},{"abbrev":"ZM","id":15039,"name":"Zambia","region_id":1},{"abbrev":"ZW","id":15040,"name":"Zimbabwe","region_id":1}],"revenue_ranges":[{"id":1,"name":"Pre-revenue"},{"id":2,"name":"$0 - $500k"},{"id":3,"name":"$500k - $2m"},{"id":4,"name":"$2m - $5m"},{"id":5,"name":"$5m - $10m"},{"id":6,"name":"$10m - $25m"},{"id":7,"name":"$25m - $100m"},{"id":8,"name":"$100m or more"}],"industry_groups":[{"id":1777,"name":"agriculture & food","tag_id":1777},{"id":2334,"name":"energy & power","tag_id":2334},{"id":2336,"name":"industrial & manufacturing","tag_id":2336},{"id":2335,"name":"materials & chemicals","tag_id":2335},{"id":2337,"name":"resources & environment","tag_id":2337},{"id":2338,"name":"transportation & logistics","tag_id":2338}],"tags":[{"id":751,"name":"advanced materials","tag_id":751},{"id":1777,"name":"agriculture & food","tag_id":1777},{"id":752,"name":"air","tag_id":752},{"id":753,"name":"biofuels & biochemicals","tag_id":753},{"id":754,"name":"biomass generation","tag_id":754},{"id":822,"name":"conventional fuels","tag_id":822},{"id":4,"name":"energy efficiency","tag_id":4},{"id":5,"name":"energy storage","tag_id":5},{"id":1115,"name":"fuel cells & hydrogen","tag_id":1115},{"id":275,"name":"geothermal","tag_id":275},{"id":881,"name":"hydro & marine power","tag_id":881},{"id":423,"name":"nuclear","tag_id":423},{"id":1575,"name":"other cleantech","tag_id":1575},{"id":8,"name":"recycling & waste","tag_id":8},{"id":9,"name":"smart grid","tag_id":9},{"id":10,"name":"solar","tag_id":10},{"id":11,"name":"transportation","tag_id":11},{"id":12,"name":"water & wastewater","tag_id":12},{"id":13,"name":"wind","tag_id":13}],"ind_grp_tags":[{"id":1777,"name":"agriculture & food","tag_id":1777},{"id":2334,"name":"energy & power","tag_id":2334},{"id":2336,"name":"industrial & manufacturing","tag_id":2336},{"id":2335,"name":"materials & chemicals","tag_id":2335},{"id":2337,"name":"resources & environment","tag_id":2337},{"id":2338,"name":"transportation & logistics","tag_id":2338}],"revenues":[{"id":8,"name":"License of Usage"},{"id":1,"name":"Products - Retail"},{"id":2,"name":"Products - Wholesale"},{"id":7,"name":"Rental"},{"id":3,"name":"Service - Fixed Price"},{"id":4,"name":"Service - Per Unit"},{"id":5,"name":"Subscription"},{"id":6,"name":"Usage Fees"}],"relationship_types":[{"id":4,"name":"Channel Partner"},{"id":1,"name":"Customer"},{"id":7,"name":"Development Partner"},{"id":10,"name":"Incubation/Acceleration"},{"id":6,"name":"Joint Venture"},{"id":2,"name":"Licensee"},{"id":9,"name":"Licensor"},{"id":5,"name":"Project Development"},{"id":3,"name":"Technology Partner"},{"id":8,"name":"Vendor"}],"customer_relationship_types":[{"id":1,"name":"Customer"}],"partnership_relationship_types":[{"id":4,"name":"Channel Partner"},{"id":7,"name":"Development Partner"},{"id":10,"name":"Incubation/Acceleration"},{"id":6,"name":"Joint Venture"},{"id":2,"name":"Licensee"},{"id":9,"name":"Licensor"},{"id":5,"name":"Project Development"},{"id":3,"name":"Technology Partner"},{"id":8,"name":"Vendor"}],"ipo_statuses":[{"id":1,"name":"Filed"},{"id":2,"name":"Listed"},{"id":3,"name":"Speculated"},{"id":6,"name":"Withdrawn"}]}};
});
</script>

<input type="hidden" id="globalE" value=false />
<input type="hidden" id="user_name" value="" />
<input type="hidden" id="company_name" value="" />

<div class="ctg-overlay"></div>
<!-- End Overlay -->

  <div class="popup-window" id="share_list_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="shareProfileForm" novalidate>
  <div class="popup-window-content">
    <h3>Share this profile</h3>

    <div class="share-body">
      <div class="share-top">
       <input
        ng-model="shareProfile.emails"
        ng-class="{'has-error': shareProfileForm.emails.$invalid && submitted}"
        name="emails"
        type="text"
        class="modal-text"
        placeholder="To:"
        id="to_share_emails"
        required /><br/>
       <span class="font-size-11">You can enter multiple email addresses by separating them with a comma (,)</span>
       <br/>
       </div>

       <textarea
        ng-class="{'has-error': shareProfileForm.custom_text.$invalid && submitted}"
        name="custom_text"
        id="custom_text"
        class="width-100 height-215px modal-text">
Hi there,

I was browsing i3 and came across the profile of {{profile.company.name}}

To access it, click on the button below!

Best,

       </textarea>
    </div>

    <div class="error-message" style="font-size:14px;margin-bottom:10px;">{{messages['shareProfile']}}</div>
    <div class="popup-window-actions">
      <a href="#" ng-click="shareProfile(shareProfileForm.$valid)">
        <span ng-hide="isModalSaving['shareProfile']" >Share</span>
        <img ng-show="isModalSaving['shareProfile']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#share_button").on('click', function(event) {
      openPopup("#share_list_modal");
    });
  });
</script>

  
  <div class="popup-window" id="invite_colleagues_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="inviteColleagueForm" novalidate>
  <div class="popup-window-content">
    <h3>Invite a colleague</h3>

    <div class="share-body">
      <div class="share-top invite-colleague-body">
      <input
        ng-model="inviteColleague.first_name"
        ng-class="{'has-error': inviteColleagueForm.first_name.$invalid && submitted}"
        name="first_name"
        type="text"
        class="modal-text"
        placeholder="First name*"
        id="to_invite_first_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="inviteColleague.last_name"
        ng-class="{'has-error': inviteColleagueForm.last_name.$invalid && submitted}"
        name="last_name"
        type="text"
        class="modal-text"
        placeholder="Last name*"
        id="to_invite_last_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="inviteColleague.title"
        ng-class="{'has-error': inviteColleagueForm.title.$invalid && submitted}"
        name="title"
        type="text"
        class="modal-text"
        placeholder="Title*"
        id="to_invite_title"
        style="width:100%;"
        required /><br/>
      <input
        ng-model="inviteColleague.emails"
        ng-class="{'has-error': inviteColleagueForm.emails.$invalid && submitted}"
        name="emails"
        type="text"
        class="modal-text"
        placeholder="Email*"
        id="to_invite_emails"
        style="width:100%;"
        required /><br/>
       </div>
    </div>

    <div class="error-message" style="font-size:14px;margin-bottom:10px;">{{messages['inviteColleague']}}</div>
    <div class="popup-window-actions">
      <a href="#" ng-click="inviteColleagues(inviteColleagueForm.$valid, false)">
        <span ng-hide="isModalSaving['inviteColleague']" >Invite</span>
        <img ng-show="isModalSaving['inviteColleague']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#invite-colleague").on('click', function(e) {
      e.preventDefault();
      $('#invite_colleagues_modal').css('top', $(window).scrollTop() + 100);

      openPopup("#invite_colleagues_modal");
    });
  });
</script>


  <div class="popup-window" id="request-update-modal" style="position: fixed;">
  <a href="#" class="close-btn close">Close</a>
  <form name="requestUpdateForm" novalidate>
  <div class="popup-window-content">
    <h3>Request Update</h3>

    <div class="profile-owner-body">
       <textarea
        name="body"
        id="request_update_comment"
        placeholder="Please tell us which area(s) of the profile you think need attention."
        class="width-100 height-180px modal-text"></textarea>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="requestUpdate(true)">
        <span ng-hide="isModalSaving['requestUpdate']" >Send</span>
        <img ng-show="isModalSaving['requestUpdate']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(".request-update-button").on('click', function(event) {
      openPopup("#request-update-modal");
    });
  });
</script>

  <div class="popup-window" id="pipeline-content-modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="pipelineForm" novalidate>
  <div class="popup-window-content">
    <h3>Add to pipeline</h3>

    <div class="pipeline-body">
      <div class="pipeline-lists">
        <div class="list-wrapper"><label style="font-weight:600;">Recently updated lists:</label></div>
        <label style="font-weight:400;" ng-repeat="list in profile.recent_user_lists">
          <input
            type="checkbox"
            ng-checked="list.checked"
            value="{{list.id}}"
            name="user_lists[]"
            class="pipeline-input pi_{{list.id}}"
            />&nbsp; {{list.name}}
          <br/>
        </label>
        <hr>
        <div class="list-wrapper"><label style="font-weight:600;">Your lists:</label></div>
        <label style="font-weight:400;" ng-repeat="list in profile.user_lists">
          <input class="presented_list_ids" type="hidden" name="presented_list_ids[]" value="{{list.id}}">
          <input
            type="checkbox"
            ng-checked="list.checked"
            value="{{list.id}}"
            name="user_lists[]"
            class="pipeline-input pi_{{list.id}}"
            />&nbsp; {{list.name}}
          <br/>
        </label>
      </div>

      <div class="pipeline-add">
        <input type="text" id="input-user-list" placeholder="Enter a new list name..." class="modal-text" /><button class="ctg-button float-left" ng-click="addUserList()">{{messages['addPipelineButton']}}</button>
      </div>
    </div>
    <div class="clear"></div>

    <div class="popup-window-actions">
      <a href="#" ng-click="updatePipeline(pipelineForm.$valid)">
        <span ng-hide="isModalSaving['addPipeline']" >Save</span>
        <img ng-show="isModalSaving['addPipeline']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>

      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">

  $(function() {
    $('.pipeline-input').on('click',function() {
      var c = this.className.replace('pipeline-input ','');
      $('.'+c).prop("checked", this.checked);
    });

    $(".pipeline-content-button").on('click', function(event) {
      openPopup("#pipeline-content-modal");
    });
  });
</script>

  <div class="popup-window" id="add_company_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="addCompanyForm" novalidate>
  <div class="popup-window-content">
    <h1>Add Company</h1>
    <div class="">
      <div>
        <input
          ng-model="addCompany.name"
          name="addCompanyName"
          type="text"
          ng-class="{'has-error': addCompanyForm.addCompanyName.$invalid && addCompanySubmitted}"
          class="modal-text margin-bottom-15px width-100p"
          placeholder="Company Name"
          id="addCompanyName" 
          required />
        </div>

        <label>Country</label>
        <select
           ng-model="addCompany.country_id"
           class="margin-bottom-15px"
           ng-options="obj.id as obj.name for obj in profile.edit_options.countries"
           name="addCountryId"
           id="addCountryId">
        </select>
    </div>
    <div class="popup-window-actions">
      <a href="#" ng-click="companyAdd(addCompanyForm.$valid)">
        <span ng-hide="isModalSaving['addCompany']" >Create</span>
        <img ng-show="isModalSaving['addCompany']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(document).on("click", ".add-company-button",function(event) {
      openPopup("#add_company_modal");
      $('#add_company_modal').css("left", "50%");
      $('#add_company_modal').css("top", $(window).scrollTop() + 100);      
    });
  });
</script>
  <div class="popup-window" id="add_investor_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="addInvestorForm" novalidate>
  <div class="popup-window-content">
    <h3>Add Investor</h3>
    <div>
      <div>
        <input
          ng-model="addInvestor.name"
          name="addInvestorName"
          type="text"
          ng-class="{'has-error': addInvestorForm.addInvestorName.$invalid && addInvestorSubmitted}"
          class="modal-text margin-bottom-15px width-100p"
          placeholder="Investor Name"
          id="addInvestorName"
          required />
        </div>

        <label>Investor Type</label>
        <select
           ng-model="addInvestor.investor_type_id"
           class="margin-bottom-15px"
           ng-options="obj.id as obj.name for obj in profile.edit_options.investor_types"
           name="addInvestorTypeId"
           id="addInvestorTypeId">
        </select><br/>

        <label>Country</label>
        <select
           ng-model="addInvestor.country_id"
           class="margin-bottom-15px"
           ng-options="obj.id as obj.name for obj in profile.edit_options.countries"
           name="addInvestorCountryId"
           id="addInvestorCountryId">
        </select><br/>
        <div class="margin-bottom-15px">
          <span style="font-size:11px;">Investors must be an venture capital firm, accredited individual, or company</span>
        </div>
    </div>
    <div class="popup-window-actions">
      <a href="#" ng-click="investorAdd(addInvestorForm.$valid)">
        <span ng-hide="isModalSaving['addInvestor']" >Create</span>
        <img ng-show="isModalSaving['addInvestor']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(document).on('click', ".add-investor-button", function(event) {
      openPopup("#add_investor_modal");
      $('#add_investor_modal').css("left", "50%");
      $('#add_investor_modal').css("top", $(window).scrollTop() + 100);
    });
  });
</script>

  <div class="popup-window" id="investment_no_edit_modal">
  <div class="popup-window-content">
  	<h3>Investment Data Information</h3>
  	<div>
  		<p>Investment data is not editable by profile owners.<br><br>Please contact <a href="mailto:research@cleantech.com?Subject=Investment%20Data%20Inquiry" target="_top">research@cleantech.com</a> to make changes.</p>
	    <div class="popup-window-actions" style="position:relative; left:30%;">
    	  <a href="#" class="close">Close</a>
	    </div>
  	</div>
  </div>
</div>

<script type="text/javascript">
  $(function() {
    $(document).on('click', "#investment-no-edit-button", function(event) {
      openPopup("#investment_no_edit_modal");
      $('#investment_no_edit_modal').css("left", "50%");
      $('#investment_no_edit_modal').css("top", $(window).scrollTop() + 100);
    });
  });
</script>

  <div class="popup-window" id="alternate_name_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="alternateNameForm" novalidate>
  <div class="popup-window-content">
    <h3>Alternate names</h3>
    <h3 class="margin-bottom-20px">Make sure potential partners can find you - input common misspellings, abbreviations, past names, etc.</h3>

    <div class="alternate-name-body">
      <textarea
        name="alternate_names"
        type="text"
        class="modal-text margin-bottom-15px"
        id="alternate_names"
        ng-model="profile.alternate_names"
        placeholder="Please add alternate names on their own line.">
      </textarea>
      <span style="font-size: 14px;">Each alternate name must be on its own line</span>
      <div class="popup-window-actions right-align-send-button">
        <a href="#" ng-click="alternateName(alternateNameForm.$valid)">
          <span ng-hide="isModalSaving['alternateName']" >Save</span>
          <img ng-show="isModalSaving['alternateName']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
        </a>
      </div>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(".alternate-name-button").on('click', function(event) {
      openPopup("#alternate_name_modal");
    });
  });
</script>

  <div class="popup-window" id="feedback-modal" style="position: fixed;">
  <a href="#" class="close-btn close">Close</a>
  <form name="sendFeedbackForm" novalidate>
  <div class="popup-window-content">
    <h3>Feedback</h3>

    <div>
       <textarea
        style="padding-left: 10px;width:97%;"
        name="body"
        id="feedback_comment"
        placeholder=""
        class="width-100 height-180px modal-text"></textarea>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="sendFeedbackPatent(true)">
        <span ng-hide="isModalSaving['sendFeedback']" >Send</span>
        <img ng-show="isModalSaving['sendFeedback']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(".feedback-button").on('click', function(event) {
      openPopup("#feedback-modal");
    });
  });
</script>

  <div class="popup-window" id="add_patent_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="addPatentForm" novalidate>
  <div class="popup-window-content">
    <h3>Submit a {{patentType == 'uspto' ? "USPTO" : (patentType == 'uspto-published' ? "USPTO Application" : "ESPACENET")}} patent</h3>
    <span style="font-size: 12px;">We currently do not support patent pending.  After submitting, it may take 24 hours before added patents appear.</span>
    <br/>
    <div class="share-body">
      <div class="share-top add-patent-body"><br/>
        <div ng-show="patentType == 'uspto'">Patent no.
          <input
            type="text"
            placeholder="ex: 9,124,968"
            ng-class="{'has-error': addPatentForm.patent_num.$invalid && submitted}"
            ng-model="patent.patent_num" /><br/><br/>
        </div>
        <div ng-show="patentType == 'uspto-published'">Published Application no.
          <input
            type="text"
            placeholder="ex: 20150061638"
            ng-class="{'has-error': addPatentForm.published_app_num.$invalid && submitted}"
            ng-model="patent.published_app_num" /><br/><br/>
        </div>
        <div ng-show="patentType != 'espacenet'">
          OR <br/><br/>
          Application no.<input
            type="text"
            placeholder="ex: 12/345678"
            ng-class="{'has-error': addPatentForm.application_num.$invalid && submitted}"
            ng-model="patent.application_num" /><br/><br/>
        </div>
        <!--div ng-show="patentType == 'espacenet'">Application no.
          <input
            type="text"
            ng-class="{'has-error': addPatentForm.application_num.$invalid && submitted}"
            ng-model="patent.application_num"
            ng-required="patentType == 'espacenet'" />
        </div-->
      </div>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="addPatents(addPatentForm.$valid)">
        <span ng-hide="isModalSaving['addPatents']" >Submit</span>
        <img ng-show="isModalSaving['addPatents']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#add-patent").on('click', function(e) {
      e.preventDefault();
      $('#add_patent_modal').css('top', $(window).scrollTop() + 100);

      openPopup("#add_patent_modal");
    });
  });
</script>

  <div class="popup-window" id="patent-submitted">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <h3>Patent request submitted!</h3>

    <div class="share-body">
      <p>Information about your patent is being retrieved from the USPTO database.  After submitting, it may take 24 hours before added patents appear.</p>
      <p>Please click the Save button after closing this popup.</p>
    </div>

    <div class="popup-window-actions">
      <a href="#" class="close">Close</a>
    </div>
  </div>
</div>

  <div class="popup-window" id="confirm_team_delete_modal">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <div class="share-body">
      <h1>Your updates include deleting contacts.  Are you sure you want to continue?</h1>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="confirmedDelete()">
        <span>Delete</span>
      </a>
      <a href="#" class="close">Cancel</a>
    </div>
  </div>
</div>


  <div class="popup-window" id="signup-modal">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <span>Hey there!</span>
    <br/><br/>
    <span>We hope you've enjoyed an initial browse of i3. Select an option below to start enjoying i3's full capabilities!</span><br/><br/>

      <div class="one_third_column" style="width:45%;">
    <img alt="Startupicon_69x62_retina" class="reg_tile_logo" height="55" src="/assets/newdesign/StartUpIcon_69x62_Retina-661b7e515bd72fe82be4166bd560e88b.png" />
    <h3 class="reg_tile_h3">Startups </h3>
    <p class="reg_tile_blurb_p" style="width: 80%;margin-left: auto; margin-right: auto;">
      Use i3 to gain visibility with corporations and investors looking to invest and partner with external technology companies.
    </p>
  </div>

<!--
  <div class="one_third_column">
  </div>
-->

<div class="one_third_column" style="width:45%;">
    <img alt="Dataicon_69x62_retina" class="reg_tile_logo" height="55" src="/assets/newdesign/DataIcon_69x62_Retina-58c86791ad405c191de6da34ce9fa53a.png" />
    <h3 class="reg_tile_h3">Trialists</h3>
    <p class="reg_tile_blurb_p" style="width: 80%;margin-left: auto; margin-right: auto;">Use i3 to access market intelligence on companies, investors, market activity and innovation trends.</p>
  </div>

  <div class="clear"></div>

  
  <div class="one_third_column hit_bottom" style="width:45%;padding:0px 3px;">
      <button class="orange-btn width250 font_size_18" id="claim_your_profile_button" style="margin-left: 20px;">Create your free profile</button>
  </div>
  
<!--
  <div class="one_third_column hit_bottom">
-----removed free version button-----------------------
  </div>
-->


<div class="one_third_column hit_bottom" style="width:45%;">
    <button class="orange-btn width250 font_size_18" id="request_trial_button" style="margin-left: 50px;">Register for trial access</button>
  </div>

  <div class="clear"></div>

    <div id="claim_your_profile_slider" class="hidden dashboard-input-form">
      <div class="form-introduction">      
        <p><strong>Are you involved with a startup or SME looking for strategic partners, investors, or customers? Create your free profile!</strong></p>
      </div>    
     
      <form accept-charset="UTF-8" action="/account" id="startup-form" method="post" onsubmit="return validateOpenForm(&#x27;startup-form&#x27;)"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="WFO9QNnU4FX6gG4uKFgXtGAuJEquNAWR+o+VFw9h/SY=" /></div>
        <input id="action_type" name="action_type" type="hidden" value="registered" />
        <input id="front_page_type" name="front_page_type" type="hidden" value="true" />
        
        <p><strong>First name <span class="orange-text">*</span></strong> <input id="user_first_name" name="user[first_name]" required="required" size="30" type="text" /></p>
        <p><strong>Last name  <span class="orange-text">*</span></strong> <input id="user_last_name" name="user[last_name]" required="required" size="30" type="text" /></p>
        <p><strong>Title      <span class="orange-text">*</span></strong> <input id="user_title" name="user[title]" required="required" size="30" type="text" /></p>
        <p><strong>Company    <span class="orange-text">*</span></strong> <input id="user_company" name="user[company]" required="required" size="30" type="text" /></p>
        <p><strong>Email      <span class="orange-text">*</span></strong> <input id="user_email" name="user[email]" required="required" size="30" type="email" /></p>
        <p><strong>Phone                                        </strong> <input id="user_phone" name="user[phone]" size="30" type="tel" /></p>
        <p><strong>Password   <span class="orange-text">*</span></strong> <input id="startup-form-password" name="user[password]" requred="true" size="30" type="password" /></p>
        <p><strong>Confirm Password<span class="orange-text">*</span></strong> <input id="startup-form-password-confirm" name="user[password_confirm]" required="required" size="30" type="password" /></p>
    
        <p class="align-right">
          <a id="claim_your_profile_cancel" class="little-white-btn">Cancel</a>
          <input class="little-orange-btn" name="commit" type="submit" value="Submit" />
        </p>
</form>    </div>
  
<!--
  <div id="access_free_version_slider" class="hidden dashboard-input-form">
  

  <div class="form-introduction">  
    <p><strong>Gain access to i3's powerful network for free:</strong></p>
  </div>
    <div id="corporate-form-message"></div>
  </div>

-->

  <div id="request_trial_slider" class="hidden dashboard-input-form">

  <div class="form-introduction">  
    <p><strong>Register for trial access and explore the full power of i3:</strong></p>
  </div>

    <form accept-charset="UTF-8" action="/account/request_trial" id="trial-form" method="post" onsubmit="return asyncValidateForm(&#x27;trial-form&#x27;)"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="WFO9QNnU4FX6gG4uKFgXtGAuJEquNAWR+o+VFw9h/SY=" /></div>
      <p><strong>First name <span class="orange-text">*</span></strong> <input id="first_name" name="first_name" required="required" type="text" /></p>
      <p><strong>Last name  <span class="orange-text">*</span></strong> <input id="last_name" name="last_name" required="required" type="text" /></p>
      <p><strong>Title      <span class="orange-text">*</span></strong> <input id="title" name="title" required="required" type="text" /></p>
      <p><strong>Company    <span class="orange-text">*</span></strong> <input id="company" name="company" required="required" type="text" /></p>
      <p><strong>Email      <span class="orange-text">*</span></strong> <input id="email" name="email" required="required" type="email" /></p>
      <p><strong>Phone                                        </strong> <input id="phone" name="phone" type="tel" /></p>
    
      <p class="align-right">
        <a id="request_trial_cancel" class="little-white-btn">Cancel</a>
        <input class="little-orange-btn" name="commit" type="submit" value="Request a trial" />
      </p>
		<input type="hidden" name="tn" value="3ccnt">
</form>
    <div id="trial-form-message"></div>
  </div>


  </div>
</div>

<script type="text/javascript">
  $(function() {
      $("#claim_your_profile_button").click(function() {
        $("#access_free_version_slider").slideUp();
        $("#request_trial_slider").slideUp();
        $("#claim_your_profile_slider").slideToggle();
      });

    $("#access_free_version_button").click(function() {
      $("#claim_your_profile_slider").slideUp();
      $("#request_trial_slider").slideUp();
      $("#access_free_version_slider").slideToggle();
    });

    $("#request_trial_button").click(function() {
      $("#claim_your_profile_slider").slideUp();
      $("#access_free_version_slider").slideUp();
      $("#request_trial_slider").slideToggle();
    });

    $("#claim_your_profile_cancel").click(function() {
      $("#claim_your_profile_slider").slideUp();
    });

    $("#access_free_version_cancel").click(function() {
      $("#access_free_version_slider").slideUp();
    });

    $("#request_trial_cancel").click(function() {
      $("#request_trial_slider").slideUp();
    });
  });

  function validateOpenForm(type) {
    var password = document.getElementById(type + "-password");
    var confirm_password = document.getElementById(type + "-password-confirm");

    if(password.value != confirm_password.value) {
      alert("Passwords don't match");
      password.style.borderColor = "#ff5816";
      confirm_password.style.borderColor = "#ff5816";
      return false;
    }
    else {
      password.style.borderColor = "#DDD";
      confirm_password.style.borderColor = "#DDD";
      document.getElementById(type).submit();
      return true;
    }
  }

  function asyncValidateForm(type) {
    var url = $('#' + type).prop('action');

    $.ajax({
      url: url,
      type: "POST",
      data: $('#' + type).serialize(),
      dataType: "JSON",
      success: function(data) {
        $('.close-btn').trigger('click');
        $('#request_received').css('top', $(window).scrollTop() + 100);
        openPopup('#request_received');
      },
      error: function(data) {
        $('#' + type + '-message').html("<p>There was an error processing your request.</p>");
      }
    });

    return false;
  }
</script>

<div class="popup-window" id="request_received">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <h1>Request Received!</h1>

    <div class="share-body">
      <p>We have received your request and will be in touch with you on the next steps.</p>
      <p>Please allow us 24 hours to review your request and confirm access to our trusted network.</p>
      <p>In the meantime, feel free to keep searching and check our company profile pages and sector pages for the latest news and trends.</p>
    </div>

    <div class="popup-window-actions">
      <a href="/">Go to front page</a>
      <a href="#" class="close">Continue browsing</a>
    </div>
  </div>
</div>


<script type="text/javascript">
  $(function() {
    $(".signup-button").on('click', function(event) {
      $('#signup-modal').css('top', $(window).scrollTop() + 50);
      openPopup("#signup-modal");
    });
  });
</script>

  <div class="popup-window" id="claim_open_profile_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="openProfileForm" novalidate>
  <div class="popup-window-content">
    <h3>Claim your profile</h3>

    <div class="share-body">
      <div class="share-top claim-open-profile-body">
      <input
        ng-model="openProfileUser.first_name"
        ng-class="{'has-error': openProfileForm.first_name.$invalid && submitted}"
        name="first_name"
        type="text"
        class="modal-text"
        placeholder="First name*"
        id="claim_first_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="openProfileUser.last_name"
        ng-class="{'has-error': openProfileForm.last_name.$invalid && submitted}"
        name="last_name"
        type="text"
        class="modal-text"
        placeholder="Last name*"
        id="claim_last_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="openProfileUser.title"
        ng-class="{'has-error': openProfileForm.title.$invalid && submitted}"
        name="title"
        type="text"
        class="modal-text"
        placeholder="Title*"
        id="claim_title"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="openProfileUser.company"
        ng-class="{'has-error': openProfileForm.company.$invalid && submitted}"
        name="company"
        type="text"
        class="modal-text"
        placeholder="Company*"
        id="claim_company"
        style="width:100%;"
        required /><br/>
      <input
        ng-model="openProfileUser.email"
        ng-class="{'has-error': openProfileForm.email.$invalid && submitted}"
        name="email"
        type="text"
        class="modal-text"
        placeholder="Email*"
        id="claim_email"
        style="width:100%;"
        required /><br/>
       </div>
    </div>

    <div id="open-profile-error-message" class="error-message" style="font-size:14px;margin-bottom:10px;">{{messages.openProfileUser}}</div>
    <div class="popup-window-actions">
      <a href="#" ng-click="claimOpenProfile(openProfileForm.$valid)">
        <span ng-hide="isModalSaving['openProfileUser']" >Claim</span>
        <img ng-show="isModalSaving['openProfileUser']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#claim-open-profile").on('click', function(e) {
      e.preventDefault();
      $('#claim_open_profile_modal').css('top', $(window).scrollTop() + 100);
      var $scope = angular.element('#claim_open_profile_modal').scope();
      $scope.$apply(function() {
        $scope.submitted = false;
        $scope.messages.openProfileUser = "";
        $scope.openProfileUser = {};
      });

      openPopup("#claim_open_profile_modal");
    });
  });
</script>

  <div class="demo-div">
  <span class="demo-span">You are viewing a limited version of this profile.  To access i3's full capabilities.</span> <a href="#" class="signup-button">Sign up</a>
</div>

<div class="content-row">
  <div class="app-tile two-third-section float-left" data-tile-id="overview">
  <form name="overviewForm" novalidate >
    <div class="tile-header">
      <span>{{profile.company.name}}</span>
      <div class="tile-header-icons">
        <div ng-show="showLoading['overview'] || globalLoading" class="tile-icons icon-loading"><img alt="45" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" /></div>
        <div ng-show="showPencil['overview']" ng-click="edit('overview')" class="tile-icons icon-pencil"><img alt="Editicon_blue_22x22px_2x" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></div>
        <div ng-show="showSave['overview']" class="tile-icons icon-remove"><div class="save-tile" ng-click="saveOverview(overviewForm.$valid)">Save</div><img alt="Cancelicon_blue_22x22px_2x" ng-click="cancelEdit(&#x27;overview&#x27;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-94947632d9a720a2747ef0a564672072.png" /></div>
      </div>
      <div class="clear"></div>
    </div>
    <div class="tile-content overview-content">
      <div class="cp-profile-left">
        <div class="company-logo" style="width:200px;">
          <div ng-hide="isEditing['overview']">
            <div class="thumb-200x130 thumb">
              <img ng-src="{{profile.company.logo_url || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" />
            </div>
          </div>

          <div ng-show="isEditing['overview']">
            <div class="thumb-200x130 thumb">
              <img id="logo_image_preview" ng-src="{{company.logo_url || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" alt="Product" />
            </div>
          </div>
        </div>
        <div class="clear"></div>

        <div ng-hide="isEditing['overview']">
            
            
            
            
            
            <div class="nav-single-button">
  <a href="#" id="share_button">Share profile</a>
</div>

        </div>
        <div ng-show="isEditing['overview']">
          <div class="editable">Company logo <span style="font-weight:normal;">(jpg or png)</span></div>
          <input
            onchange="angular.element(this).scope().logoChanged(this)"
            file-input="files"
            class="company_logo"
            name="logo_image"
            type="file"
            multiple
            accept="image/*" />
          <!--button class="upload-btn" ng-click="uploadLogo()"></button-->
        </div>

        <div ng-show="isEditing['overview']" class="parent-edit">
          <div class="editable">Parent company </div>
          <input type="text" name="add_parent" id="add_parent_input" />
        </div>

        <div ng-show="isEditing['overview']" class="alt-name-edit">
          <a type="button" class="alternate-name-button weight600" href="#">Edit alternate names</a>
        </div>
      </div>

      <div class="cp-profile-right">
        <div class="cp-profile-details">
            <div class="short-description">
  <p class="cp-description">
    <div ng-hide="isEditing['overview']">
      <span class="cp-description-span"><span class="cp-name">Elevator pitch </span><h1 id="elevator-pitch">{{profile.company.short_description}}</h1></span>
    </div>
    <div ng-show="isEditing['overview']">
      <p class="cp-description-span"><span class="cp-name float-left">Elevator pitch</span>
        <span class="float-right weight600" ng-class="{'error-message': company.short_description.length > 250}">{{250 - company.short_description.length}}/250
        <span class="weight-normal">characters left</span>
        </span>
      </p>
      <textarea
        ng-show="isEditing['overview']"
        ng-model="company.short_description"
        ng-trim="false"
        ng-class="{'has-error': overviewForm.short_description.$invalid && submitted}"
        class="overview-row"
        rows="2"
        maxlength="250"
        name="short_description"
        placeholder="Short description"
        required
        >
      </textarea>
    </div>
  </p>
</div>
<div class="clear"></div>

<div class="year-founded">
  <p class="cp-year-founded">
    <div ng-hide="isEditing['overview']">
      <span>Founded in </span>
      <span>{{profile.company.year_founded}}</span>
    </div>
    <div ng-show="isEditing['overview']">
      <div class="editable">Founded in </div>
      <input
        ng-model="company.year_founded"
        ng-pattern="/^\d{4}$/"
        ng-class="{'has-error': overviewForm.year_founded.$invalid && submitted}"
        class="overview-row"
        type="text"
        name="year_founded"
        placeholder="Year"
        required
        />
     </div>
  </p>
</div>

<div class="company-type">
  <p class="cp-company-type">
    <div class="company-display" ng-hide="isEditing['overview']">
      <span>Company type </span>
      <span ng-show="profile.company.company_status_id != 3">{{profile.company.company_type}}</span>
      <span ng-hide="profile.company.company_status_id != 3">Public (<a ng-href="https://finance.yahoo.com/q?s={{profile.company.ticker_symbol}}" target="_blank">{{profile.company.ticker_symbol}}</a>)</span>
    </div>
    <div class="company-edit" ng-show="isEditing['overview']">
      <div class="editable">Company type </div>
      <select
         ng-model="company.company_status_id"
         ng-class="{'has-error': overviewForm.company_status_id.$invalid && submitted}"
         ng-options="obj.id as obj.name for obj in profile.edit_options.company_statuses"
         name="company_status_id"
         class="overview-row"
         required
         >
        <option value=""></option>
      </select>
    </div>
  </p>
</div>
<div class="clear"></div>


<div class="sector">
  <p class="cp-sector">
    <div ng-hide="isEditing['overview']">
      <span>Industry Group </span>
      <span>{{profile.company.industry_group}}</span>
    </div>
    <div ng-show="isEditing['overview']">
    <div class="editable">Industry Group </div>
    <select
       ng-model="company.industry_group_id"
       ng-class="{'has-error': overviewForm.primary_tag.$invalid && submitted}"
       ng-options="obj.tag_id as obj.name for obj in profile.edit_options.industry_groups"
       class="overview-row"
       name="primary_tag"
       required
       >
      <option value=""></option>
    </select>
    </div>
  </p>
</div>



<div class="stage">
  <p class="cp-stage">
    <div ng-hide="isEditing['overview']">
      <span>Stage </span>
      <span>{{profile.company.stage}}</span>
    </div>
    <div ng-show="isEditing['overview']">
      <div class="editable">Stage </div>
      <select
         ng-model="company.development_stage_id"
         ng-class="{'has-error': overviewForm.development_stage_id.$invalid && submitted}"
         ng-options="obj.id as obj.name for obj in profile.edit_options.development_stages"
         class="overview-row edit-stage"
         name="development_stage_id"
         required
         >
        <option value=""></option>
      </select>
    </div>
  </p>
</div>

<div class="ticker">
  <div ng-show="isEditing['overview']">
    <div class="editable">Ticker </div>
      <input
        ng-model="company.ticker_symbol"
        class="overview-row"
        name="ticker_symbol"
        placeholder="Ticker"
      />
  </div>
</div>
<div class="clear"></div>

<div class="sector">
  <p class="cp-sector">
    <div ng-hide="isEditing['overview']">
      <span>Sector </span>
      <span>{{profile.company.primary_tag}}</span>
    </div>
    <div ng-show="isEditing['overview']">
    <div class="editable">Sector </div>
    <select
       ng-model="company.primary_tag_id"
       ng-class="{'has-error': overviewForm.primary_tag.$invalid && submitted}"
       ng-options="obj.tag_id as obj.name for obj in profile.edit_options.tags"
       class="overview-row"
       name="primary_tag"
       required
       >
      <option value=""></option>
    </select>
    </div>
  </p>
</div>


          <div class="address ">
            <p class="cp-address">
              <div ng-hide="isEditing['overview']">
                <span>Headquarters </span>
                <span ng-show="(profile.company.city && profile.company.state) || (profile.company.city && profile.company.country_id)">
                  <span style="font-weight:300;" ng-show="profile.company.country_id == 15026">{{[profile.company.city, profile.company.state].join(', ')}}</span>
                  <span style="font-weight:300;" ng-show="profile.company.country_id != 15026">{{[profile.company.city, profile.company.country].join(', ')}}</span>

                    <a ng-href="/map/company/{{profile.company.id}}" target="_blank"><img src='/assets/newdesign/MapIcon_18Hx13W_2x-e05c17f55b7cba13ce7c44405ce3d176.png' class="cp-map-icon" /></a>
                </span>
              </div>
              <div ng-show="isEditing['overview']">
              <div class="clear"></div>
                <div class="editable">Address </div>
                <input
                  ng-model="company.address"
                  ng-class="{'has-error': overviewForm.address.$invalid && submitted}"
                  class="overview-row"
                  type="text"
                  name="address"
                  placeholder="Address"
                  required
                  />
              <div class="clear"></div>
                <div class="editable">City </div>
                <input
                  ng-model="company.city"
                  ng-class="{'has-error': overviewForm.city.$invalid && submitted}"
                  class="overview-row"
                  type="text"
                  name="city"
                  placeholder="City"
                  required
                  />
              <div class="clear"></div>

              <div class="state-zip">
                <div class="state-block">
                  <div class="editable">State </div>
                  <select
                     ng-show="isEditing['overview']"
                     ng-model="company.state"
                     ng-class="{'has-error': overviewForm.state.$invalid && submitted}"
                     ng-options="obj.abbrev as obj.name for obj in profile.edit_options.states"
                     class="overview-row"
                     name="state"
                     >
                    <option value=""></option>
                  </select>
                </div>

                <div class="zip-block">
                  <div class="editable">Zip </div>
                  <input
                    ng-model="company.zip"
                    ng-class="{'has-error': overviewForm.zip.$invalid && submitted}"
                    class="overview-row"
                    type="text"
                    name="zip"
                    placeholder="Zip"
                    />
                </div>
              </div>
              <div class="clear"></div>
              <div class="editable">Country </div>
              <select
                 ng-show="isEditing['overview']"
                 ng-model="company.country_id"
                 ng-class="{'has-error': overviewForm.country_id.$invalid && submitted}"
                 ng-options="obj.id as obj.name for obj in profile.edit_options.countries"
                 class="overview-row country"
                 name="country_id"
                 required
                 >
              </select>
              </div>
            </p>
          </div>
          <div class="clear"></div>

          <div class="parent-company">
            <p class="cp-parent-company">
              <div ng-hide="isEditing['overview']">
                <span ng-show="profile.structure.parent != ''">
                  <span class="label overview-pc">Parent Companies </span><span ng-bind-html="htmlBindings['parentCompaniesHtml']"></span>
                </span>
              </div>
            </p>
          </div>

          <div class="website">
            <p class="cp-website">
              <div ng-hide="isEditing['overview']">
                <span ng-show="profile.company.website"><a href="{{profile.company.website}}" target="_blank">Website<a></span>
              </div>

              <div ng-show="isEditing['overview']">
                <div class="editable">Website </div>
                <input
                  ng-model="company.website"
                  ng-class="{'has-error': overviewForm.website.$invalid && submitted}"
                  class="overview-row"
                  type="url"
                  name="website"
                  placeholder="Website"
                  http-prefix
                  required
                  />
              </div>
            </p>
          </div>



          <div ng-hide="isEditing['overview']"
            class="last-updated float-right"
            ng-class="{'second-row-updater': profile.updated_by_info.second}"
            style="width:406px;"
          >
            <p ng-show="profile.updated_by_info.first">{{profile.updated_by_info.first}}</p>
            <p ng-show="profile.updated_by_info.second">{{profile.updated_by_info.second}}</p>
          </div>

          <div class="clear"></div>

        </div>
      </div>
    </div>
  </form>
  </div>

  <div class="app-tile one-third-section float-right" data-tile-id="git" >
  <div class="tile-header">
    <span>Get in touch</span>
    <div class="tile-header-icons"></div>
    <div class="clear"></div>
  </div>
  <div class="tile-content git-content git-open-profile">
    <div class="git-contact-details">
      <div ng-hide="profile.primary_contact.id" class="cp-no-contacts">
        <span>We don't have team members for this company yet!</span>
      </div>
      <div class="git-primary-contact-div" ng-show="profile.primary_contact.id" >
        <ul class="primary-contact-list">
          <li>
            <div class="thumb-85 thumb thumb-center">
              <img ng-src="{{profile.primary_contact.image_url || '/assets/newdesign/placeholders/user-95272108297331489ed0c08942cb17ab.png'}}" />
            </div>
          </li>
          <li class="font-size-12 weight600"><span>{{profile.primary_contact.name}}</span></li>
          <li ng-show="profile.primary_contact.title"><div class="font-size-13 git-title">{{profile.primary_contact.title}}</div></li>
          <li ng-show="profile.primary_contact.email">
            <div class="cp-social-icon">
              <a class="contact-profile-button link_email">
                <img src="/assets/newdesign/Envelop_Grey_18x18_2x-67ba5cb923eb058c42089dc5358fe50e.png" class="cp-team-email-icon cursor-pointer social" /> Message {{profile.primary_contact.first_name}}
              </a>
            </div>
          </li>           
          <li>
            <div class="cp-team-size-info">
              <ng-pluralize count="profile.company_editor_users.length"
                  when="{'0': '0 team members on i3',
                         '1': '1 team member on i3',
                        'other': '{} team members on i3'}">
            </div>
          </li>
        </ul>
      </div>
      <div class="work-at-company">Work at this company?</div>
      <a href="#" class="claim-profile-btn" id="claim-open-profile">Claim this profile</a>
    </div>
  </div>
</div>

</div>


  <div class="clear"></div>

      <div class="content-row">
  <div class="app-tile full-section">
    <div class="tile-header">
      <span>Traction</span>
    </div>
    <div class="tile-content traction-content">
      <div class="one-sixth-column">
        <ul>
          <li><a style="font-weight:600;font-size:15px;" href="#" ng-click="scrollTo('customer-full-tile');">{{profile.traction.customers.total}} customers</a></li>
          <li ng-show="profile.traction.customers.confirmed > 0">({{profile.traction.customers.confirmed}} confirmed)</li></ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li><a href="#" ng-click="scrollTo('partnership-full-tile');">{{profile.traction.partnerships.total}} partnerships</a></li>
          <li ng-show="profile.traction.partnerships.confirmed > 0">({{profile.traction.partnerships.confirmed}} confirmed)</li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li><a href="#" ng-click="scrollTo('financing-full-tile');">{{profile.traction.financing.rounds}} financing rounds</a></li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul><li><a href="#" ng-click="scrollTo('financing-full-tile');">{{profile.traction.financing.investors}} investors</a></li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li>
            <div><a href="#" ng-click="scrollTo('product-full-tile');">{{profile.products.length}} products</a></div>
          </li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li>
            <div>{{profile.ma.length}} M&amp;A items</div>
        </ul>
      </div>
    </div>
    <div class="clear"></div>
  </div>
</div>



<div class="clear"></div>

  <script src="/assets/jquery.caret.min-a304d40f13975984db09e15acb9b6569.js" type="text/javascript"></script>
<script src="/assets/jquery.tag-editor-0a09aeae601f0dde96629b42c8a327cf.js" type="text/javascript"></script>
<link href="/assets/jquery.tag-editor-6f6cee900bef73d9317c514faa769058.css" media="screen" rel="stylesheet" type="text/css" />

<style>
	.tag_link {
		background: none repeat scroll 0 0 #959595;
	    color: #fff;
	    font-size: 15px;
	    font-weight: 600;
	    height: 50px;
    	text-align: center;
	    vertical-align: middle;
	    padding: 0px 20px;	
	}
	
	.tag_link:hover {
	  	background: none repeat scroll 0 0 #FF671B !important;
	}
</style>

<div class="content-row" >
  <div class="app-tile full-section" data-tile-id="tags" >
  <form name="tagForm" novalidate>
    <div class="tile-header">
      <span>tags</span>
      <div class="clear"></div>
    </div>
    <div class="tile-content tags-content">
      <div>
         <table ng-hide="isEditing['tags']" style="margin-bottom: 15px;">
         	<tr>
         		<td>Industry Group</td>
         		<td></td>
         		<td>Sector</td>
         	</tr>
         	<tr>
         		<td class="tag_link"><a href="tag/resources-environment">{{profile.industry_group}}</a></td>
				<td style="width: 20px;"></td>
         		<td class="tag_link"><a href="tag/resources-environment">{{profile.primary_tag}}</a></td>
         	</tr>
         </table>
         
		  <span ng-hide="isEditing['tags']">Tags</span>
	      <div class="taxonomy-lists" ng-hide="isEditing['tags']">
    	    <ul>
        	  <li ng-repeat="tag in profile.company_tags">
	            <a ng-href="/tag/{{tag.slug}}" class="linkable">
    	          <span>{{tag.tag}} <span ng-show="tag.startup_count">({{tag.startup_count}})</span></span>
	            </a>
	          </li>
	        </ul>
	      </div>
	  </div>

      <div class="tags-edit">
        <div class="padding-bottom-20px" ng-show="isEditing['tags']">
        </div>
        <div class="clear"></div>
      </div>

    </div>
    </form>
  </div>
</div>

  <div class="clear"></div>
  <div class="content-row" ng-show="profile.recommendations.length > 0">
  <div class="app-tile full-section" data-tile-id="recommended" >
    <div class="tile-header">
      <span>Similar companies (beta)</span>
      <div class="tile-header-icons">
      </div>
    </div>

    <div class="tile-content">
      <div id="company-recommendations" class="owl-carousel">
        <div class="" ng-repeat="rec in companyRecommendations" recommend-carousel>
          <div class="image-holder"><a ng-href="{{rec.url}}?refpro=profsimilar" class="recommended-company"><img class="recommend-image" ng-src="{{rec.logo_url}}" /></a></div>
          <!--p>
            <a ng-href="{{rec.url}}">{{rec.name}}</a><br/>
            <span>{{rec.primary_tag}}</span>
          </p-->
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="clear"></div>
    <div class="content-row" id="customer-full-tile" ng-show="profile.customers.length > 0 || isEditingMode">
    <div class="app-tile full-section" data-tile-id="customer" >
    <form name="customerForm" novalidate>
      <div class="tile-header">
        <span>Customers</span>
        <div class="tile-header-icons">
          <div ng-show="showLoading['customer'] || globalLoading" class="tile-icons icon-loading"><img alt="45" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" /></div>
          <div ng-show="showPencil['customer']" ng-click="edit('customer')" class="tile-icons icon-pencil"><img alt="Editicon_blue_22x22px_2x" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></div>
          <div ng-show="showSave['customer']" class="tile-icons icon-remove"><div class="save-tile" ng-click="save('customer', customerForm.$valid)">Save</div><img alt="Cancelicon_blue_22x22px_2x" ng-click="cancelEdit(&#x27;customer&#x27;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-94947632d9a720a2747ef0a564672072.png" /></div>
        </div>
        <div class="clear"></div>
      </div>
      <div class="tile-content customer-content">
        <div class="tile-row-add" ng-hide="!isEditing['customer']"><a class="cursor-pointer edit-add" editcustomer>Add Customer</a></div>

        <table class="customers-table">
          <thead>
            <td class="first-td">Date</td>
            <td class="second-td"></td>
            <td class="third-td">Company</td>
            <td class="fourth-td"></td>
            <td class="fifth-td"></td>
          </thead>
          <tbody>
            <!-- edit row -->
            <tr class="edit-row" style="display:none;">
              <td class="vert-top">
                <input
                ng-model="customer.relationship_date"
                ng-class="{'has-error': customerForm.relationship_date.$invalid && submitted}"
                ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
                type="text"
                class="edit-date"
                name="relationship_date"
                placeholder="Date" />
              </td>
              <td class="vert-top">
                <img class="company-img" ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" />
              </td>
              <td class="vert-top">
                <div class="edit-block">
                  <div>
                    <div class="add-block"><span>Can't find a company?</span> <a href="#" class="add-company-button">Add a company</a></div>
                    <input type="text" name="add_customer" class="add_customer_input" />
                  </div>
                  <p>
                    <div>
                      <span>Description </span>
                      <span class="float-right char-limiter" ng-class="{'error-message': customer.notes.length > 400}">{{400 - customer.notes.length}}/400
                        <span style="font-weight:normal;">characters left</span>
                      </span>
                    </div>
                    <textarea
                      ng-model="customer.notes"
                      type="text"
                      class="edit-width edit-notes"
                      name="notes"
                      maxlength="400"
                      ng-trim="false"
                      placeholder="Notes"></textarea>
                  </p>
                  <p>
                    <span>Related press release or article about this deal</span>
                    <input
                      ng-model="customer.source"
                      ng-class="{'has-error': customerForm.source.$invalid && submitted}"
                      class="edit-width edit-source"
                      type="url"
                      name="source"
                      placeholder="Source URL"
                      http-prefix />
                  </p>
                  <p>
                    <span>Confirm relationship* <span style="font-weight:normal;">(Enter the email address of your counterpart at this company so they can confirm your relationship!)</span></span>
                    <input
                      ng-model="customer.confirmation_email"
                      ng-class="{'has-error': customerForm.confirmation_email.$invalid && submitted}"
                      ng-pattern="/^(.(?!(@(gmail|hotmail|yahoo)\.)))*$/"
                      class="edit-width edit-email"
                      type="email"
                      name="confirmation_email"
                      placeholder="Confirmation Email" />
                  </p>
                  <div class="edit-buttons">
                    <a class="btn cancel-btn" cancelcustomer>Cancel</a>
                    <a class="btn save-btn" ng-click="save('customer', customerForm.$valid)">Save</a>
                  </div>
                </div>
              </td>
              <td></td>
              <td></td>
            </tr>
            <!-- end edit row -->
            <tr ng-repeat="customer in profile.customers" data-customer-id={{customer.id}}>
              <td class="vert-top">{{customer.relationship_date | date: 'MM/dd/yyyy'}}</td>
              <td>
                <a ng-hide="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}"
                  ng-href="{{customer.company1.id == profile.company.id ? customer.company2.url : customer.company1.url}}"
                  target="_blank">
                  <div class="thumb-60 thumb">
                   <img ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" />
                  </div>
                </a>
                <div ng-show="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}"
                  class="thumb-60 thumb">
                   <img ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" />
                </div>
              </td>
              <td>
                <p class="name">
                  <a
                    ng-hide="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}"
                    ng-href="{{customer.company1.id == profile.company.id ? customer.company2.url : customer.company1.url}}"
                    target="_blank">{{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}}</a>
                  <span ng-show="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}">{{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}}</span>
                </p>
                <p><span>{{customer.notes}}</span></p>
                <p>
                  <div ng-show="customer.company_relationship_confirmation.status=='confirmed'" class="cp-confirmed">Confirmed by {{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}}</div>
                  <div ng-hide="customer.company_relationship_confirmation.status=='confirmed'" class="cp-not-confirmed">Not confirmed by {{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}} yet</div>
                </p>
              </td>
              <td class="vert-top">
                <div ng-hide="isEditing['customer']"><a ng-show="customer.source" style="float:right;" ng-href="{{customer.source}}" target="_blank" rel="nofollow">Learn more</a></div>
              </td>
              <td ng-show="isEditing['customer']" class="edit-group">
                <div class="edit-icon-group">
                    <a id="customer_{{customer.id}}" editcustomer><img alt="Editicon_blue_22x22px_2x" class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></a>
                    <a onclick="$(this).parents('tr').addClass('customer-deleted').hide()" class="delete-text">Delete</a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="clear"></div>
      </div>
    </form>
    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
    </div>
  </div>

  <div class="clear"></div>
    <div class="content-row" id="partnership-full-tile" ng-show="profile.relationships.length > 0 || isEditingMode">
    <div class="app-tile full-section" data-tile-id="relationship" >
      <form name="relationshipForm" novalidate>
      <div class="tile-header">
        <span>Partnerships</span>
        <div class="tile-header-icons">
          <div ng-show="showLoading['relationship'] || globalLoading" class="tile-icons icon-loading"><img alt="45" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" /></div>
          <div ng-show="showPencil['relationship']" ng-click="edit('relationship')" class="tile-icons icon-pencil"><img alt="Editicon_blue_22x22px_2x" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></div>
          <div ng-show="showSave['relationship']" class="tile-icons icon-remove"><div class="save-tile" ng-click="save('relationship', relationshipForm.$valid)">Save</div><img alt="Cancelicon_blue_22x22px_2x" ng-click="cancelEdit(&#x27;relationship&#x27;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-94947632d9a720a2747ef0a564672072.png" /></div>
        </div>
        <div class="clear"></div>
      </div>
      <div class="tile-content relationship-content" ng-click="relationshipEdit($event)">
        <div class="tile-row-add" ng-hide="!isEditing['relationship']"><a class="cursor-pointer edit-add" editrelationship>Add Partnership</a></div>

        <table class="relationships-table">
          <thead>
            <tr>
              <td class="first-td">Date</td>
              <td class="second-td"></td>
              <td class="third-td">Partner</td>
              <td class="fourth-td">Type</td>
              <td ng-show="isEditing['relationship']" class="fifth-td"></td>
            </tr>
          </thead>
          <tbody>
            <!-- edit row -->
            <tr class="edit-row" style="display:none;">
              <td class="vert-top">
                <input
                  ng-model="relationship.relationship_date"
                  ng-class="{'has-error': relationshipForm.relationship_date.$invalid && submitted}"
                  ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
                  type="text"
                  class="edit-date"
                  name ="relationship_date"
                  placeholder="Date" />
              </td>
              <td class="vert-top">
                <div class="pictures">
                  <div ng-show="{{relationship.company1.id == profile.company.id ? relationship.company2.hidden : relationship.company1.hidden}}"
                    class="thumb-60 thumb">
                     <img ng-src="{{(relationship.company1.id == profile.company.id ? relationship.logo_url2 : relationship.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" />
                  </div>
                </div>
              </td>
              <td class="vert-top">
                <div class="edit-block">
                  <div class="edit-width">
                    <div class="add-block"><span>Can't find a partner?</span> <a href="#" class="add-company-button">Add one</a></div>
                    <input type="text" name="add_relationship" id="add_relationship_input" class="add_relationship_input"  />
                  </div>
                  <p>
                    <div>
                      <span>Description</span>
                      <span class="float-right char-limiter" ng-class="{'error-message': relationship.notes.length > 400}">{{400 - relationship.notes.length}}/400
                        <span style="font-weight:normal;">characters left</span>
                      </span>
                    </div>
                    <textarea
                      ng-model="relationship.notes"
                      class="edit-width edit-notes"
                      type="text"
                      name="notes"
                      maxlength="400"
                      ng-trim="false"
                      placeholder="Notes"></textarea>
                  </p>
                  <p>
                    <span>Related press release or article about this deal</span>
                    <input
                      ng-model="relationship.source"
                      ng-class="{'has-error': relationshipForm.source.$invalid && submitted}"
                      class="edit-width edit-source"
                      type="url"
                      name="source"
                      placeholder="Source URL"
                      http-prefix />
                  </p>
                  <p>
                    <span>Confirm relationship* <span style="font-weight:normal;">(Enter the email address of your counterpart at this company so they can confirm your relationship!)</span></span>
                    <input
                      ng-model="relationship.confirmation_email"
                      ng-class="{'has-error': relationshipForm.confirmation_email.$invalid && submitted}"
                      ng-pattern="/^(.(?!(@(gmail|hotmail|yahoo)\.)))*$/"
                      class="edit-width edit-email"
                      type="email"
                      name="confirmation_email"
                      placeholder="Confirmation Email" />
                  </p>
                  <div class="edit-buttons">
                    <a class="btn cancel-btn" cancelrelationship>Cancel</a>
                    <a class="btn save-btn" ng-click="save('relationship', relationshipForm.$valid)">Save</a>
                  </div>
                </div>
              </td>

              <td class="vert-top">
                <select
                  ng-model="relationship.relationship_type_id"
                  ng-class="{'has-error': relationshipForm.relationship_type_id.$invalid && submitted}"
                  ng-options="obj.id as obj.name for obj in profile.edit_options.partnership_relationship_types"
                  class="edit-relationship-type"
                  name="relationship_type_id" >
                </select>
              </td>
              <td></td>
            </tr>
            <!-- end edit row -->
            <tr ng-repeat="rel in profile.relationships" data-relationship-id="{{rel.id}}">
              <td class="vert-top">{{rel.relationship_date | date: 'MM/dd/yyyy'}}</td>
              <td class="vert-top">
                <div class="pictures">
                  <a ng-hide="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}"
                    ng-href="{{rel.company1.id == profile.company.id ? rel.company2.url : rel.company1.url}}">
                    <div class="thumb-60 thumb">
                     <img ng-src="{{(rel.company1.id == profile.company.id ? rel.logo_url2 : rel.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" />
                    </div>
                  </a>
                  <div ng-show="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}"
                    class="thumb-60 thumb">
                     <img ng-src="{{(rel.company1.id == profile.company.id ? rel.logo_url2 : rel.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-2b5e52d3074f9a8663e8f4d077e72eb8.png'}}" />
                  </div>
                </div>
              </td>
              <td class="vert-top font14">
                <div class="company-content">
                  <a
                    class="ctg-orange"
                    target="_blank"
                    ng-href="{{rel.company1.id == profile.company.id ? rel.company2.url : rel.company1.url}}"
                    ng-hide="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}">{{rel.company1.id == profile.company.id ? rel.company2.name : rel.company1.name}}
                  </a>
                  <span
                    ng-show="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}" >{{rel.company1.id == profile.company.id ? rel.company2.name : rel.company1.name}}
                  </span>
                  <div class="notes weight300 font12">
                    <div ng-show="rel.notes" style="white-space:pre-line;">{{rel.notes | limitTo: 500}} {{rel.notes.length > 500 ? '...' : ''}}</div>
                    <span class="source">
                      <div>
                        <a ng-show={{URL_REGEXP.exec(rel.source)}} class="ctg-orange float-left" href="{{rel.source}}" target="_blank" rel="nofollow">View source&nbsp;&nbsp;&nbsp;&nbsp;</a>
                        <div ng-show="rel.company_relationship_confirmation.status=='confirmed'" class="cp-confirmed float-left">Confirmed by {{rel.company1.id == profile.company.id? rel.company2.name : rel.company1.name}}</div>
                        <div ng-hide="rel.company_relationship_confirmation.status=='confirmed'" class="cp-not-confirmed float-left">Not confirmed by {{rel.company1.id == profile.company.id? rel.company2.name : rel.company1.name}} yet</div>
                      </div>
                    </span>
                  </div>
                </div>
              </td>
              <td class="vert-top">{{rel.company1.id == profile.company.id ? rel.relationship_type.name : rel.relationship_type.reciprocal.name}}</td>
              <td ng-show="isEditing['relationship']" class="vert-top">
                <div class="edit-group">
                  <div class="edit-icon-group">
                      <a id="relationship_{{rel.id}}" editrelationship><img alt="Editicon_blue_22x22px_2x" class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></a>
                      <a onclick="$(this).parents('tr').addClass('relationship-deleted').hide()" class="delete-text">Delete</a>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
  </div>
</div>

  <div class="clear"></div>
  <div class="content-row" id="financing-full-tile" ng-show="profile.investments.length > 0 || isEditingMode">
  <div class="app-tile full-section" data-tile-id="investment" >
  <form name="investmentForm" novalidate>
    <div class="tile-header">
      <span>Investment Rounds</span>
      <div class="tile-header-icons">
        <div ng-show="showLoading['investment'] || globalLoading" class="tile-icons icon-loading"><img alt="45" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" /></div>

			<!-- <div onclick="alert('Investments are not editable by Profile Owners. Please contact <a href=\"mailto:research@cleantech.com?Subject=Hello%20again\" target=\"_top\">research@cleantech.com</a> to make changes.');" class="tile-icons icon-pencil"><img alt="Editicon_blue_22x22px_2x" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></div> -->
			<div id="investment-no-edit-button" class="tile-icons icon-pencil"><img alt="Editicon_blue_22x22px_2x" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></div>
		
        <div ng-show="showSave['investment']" class="tile-icons icon-remove"><div class="save-tile" ng-click="save('investment', investmentForm.$valid)">Save</div><img alt="Cancelicon_blue_22x22px_2x" ng-click="cancelEdit(&#x27;investment&#x27;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-94947632d9a720a2747ef0a564672072.png" /></div>
      </div>
      <div class="clear"></div>
    </div>

    <div class="tile-content investment-content">
      <div class="ipo-info" ng-show="ipoHistory">
        <p><h3>IPO INFORMATION</h3></p>
        <span class="cp-border"></span>
        <div>
          <table class="ipos-table">
            <tr>
              <td>
                <h3>Date</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.as_of_date}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.as_of_date"
                  datepicker
                  ng-class="{'has-error': investmentForm.ipo_as_of_date.$invalid && submitted}"
                  ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
                  type="text"
                  class=""
                  name ="ipo_as_of_date" />
              </td>
              <td>
                <h3>IPO status</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.ipo_status.name}}</span>
                <select
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.ipo_status_id"
                  ng-options="obj.id as obj.name for obj in profile.edit_options.ipo_statuses"
                  name="ipo_status_name">
                </select>
              </td>
              <td>
                <h3>Amount</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.amount_formatted}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.amount"
                  ng-pattern="/^\d+$/"
                  type="text"
                  ng-class="{'has-error': investmentForm.ipo_amount.$invalid && submitted}"
                  name="ipo_amount" />
              </td>
            </tr>

            <tr>
              <td>
                <h3>Initial shares</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.initial_share}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.initial_share"
                  ng-pattern="/^\d+$/"
                  type="text"
                  ng-class="{'has-error': investmentForm.ipo_initial_share.$invalid && submitted}"
                  name="ipo_initial_share" />
              </td>
              <td>
                <h3>Ticker symbol</h3>
                <span ng-hide="isEditing['investment']">{{profile.company.ticker_symbol}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.ticker_symbol"
                  type="text"
                  name="ipo_ticker_symbol" />
              </td>
              <td>
                <h3>Exchange listed</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.exchange}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.exchange"
                  type="text"
                  name="ipo_exchange" />
              </td>
            </tr>

            <tr>
              <td>
                <h3 ng-show="isEditing['investment']">Prospectus URL</h3>
                <a ng-hide="isEditing['investment']" href="{{profile.ipo_history.prospectus}}" class="de-emph">Prospectus</a>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.prospectus"
                  type="url"
                  ng-class="{'has-error': investmentForm.ipo_prospectus.$invalid && submitted}"
                  name="ipo_prospectus"
                  http-prefix />
              </td>
              <td>
                <h3 ng-show="isEditing['investment']">Source URL</h3>
                <a ng-hide="isEditing['investment']" href="{{profile.ipo_history.source}}" target="_blank" rel="nofollow">Source</a>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.source"
                  type="url"
                  ng-class="{'has-error': investmentForm.ipo_source.$invalid && submitted}"
                  name="ipo_source"
                  http-prefix />
              </td>
              <td>
              </td>
            </tr>
          </table>
          <div class="ipo-notes">
            <h3>Description</h3>
            <p ng-hide="isEditing['investment']">{{profile.ipo_history.notes}}</p>
            <textarea
              ng-show="isEditing['investment']"
              ng-model="ipoHistory.notes"
              type="text"
              class="notes_textarea"
              ng-class="{'has-error': investmentForm.ipo_notes.$invalid && submitted}"
              name="ipo_notes"></textarea>
            <div class="edit-buttons" ng-show="isEditing['investment']">
              <a class="btn cancel-btn" ng-click="cancelEdit('ipo_history')">Cancel</a>
              <a class="btn save-btn" ng-click="save('investment', investmentForm.$valid)">Save</a>
            </div>
          </div>
        </div>
        <div class="clear"></div>
      </div>

      <div class="tile-row-add" ng-hide="!isEditing['investment']"><a class="cursor-pointer edit-add" editinvestment>Add Investment</a></div>

      <table class="investments-table">
        <thead>
          <td class="first-td">Date</td>
          <td class="third-td">Investors</td>
          <td class="fourth-td">Type</td>
          <td class="fifth-td">Amount</td>
          <td class="sixth-td"></td>
        </thead>
        <tbody>
          <!-- edit row -->
          <tr class="edit-row" style="display:none;">
            <td class="vert-top">
              <input
              ng-model="investment.investment_date"
              ng-class="{'has-error': investmentForm.investment_date.$invalid && submitted}"
              ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
              type="text"
              class="edit-date"
              name="investment_date"
              placeholder="Date" />
            </td>
            <td class="vert-top">
              <div class="edit-block">
                <div>
                  <div class="add-block"><span>Can't find an investor?</span> <a href="#" class="add-investor-button">Add an investor</a></div>
						<input type="text" name="add_investment_input" class="add_investment_input" /> 
				  </div>
                <p>
                  <span>Valuation</span>
                  <input
                    ng-model="investment.valuation"
                    ng-pattern="/^\d+$/"
                    ng-class="{'has-error': investmentForm.valuation.$invalid && submitted}"
                    class="edit-width edit-valuation"
                    type="text"
                    name="valuation"
                    placeholder="Valuation" />
                </p>

                <p>
                  <span>Description</span>
                  <span class="float-right char-limiter" ng-class="{'error-message': investment.notes.length > 400}">{{400 - investment.notes.length}}/400
                    <span style="font-weight:normal;">characters left</span>
                  </span>
                  <textarea ng-model="investment.notes"
                    class="edit-width edit-notes"
                    type="text"
                    name="notes"
                    maxlength="400"
                    ng-trim="false"
                    ng-class="{'has-error': investment.notes.$invalid && submitted}"
                    placeholder="Notes"></textarea>
                </p>
                <p>
                  <span>Related press release or article about this deal</span>
                  <input
                    ng-model="investment.source"
                    ng-class="{'has-error': investmentForm.source.$invalid && submitted}"
                    class="edit-width edit-source"
                    type="url"
                    name="source"
                    placeholder="Source URL"
                    http-prefix />
                </p>
                <div class="edit-buttons">
                  <a class="btn cancel-btn" cancelinvestment>Cancel</a>
                  <a class="btn save-btn" ng-click="save('investment', investmentForm.$valid)">Save</a>
                </div>
              </div>
            </td>
            <td class="vert-top edit-investment-type-td">
              <select
                ng-model="investment.investment_type_id"
                ng-class="{'has-error': investmentForm.investment_type_id.$invalid && submitted}"
                ng-options="obj.id as obj.name for obj in profile.edit_options.investment_types"
                class="edit-investment-type"
                name="investment_type_id" >
              </select>
                
        <!--new -->
        <!--end new -->       
                
            </td>
              
 
              
            <td class="vert-top edit-valuation-td">
               <input
                    ng-model="investment.amount"
                    ng-pattern="/^\d+$/"
                    ng-class="{'has-error': investmentForm.amount.$invalid && submitted}"
                    class="edit-width-small edit-amount"
                    type="text"
                    name="amount"
                    placeholder="Amount" />
              
                
        <!--new --> 
        <!--end new --> 
                
                
              </td>
            <td></td>
          </tr>
          <!-- end edit row -->
          <tr ng-repeat="investment in profile.investments" class="investment-item" data-investment-id={{investment.id}} >
            <td class="vert-top">{{investment.investment_date | date: 'MM/dd/yyyy'}}</td>
            <td class="vert-top font14 weight600">
              <span ng-repeat="investor in investment.investors">
                <a target="_blank" class="ctg-orange" href="{{investor.url}}" ng-hide="{{investor.hidden}}">{{investor.name}}</a>
                <span ng-show="{{investor.hidden}}" >{{investor.name}}</span>
                {{$last ? '': ', '}}
              </span>
              <span ng-show="investment.investors.length > 0" class="weight300 font13"> ({{investment.investors.length}})</span>

              <div class="notes weight300 font13">
                <div ng-show="investment.valuation">Post-money valuation of {{investment.valuation | numShort}}</div>
                <div ng-show="investment.notes">{{investment.notes}}</div>
                <span class="source">
                  <div ng-show={{URL_REGEXP.exec(investment.source)}}>(<a class="ctg-orange" href="{{investment.source}}" target="_blank">source</a>)</div>
                </span>
              </div>
            </td>
            <td class="vert-top">{{investment.investment_type.name}}</td>
            <td class="vert-top" >{{investment.amount | nfcurrency}}</td>
            <td ng-show="isEditing['investment']" class="edit-group">
              <div class="edit-icon-group">
                  <a id="investment_{{investment.id}}" editinvestment><img alt="Editicon_blue_22x22px_2x" class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></a>
                  <a onclick="$(this).parents('tr').addClass('investment-deleted').hide()" class="delete-text">Delete</a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="add-ipo" ng-show="isEditing['investment']&&(ipoHistory==undefined||ipoHistory.id==null)"><a ng-click="addIpo()">Click</a> to add IPO information</div>
    </div>
    </form>
    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
  </div>
</div>

  <div class="clear"></div>
  <div class="content-row" id="product-full-tile" ng-show="profile.products.length > 0 || isEditingMode">
  <div class="app-tile full-section" data-tile-id="product" >
    <form name="productForm" novalidate>
    <div class="tile-header">
      <span>Products</span>
      <div class="tile-header-icons">
        <div ng-show="showLoading['product'] || globalLoading" class="tile-icons icon-loading"><img alt="45" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" /></div>
        <div ng-show="showPencil['product']" ng-click="edit('product')" class="tile-icons icon-pencil"><img alt="Editicon_blue_22x22px_2x" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></div>
        <div ng-show="showSave['product']" class="tile-icons icon-remove"><div class="save-tile" ng-click="saveProduct('product', productForm.$valid)">Save</div><img alt="Cancelicon_blue_22x22px_2x" ng-click="cancelEdit(&#x27;product&#x27;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-94947632d9a720a2747ef0a564672072.png" /></div>
      </div>
      <div class="clear"></div>
    </div>
    <div class="tile-content product-content">
      <div class="tile-row-add" ng-hide="!isEditing['product']"><a class="cursor-pointer edit-add" editproduct>Add Product</a></div>

      <table class="products-table">
        <thead>
          <td class="first-td">Product image</td>
          <td class="second-td">Name</td>
          <td class="third-td">Product status</td>
          <td class="fourth-td">Revenue model</td>
          <td class="fifth-td" ng-show="tagPresent('energy storage')">Cost metrics</td>
          <td></td>
        </thead>
        <tbody>
          <!-- edit row -->
          <tr class="edit-row" style="display:none;">
            <td class="vert-top">
              <div class="upload-image-holder">
                <div class="upload-cv-button">
                  <!--span class="upload-image-icon"></span-->
                  <img alt="Product_icon_130x130_gray" id="product_image_preview" src="/assets/newdesign/Product_Icon_130x130_gray-f8f071dabcd947c8eedf473cf6fe46b3.png" />
                  <input
                    onchange="angular.element(this).scope().productPictureChanged(this)"
                    file-input="files"
                    class="product-picture"
                    name="product_image"
                    type="file"
                    multiple
                    accept="image/*" />
                </div>
                <a href="javascript:void(0);" class="select-image-button">Select Image</a>
              </div>
            </td>
            <td class="vert-top">
              <div class="edit-block">
                <input
                  ng-model="product.name"
                  ng-class="{'has-error': productForm.name.$invalid && submitted}"
                  class="edit-width edit-name"
                  type="text"
                  name="name"
                  placeholder="Name" />
                <p>
                  <div>
                    <span>Description</span>
                    <span class="float-right char-limiter" ng-class="{'error-message': product.description.length > 400}">{{400 - product.description.length}}/400
                      <span style="font-weight:normal;">characters left</span>
                    </span>
                  </div>
                  <textarea
                    ng-model="product.description"
                    type="text"
                    class="edit-width edit-description"
                    name="Description"
                    maxlength="400"
                    ng-trim="false"
                    placeholder="Brief description of the product"></textarea>
                </p>

                <div class="edit-buttons">
                  <a class="btn cancel-btn" cancelproduct>Cancel</a>
                  <a class="btn save-btn" ng-click="saveProduct('product', productForm.$valid)">Save</a>
                </div>
              </div>
            </td>
            <td>
              <select
                class="product-status edit-status"
                ng-model="product.product_status_id"
                ng-options="obj.id as obj.name for obj in profile.edit_options.product_statuses"
                name="product_status_id">
                <option value=""></option>
              </select>
            </td>
            <td class="product-revenue-td">
              <select
                class="product-revenue edit-revenue"
                ng-model="product.revenue_id"
                ng-options="obj.id as obj.name for obj in profile.edit_options.revenues"
                name="revenue_id">
                <option value=""></option>
              </select>
            </td>
            <td ng-show="tagPresent('energy storage')">
              <span>US$/kW (current)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kw_current"
                ng-model="product.usd_per_kw_current" /><br/>
              <span>US$/kWh (current)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kwh_current"
                ng-model="product.usd_per_kwh_current" /><br/>
              <span>US$/kW (projected)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kw_prospected"
                ng-model="product.usd_per_kw_prospected" /><br/>
              <span>US$/kWh (projected)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kwh_prospected"
                ng-model="product.usd_per_kwh_prospected" />
              <div class="clear"></div>
            </td>
          </tr>
          <!-- end edit row -->
          <tr ng-repeat="product in profile.products" data-product-id={{product.id}}>
            <td class="vert-top">
              <div class="pictures">
                <div class="thumb-60 thumb">
                  <img ng-src="{{product.product_image_url || '/assets/newdesign/Product_Icon_130x130_gray-f8f071dabcd947c8eedf473cf6fe46b3.png'}}" />
                </div>
              </div>
            </td>
            <td class="vert-top">
              <p class="name"><a>{{product.name}}</a></p>
              <p>{{product.description}}</p>
            </td>
            <td>
              <span>{{product.product_status_name}}</span>
            </td>
            <td class="vert-top">
              <span>{{product.revenue_name}}</span>
            </td>
            <td ng-show="tagPresent('energy storage')">
              <div>
                <div ng-show="product.usd_per_kw_current || product.usd_per_kwh_current || product.usd_per_kw_prospected || product.usd_per_kwh_prospected">
                  <span ng-show="product.usd_per_kw_current"     class="data-content-overview"> ${{product.usd_per_kw_current}}/kW      (current)  </span><br/>
                  <span ng-show="product.usd_per_kw_prospected"  class="data-content-overview"> ${{product.usd_per_kw_prospected}}/kW   (projected)</span><br/>
                  <span ng-show="product.usd_per_kwh_current"    class="data-content-overview"> ${{product.usd_per_kwh_current}}/kWh    (current)  </span><br/>
                  <span ng-show="product.usd_per_kwh_prospected" class="data-content-overview"> ${{product.usd_per_kwh_prospected}}/kWh (projected)</span>
                </div>
              </div>
            </td>
            <td class="vert-top edit-group">
              <div ng-show="isEditing['product']" class="edit-icon-group">
                <a id="product_{{product.id}}" editproduct><img alt="Editicon_blue_22x22px_2x" class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-ae1f66dfeaf62280f4dbcce0835ec513.png" /></a>
                <a onclick="$(this).parents('tr').addClass('product-deleted').hide()" class="delete-text">Delete</a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    </form>

    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
  </div>
</div>

  <div class="clear"></div>
  <div class="demo-div">
  <span class="demo-span">You are viewing a limited version of this profile.  To access i3's full capabilities.</span> <a href="#" class="signup-button">Sign up</a>
</div>

  <div class="clear"></div>
  <a href="#" id="back-to-top-btn">Back to top</a>
</div>

<!--
user_type                           
:owns_profile,                      false
:get_in_touch,                      false
:view_full_traction,                false
:view_profile,                      false
:view_product_and_deck,             false
:view_acquired_company_message,     false
:view_seeking_funding_msg,          false
:view_product_without_deck,         false
:view_notes,                        false
:view_academic_team_snapshot,       false
:view_team,                         false
-->


    </div> <!-- end .container -->
  </div> <!-- end #content -->

  <div class="clear"></div>
    <!-- Footer -->
  <div id="footer-wrapper">
    <footer id="footer" class="section">
      <ul id="footer-menu">
          <li><a href="#" id="contact_us_link">Contact Us</a> </li>
      </ul>
      <a href="https://twitter.com/i3Connect" class="tw-follow" target="_blank">Follow i3</a>

      <div class="clear-desktop"></div>
      <a href="http://www.cleantech.com" id="cleantech-logo" rel="nofollow" target="_blank"></a>

      <ul id="tos-menu">

        <li>&copy; 2019 Cleantech Group</li>
        <li><a href="/sitemap.html">Site Map</a></li>
        <li><a href="http://www.cleantech.com/terms-of-use/" rel="nofollow" target="_blank">Terms Of Use</a></li>
        <li><a href="http://www.cleantech.com/privacy-policy/" rel="nofollow" target="_blank">Privacy Policy</a></li>
      </ul>
      <div class='clear'></div>
    </footer>
  </div><!-- END Footer -->


<p style="font-weight: 100; visibility: hidden;height: 0px;font-size: 0px;">Preload svg text font</p>
<div class="popup-window" id="contact-us-modal" style="position: fixed; top: 60px">
  <a href="#" class="close-btn close">Close</a>
  <form name="contactUsForm" novalidate>
  <div class="popup-window-content" ng-controller="contactUsController">
    <h1>Contact Us</h1>

    <div ng-init="contact_us.first_name = ''"></div>
    <div ng-init="contact_us.last_name  = ''"></div>
    <div ng-init="contact_us.email      = ''"></div>
    <div ng-init="contact_us.title      = ''"></div>
    <div ng-init="contact_us.company    = ''"></div>

    <p><label for="first_name" class="contact-us-input-label">First Name:</label><input name="first_name" class="contact-us-input" type="text"  id="contact_us_first_name" ng-model="contact_us.first_name" required></p>
    <p><label for="last_name"  class="contact-us-input-label">Last Name: </label><input name="last_name"  class="contact-us-input" type="text"  id="contact_us_last_name"  ng-model="contact_us.last_name"  required></p>
    <p><label for="email"      class="contact-us-input-label">Email:     </label><input name="email"      class="contact-us-input" type="email" id="contact_us_email"      ng-model="contact_us.email"      required></p>
    <p><label for="title"      class="contact-us-input-label">Title:     </label><input name="title"      class="contact-us-input" type="text"  id="contact_us_title"      ng-model="contact_us.title"      required></p>
    <p><label for="company"    class="contact-us-input-label">Company:   </label><input name="company"    class="contact-us-input" type="text"  id="contact_us_company"    ng-model="contact_us.company"    required></p>

    <p>
      Your message:<br>
       <textarea
        style="padding-left: 10px;width:97%;"
        name="body"
        ng-model="contact_us.body"
        id="contact_us_comment"
        placeholder=""
        required
        class="width-100-percent height-180px modal-text contact-us-modal-text"></textarea>
    </p>

    <div class="contact-us-popup-window-actions popup-window-actions">
      <a href="#" ng-click="contact_us.first_name && contact_us.last_name && contact_us.email && contact_us.title && contact_us.body && contact_us.company && sendContactUs(true)" ng-disabled="!contact_us.first_name">
        <span ng-hide="isModalSaving['sendContactUs']" >Send</span>
        <img ng-show="isModalSaving['sendContactUs']" src="/assets/45-f984615860dcc3cb1d159fe3212d22f8.gif" class="contact-us-loading23 loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#contact_us_link").on('click', function(event) {
      openPopup("#contact-us-modal");
    });
  });
</script>

<script>
  angular.bootstrap($('#contact-us-modal'), ['contactUsApp']);
</script>


</div>

  <div id="overlay"></div>
  <script src="/assets/site_search_includes-767db15afeeabfe1517d7f76722726bb.js" type="text/javascript"></script>

</body>
</html>
